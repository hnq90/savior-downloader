!function(a,b,c){function d(a){return-1!==["m3u8","m3u"].indexOf(a)}function e(a){var b=a.url;a="object"==typeof b?b.videoUrl+"\n"+b.audioUrl:b;var c=$.hash(a);return c.toString()}function f(a,b){var d=b[0],e={};if(!d){if(a.length>1)for(var g=0;g<a.length;++g){var h=a[g],i=h.url();if("object"==typeof i&&(i=i.videoUrl),-1!==i.indexOf(".googlevideo.com"))return[h]}return[a[0]]}return a.forEach(function(a){var b=a[d]&&a[d]()||"";e[b]=e[b]||[],e[b].push(a)}),Object.keys(e).map(function(a){var g=f(e[a],b.slice(1)),h={media:g};return h[d]=$.defined(a)?a:c,h.is_only=1===g.length&&(!$.defined(g[0].is_only)||g[0].is_only),h["i18n_"+d]=_("media_fields_"+d+"_"+a),h})}function g(a){return a.forEach(function(a){var b=a.type;a.media.forEach(function(a){a.media=a.media.sort(function(a,c){return T[b].extensions.indexOf(a.ext)-T[b].extensions.indexOf(c.ext)})})}),a}function h(a){return a.ext?(a.media=a.media.sort(function(a,b){return quality.getQualityLevelByType(a.quality)-quality.getQualityLevelByType(b.quality)}),a):(Array.isArray(a)?a=a.map(h):a.media=h(a.media),a)}function i(a){return h(g(a))}function j(a,b){return a&&a[b]||""}function k(a){a=a.replace(/^[#?]{1}/,"");var b=a.split("&"),c={};return b.forEach(function(a){var b=a.split("=");$.defined(b[0])&&$.defined(b[1])&&(c[b[0]]=decodeURIComponent(b[1].replace(/\+/g," ")))}),c}function l(a){var b=$.toArray(arguments);return b.shift(),function(c,d){return c[a].apply(c,b)}}function m(a){return function(b,c){return b[a]}}function n(a){if(!a)return!1;if(a.name&&-1!==a.name.toLowerCase().indexOf("zeroclipboard")||a.data&&-1!==a.data.toLowerCase().indexOf("zeroclipboard"))return!1;var b=Z.getHost(a.src);return b&&$.isMatches(b,W)?!1:!0}function o(a){if(!n(a))return null;if(-1!==["PARAM","SOURCE"].indexOf(a.tagName)&&(a=a.parentElement),"OBJECT"===a.tagName){var b=a.querySelectorAll("embed");b&&1===b.length&&(a=b[0])}return a}function p(a){var b=a.parse,c=a.request;if(!c)return b;var d=c.url||function(a){return a},e=c.params||function(){},f=c.headers||function(){};return function(a){var g=d(a);if(!g)return b(a);var h=new ba;return $.send(c.method,g,e(a),f(a)).done(function(a){try{var c=b(g,a);h.resolve(c)}catch(d){console.warn(d),h.reject()}}),h}}function q(a){return{nocache:!!a.nocache,getPlaylist:p(a)}}function r(a,b,c){function d(b,c,d){return{name:a,node:b,ids:c,scraper:d,getMedia:function(){var b=[],c=this.ids;if(!c.length)return b;var d=this.scraper;return d?(c.forEach(function(c){if(d.nocache)return void b.push(d.getPlaylist(c));var e=a+"_"+(c.url||c),f=new ba;cache.get(e).success(function(a){f.resolve(a)}).fail(function(){var a=new ba(d.getPlaylist(c));a.success(function(a){cache.put(e,a)}).done(function(a){f.resolve(a)})}),b.push(f)}),b):(b.push.apply(b,c),b)}}}var e=c?function(){this._ids=[]}:function(){};return e.prototype={constructor:e,name:a,getMediaPlayers:b,makePlayer:function(a,b,c){return d(o(a),b,c)},makePlayer0:d},c&&(e.prototype.processRequest=function(a){a&&-1===this._ids.indexOf(a)&&this._ids.push(a)}),e}function s(a){return!!a&&$.endsWith(a,"adnetwork.vn")}function t(a,b,c,d){return{match:function(b){if(a.filename&&a.filename!==b.filename)return!1;var c=b.host;if(!c||b.title)return!1;if(!a.hosts)return!0;for(var d=a.hosts.length-1;d>=0;d--)if($.endsWith(c,a.hosts[d]))return!0;return!1},location:Array.isArray(b)?b:[b],selector:c,auxSelector:d}}function u(a,b,c){return t({hosts:[".googlevideo.com","docs.google.com"],filename:"videoplayback"},a,b,c)}function v(a,b){return u(a,"title",b)}function w(){var a=location.href;if(!Ka.test(a))return null;a=a.replace(Ka,"");for(var b,c,d=0;d<Ha.length;++d)if(c=Ha[d],$.isMatches(a,c.location)){try{if(b=$.queryAll(c.selector).pop().textContent,"title"===c.selector&&(b=b.replace(Ia,"").replace(Ja,"")),c.auxSelector){var e=$.query(c.auxSelector).textContent.trim();e&&(b+=" ("+e+")")}b=b.replace(/\s+/g," ").trim()}catch(f){}if(b)return{title:b,test:c.match}}return a.match(/^fptplay\.net/i)?{title:null,test:function(a){var b=a.pathname.split("/"),c=b.length-1,d=b[c];return"chunklist.m3u8"===d&&c>0&&(d=b[c-1]),d&&(this.title=d),!0}}:null}function x(){var a=this;a._callbacks=[],a._data={},a._media2id={}}function y(a,c){function d(){for(var a=10,b=c.scrollTop,d=-1;f-1>d&&e[d+1].top<=b;)d++;return-1===d?!1:(g!==d&&(-1!==g&&(e[g].node.style.position="static",e[g].placeholder.hidden=!0),e[d].node.style.position="fixed",e[d].placeholder.hidden=!1,g=d),d!==f-1&&b+e[d].height>e[d+1].top?(e[d].node.style.top=a-(b+e[d].height-e[d+1].top)+"px",e[d].node.classList.contains("pulled")||e[d].node.classList.add("pulled")):(e[d].node.style.top=a+"px",e[d].node.classList.contains("pulled")&&e[d].node.classList.remove("pulled")),!1)}var e=[],f=a.length,g=-1;1>f||(c.style.position="relative",e=a.map(function(a){var c=b.createElement("div");return c.style.height=a.offsetHeight+"px",c.hidden=!0,a.parentNode.insertBefore(c,a),{node:a,top:a.offsetTop,height:a.offsetHeight,placeholder:c}}),c.addEventListener("scroll",d,!1))}function z(a){this._widget=a,this._downloads=null}function A(a,c){var d=b.createElement(a);return c&&(d.className=c),d}function B(d){var e=d._dl.render(a.options.get("template-list"),{i18n_check_label:_("popup_check_label"),i18n_check_all:_("popup_check_all"),i18n_check_none:_("popup_check_none"),i18n_download_selected:_("popup_download_selected"),i18n_download:_("popup_download"),i18n_wait:_("popup_download_starting"),i18n_one_click:_("popup_one_click"),i18n_preferred_quality:_("popup_preferred_quality"),i18n_no_media_found:_("popup_no_media_found"),i18n_download_failed:_("popup_download_failed")},d._preferredQuality),f=1===e.length?e[0]:null;if(f)if("select"===d._make_action){var g=$.query(".j-quality-selector:not([hidden])",f);g&&setTimeout(function(){var c=b.createEvent("MouseEvents");c.initMouseEvent("mousedown",!0,!0,a),g.dispatchEvent(c)},4)}else if("download"===d._make_action){var h=$.query(".j-quality-download:not([hidden])",f);h&&d._download(h)&&(metrics.log("Download",metrics.DOWNLOAD_AUTO),d._updateDownloadSelected())}d._make_action=c}function C(a){return(a.createShadowRoot||a.webkitCreateShadowRoot).call(a)}function D(a,b){for(b=b.parentNode;b&&b!==a;)b=b.parentNode;return!!b}function E(){var a=A("div"),b=C(a),c=A("style"),d="",e=chrome.runtime.getManifest().web_accessible_resources||[];e.forEach(function(a){$.endsWith(a,".css")&&(d+='@import "'+chrome.extension.getURL(a)+'";\n')}),c.innerHTML=d,b.appendChild(c);var f=A("div","body");return b.appendChild(f),{element:a,shadowElement:f}}function F(a){function b(a){return-1!==["mouseenter","mouseover","touchstart","touchmove"].indexOf(a)}function c(c){var d=a.getTarget(c.target);return d?(a.onFocus(d,b(c.type)),!0):void 0}function d(a){var b=f[a.type];b&&(null!==e&&(e=a),b(a)&&(a.preventDefault(),a.stopPropagation()))}var e,f={mouseenter:c,mouseleave:c},g=Object.keys(f);return{emitLastEvent:function(){var a=e&&f[e.type];a&&a(e),e=null},attach:function(a){for(var b=g.length-1;b>=0;b--)a.addEventListener(g[b],d,!0)},detach:function(a){for(var b=g.length-1;b>=0;b--)a.removeEventListener(g[b],d,!0)}}}function G(a,c){for(;c&&c!==b;){var d=a.getComputedStyle(c);if(d&&"fixed"===d.getPropertyValue("position"))return"fixed";c=c.parentNode}return"absolute"}function H(a){try{var b=a.ownerDocument.defaultView,c=G(b,a),d=a.getBoundingClientRect(),e=d.top,f=d.left;return"fixed"!==c&&(e+=b.pageYOffset,f+=b.pageXOffset),{position:c,top:e+"px",left:f+"px",height:d.height+"px",width:d.width+"px"}}catch(g){return console.trace(g,a),null}}function I(c){function d(a){if(a){for(var b=a.parentNode;b;)a=b,b=a.parentNode;return a.activeElement}}function e(){metrics.log("PageShown",metrics.PAGE_CONTENT_SHOW_CONTROLS),h.hidden=!1}function f(){setTimeout(function(){if(i.hide){var a=$.query(".downloads-multi #downloads",h);a&&(a.hidden=!0),h.hidden=!0}},1500)}function g(){if(i.node){var a="",b=H(i.node);Object.keys(b).forEach(function(c){a+=c+":"+b[c]+";"}),h.setAttribute("style",a)}}var h=A("div","base overlay");h.innerHTML="&nbsp;",h.hidden=!0;var i={hide:!0,node:null};a.addEventListener("resize",g);var j=F({onFocus:function(b,c){var j;if(!c&&(j=d(h),j&&j.matches("select"))){if("o"===b)return;j.blur()}if(!c||!a.options.get("on_page_buttons"))return i.hide=!0,void f();if(i.hide=!1,"o"!==b){i.node=b.node;var k=b.widget;k&&k.isReady()&&(k.attach(h),g(),e())}},getTarget:function(a){return a?a===h?"o":c.findEntry(a):a}});return j.attach(h),j.attach(b),{attach:function(a){a.appendChild(h),j.emitLastEvent()},destroy:function(){j.detach(b),j.detach(h),a.removeEventListener("resize",g)}}}function J(){function a(a){if(!a)return!0;if("VIDEO"===a.tagName){var b=a.parentNode;if(b&&"BODY"===b.tagName&&1===b.childNodes.length)return!0}return!1}return{data:[],reset:function(){this.data=[]},findEntry:function(a){for(var b=this.data,c=b.length-1;c>=0;c--){var d=b[c];if(d.node===a||D(d.node,a))return d}return null},setMediaPlayers:function(b,c){for(var d=this.data,e=[],f=0;f<d.length;++f)e.push(d[f].node);var g=0;c.forEach(function(c){var f=c.node;if(!a(f)){console.assert(f===o(f),"Non normalized nodes! "+c.name);var h,i=e.indexOf(f);-1!==i?(console.assert(f===d[i].node,"Mismatched nodes!"),e[i]=null,h=d[i].widget):(h=new Oa,d.push({node:f,widget:h})),h.setMediaData(b,c),++g}});for(var f=e.length-1;f>=0;f--){var h=e[f];h&&(console.assert(h===d[f].node,"Mismatched nodes!"),d.splice(f,1))}return!!g}}}function K(a){var c,d=J(),e=I(d);return{destroy:function(){e&&(e.destroy(),e=null),c&&(a.removeChild(c.element),c=null),d.reset()},setMediaPlayers:function(f,g){d.setMediaPlayers(f,g)&&!c&&(c=E(b),a.appendChild(c.element),e.attach(c.shadowElement))}}}function L(a){try{chrome.runtime.sendMessage(a)}catch(b){return!1}return!0}function M(){var a=b.createElement("savior:overlay");a.style.background="#000000",a.style.position="fixed",a.style.left="0px",a.style.top="0px",a.style.right="0px",a.style.bottom="0px",a.style.opacity=.6,a.style.zIndex=2147483647;var c=b.createElement("style");c.innerHTML="body { -webkit-filter: blur(3px)!important; }";var d={_style:c,_overlay:a,_warp:b.createDocumentFragment(),hide:function(a){a&&a.stopPropagation&&(a.stopPropagation(),a.preventDefault()),this._warp.appendChild(this._overlay),this._warp.appendChild(this._style)},show:function(){b.body.appendChild(this._overlay),b.body.offsetHeight,b.head.appendChild(this._style)},destroy:function(){this.hide(),this._style=null,this._overlay=null,this._warp=null}};return a.addEventListener("mouseup",d.hide.bind(d),!0),a.addEventListener("mousedown",d.hide.bind(d),!0),d}function N(a){for(var b=0;b<a.length;++b)if(a[b].ids.length)return!0;return!1}function O(a){return"file:"!==a}function P(a){return""===a||"localhost"===a}function Q(){if(Ra&&(clearTimeout(Ra),Ra=null),!b.webkitHidden){var a=Sa.getMediaPlayers(),c=O(location.protocol);if(c||!P(location.host)){var d=L({requestType:"media",method:"set_present",params:N(a)});if(!d)return void S()}"undefined"==typeof Pa&&b.documentElement&&c&&(Pa=K(b.documentElement)),Pa&&Pa.setMediaPlayers(Sa,a),Ra=setTimeout(Q,Qa)}}function R(){a.options=new ha,a.options.load(),a.cache=new Ma,Sa=new Ga,Ta=M(),a.onbeforeunload=S,chrome.runtime.onConnect.addListener(function(a){"overlay"===a.name&&Ta&&(Ta.show(),a.onDisconnect.addListener(function(){Ta&&Ta.hide()}))}),chrome.runtime.onMessage.addListener(function(a,b,c){var d=null;switch(a.requestType){case"get_media":Sa.getMedia().done(function(a){c(a)});break;case"downloads":d=La.processRequest(a.method,a.params);break;case"request.matched":Sa.processRequest(a)}return d?(d.done(function(a){c({success:d.state===ba.RESOLVED,data:a})}),!0):!0}),L({requestType:"media",method:"reset_all"}),a.manager=Sa,b.addEventListener("webkitvisibilitychange",Q,!1),Q()}function S(){Ta&&(Ta.destroy(),Ta=null),Pa&&(Pa.destroy(),Pa=null),Ra&&(clearTimeout(Ra),Ra=null),b.removeEventListener("webkitvisibilitychange",Q,!1)}const T={audio:{title:"Audio",rgxp:/audio/i,extensions:["mp3","flac","m4a","wma","ogg","wav","aif","mid"],ctype2extension:{midi:"mid",mp4:"m4a",m4a:"m4a",mpeg:"mp3",mpeg3:"mp3",wav:"wav",aiff:"aif"}},video:{title:"Video",rgxp:/video/i,extensions:["mp4","mpeg4","mpg","mpeg","m4v","avi","divx","mov","wmv","movie","asf","webm","flv","3gp"],ctype2extension:{mpeg:"mp4",mp4:"mp4",m4v:"mp4","3gpp":"3gp",flv:"flv",quicktime:"mov",msvideo:"avi","ms-wmv":"wmv","ms-asf":"asf"}}},U=function(){var a={};return Object.keys(T).forEach(function(b){for(var c=T[b].extensions,d=0;d<c.length;d++)a[c[d]]=b}),a}(),V=[/^(.+\.)?youtube.com/i,/^(.+\.)?zing.vn/i,/^(.+\.)?nhaccuatui.com/i,/^(.+\.)?nhacso.net/i,/^(.+\.)?vimeo.com/i,/^(.+\.)?clip.vn/i,/vietgiaitri\.com/i],W=[/^(.+\.)?googlesyndication\.com/i,/^(.+\.)?histats\.com/i,"adnetwork.vn","doubleclick.net","admicro","adnet.vn","ds-vn.serving-sys.com","lavanetwork.net","video.sgame.vn:8080","cdn.blueseed","vcmedia.vn","innity.net","serving-sys.com","ambientplatform.vn","gvt1.com"];var X=X||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},g=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var e=0;a>e;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;a>e;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new g.init(c,b)}}),h=c.enc={},i=h.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-8*(d%4);return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=e/(4*f),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0);if(b=h*f,e=a.min(4*b,e),b){for(var i=0;b>i;i+=f)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return new g.init(i,e)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}});var m=c.algo={};return c}(Math);!function(){var a=X,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp(),a=[];for(var e=0;c>e;e+=3)for(var f=(b[e>>>2]>>>24-8*(e%4)&255)<<16|(b[e+1>>>2]>>>24-8*((e+1)%4)&255)<<8|b[e+2>>>2]>>>24-8*((e+2)%4)&255,g=0;4>g&&c>e+.75*g;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var c=a.length,d=this._map,e=d.charAt(64);e&&(e=a.indexOf(e),-1!=e&&(c=e));for(var e=[],f=0,g=0;c>g;g++)if(g%4){var h=d.indexOf(a.charAt(g-1))<<2*(g%4),i=d.indexOf(a.charAt(g))>>>6-2*(g%4);e[f>>>2]|=(h|i)<<24-8*(f%4),f++}return b.create(e,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(a){function b(a,b,c,d,e,f,g){return a=a+(b&c|~b&d)+e+g,(a<<f|a>>>32-f)+b}function c(a,b,c,d,e,f,g){return a=a+(b&d|c&~d)+e+g,(a<<f|a>>>32-f)+b}function d(a,b,c,d,e,f,g){return a=a+(b^c^d)+e+g,(a<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){return a=a+(c^(b|~d))+e+g,(a<<f|a>>>32-f)+b}for(var f=X,g=f.lib,h=g.WordArray,i=g.Hasher,g=f.algo,j=[],k=0;64>k;k++)j[k]=4294967296*a.abs(a.sin(k+1))|0;g=g.MD5=i.extend({_doReset:function(){this._hash=new h.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,f){for(var g=0;16>g;g++){var h=f+g,i=a[h];a[h]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var g=this._hash.words,h=a[f+0],i=a[f+1],k=a[f+2],l=a[f+3],m=a[f+4],n=a[f+5],o=a[f+6],p=a[f+7],q=a[f+8],r=a[f+9],s=a[f+10],t=a[f+11],u=a[f+12],v=a[f+13],w=a[f+14],x=a[f+15],y=g[0],z=g[1],A=g[2],B=g[3],y=b(y,z,A,B,h,7,j[0]),B=b(B,y,z,A,i,12,j[1]),A=b(A,B,y,z,k,17,j[2]),z=b(z,A,B,y,l,22,j[3]),y=b(y,z,A,B,m,7,j[4]),B=b(B,y,z,A,n,12,j[5]),A=b(A,B,y,z,o,17,j[6]),z=b(z,A,B,y,p,22,j[7]),y=b(y,z,A,B,q,7,j[8]),B=b(B,y,z,A,r,12,j[9]),A=b(A,B,y,z,s,17,j[10]),z=b(z,A,B,y,t,22,j[11]),y=b(y,z,A,B,u,7,j[12]),B=b(B,y,z,A,v,12,j[13]),A=b(A,B,y,z,w,17,j[14]),z=b(z,A,B,y,x,22,j[15]),y=c(y,z,A,B,i,5,j[16]),B=c(B,y,z,A,o,9,j[17]),A=c(A,B,y,z,t,14,j[18]),z=c(z,A,B,y,h,20,j[19]),y=c(y,z,A,B,n,5,j[20]),B=c(B,y,z,A,s,9,j[21]),A=c(A,B,y,z,x,14,j[22]),z=c(z,A,B,y,m,20,j[23]),y=c(y,z,A,B,r,5,j[24]),B=c(B,y,z,A,w,9,j[25]),A=c(A,B,y,z,l,14,j[26]),z=c(z,A,B,y,q,20,j[27]),y=c(y,z,A,B,v,5,j[28]),B=c(B,y,z,A,k,9,j[29]),A=c(A,B,y,z,p,14,j[30]),z=c(z,A,B,y,u,20,j[31]),y=d(y,z,A,B,n,4,j[32]),B=d(B,y,z,A,q,11,j[33]),A=d(A,B,y,z,t,16,j[34]),z=d(z,A,B,y,w,23,j[35]),y=d(y,z,A,B,i,4,j[36]),B=d(B,y,z,A,m,11,j[37]),A=d(A,B,y,z,p,16,j[38]),z=d(z,A,B,y,s,23,j[39]),y=d(y,z,A,B,v,4,j[40]),B=d(B,y,z,A,h,11,j[41]),A=d(A,B,y,z,l,16,j[42]),z=d(z,A,B,y,o,23,j[43]),y=d(y,z,A,B,r,4,j[44]),B=d(B,y,z,A,u,11,j[45]),A=d(A,B,y,z,x,16,j[46]),z=d(z,A,B,y,k,23,j[47]),y=e(y,z,A,B,h,6,j[48]),B=e(B,y,z,A,p,10,j[49]),A=e(A,B,y,z,w,15,j[50]),z=e(z,A,B,y,n,21,j[51]),y=e(y,z,A,B,u,6,j[52]),B=e(B,y,z,A,l,10,j[53]),A=e(A,B,y,z,s,15,j[54]),z=e(z,A,B,y,i,21,j[55]),y=e(y,z,A,B,q,6,j[56]),B=e(B,y,z,A,x,10,j[57]),A=e(A,B,y,z,o,15,j[58]),z=e(z,A,B,y,v,21,j[59]),y=e(y,z,A,B,m,6,j[60]),B=e(B,y,z,A,t,10,j[61]),A=e(A,B,y,z,k,15,j[62]),z=e(z,A,B,y,r,21,j[63]);g[0]=g[0]+y|0,g[1]=g[1]+z|0,g[2]=g[2]+A|0,g[3]=g[3]+B|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/4294967296);for(c[(e+64>>>9<<4)+15]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c[(e+64>>>9<<4)+14]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),b.sigBytes=4*(c.length+1),this._process(),b=this._hash,c=b.words,d=0;4>d;d++)e=c[d],c[d]=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>8);return b},clone:function(){var a=i.clone.call(this);return a._hash=this._hash.clone(),a}}),f.MD5=i._createHelper(g),f.HmacMD5=i._createHmacHelper(g)}(Math),function(){var a=X,b=a.lib,c=b.Base,d=b.WordArray,b=a.algo,e=b.EvpKDF=c.extend({cfg:c.extend({keySize:4,hasher:b.MD5,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,e=c.hasher.create(),f=d.create(),g=f.words,h=c.keySize,c=c.iterations;g.length<h;){i&&e.update(i);var i=e.update(a).finalize(b);e.reset();for(var j=1;c>j;j++)i=e.finalize(i),e.reset();f.concat(i)}return f.sigBytes=4*h,f}});a.EvpKDF=function(a,b,c){return e.create(c).compute(a,b)}}(),X.lib.Cipher||function(a){var b=X,c=b.lib,d=c.Base,e=c.WordArray,f=c.BufferedBlockAlgorithm,g=b.enc.Base64,h=b.algo.EvpKDF,i=c.Cipher=f.extend({cfg:d.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){f.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){return a&&this._append(a),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(a){return{encrypt:function(b,c,d){return("string"==typeof c?o:n).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?o:n).decrypt(a,b,c,d)}}}});c.StreamCipher=i.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var j=b.mode={},k=function(b,c,d){var e=this._iv;e?this._iv=a:e=this._prevBlock;for(var f=0;d>f;f++)b[c+f]^=e[f]},l=(c.BlockCipherMode=d.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}})).extend();l.Encryptor=l.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize;k.call(this,a,b,d),c.encryptBlock(a,b),this._prevBlock=a.slice(b,b+d)}}),l.Decryptor=l.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=a.slice(b,b+d);c.decryptBlock(a,b),k.call(this,a,b,d),this._prevBlock=e}}),j=j.CBC=l,l=(b.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,f=[],g=0;c>g;g+=4)f.push(d);c=e.create(f,c),a.concat(c)},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}},c.BlockCipher=i.extend({cfg:i.cfg.extend({mode:j,padding:l}),reset:function(){i.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var m=c.CipherParams=d.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),j=(b.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;return a=a.salt,(a?e.create([1398893684,1701076831]).concat(a).concat(b):b).toString(g)},parse:function(a){a=g.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=e.create(b.slice(2,4));b.splice(0,4),a.sigBytes-=16}return m.create({ciphertext:a,salt:c})}},n=c.SerializableCipher=d.extend({cfg:d.extend({format:j}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);return b=e.finalize(b),e=e.cfg,m.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),b=(b.kdf={}).OpenSSL={execute:function(a,b,c,d){return d||(d=e.random(8)),a=h.create({keySize:b+c}).compute(a,d),c=e.create(a.words.slice(b),4*c),a.sigBytes=4*b,m.create({key:a,iv:c,salt:d})}},o=c.PasswordBasedCipher=n.extend({cfg:n.cfg.extend({kdf:b}),encrypt:function(a,b,c,d){return d=this.cfg.extend(d),c=d.kdf.execute(c,a.keySize,a.ivSize),d.iv=c.iv,a=n.encrypt.call(this,a,b,c.key,d),a.mixIn(c),a},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt),d.iv=c.iv,n.decrypt.call(this,a,b,c.key,d)}})}(),function(){for(var a=X,b=a.lib.BlockCipher,c=a.algo,d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=0;256>o;o++)n[o]=128>o?o<<1:o<<1^283;for(var p=0,q=0,o=0;256>o;o++){var r=q^q<<1^q<<2^q<<3^q<<4,r=r>>>8^255&r^99;d[p]=r,e[r]=p;var s=n[p],t=n[s],u=n[t],v=257*n[r]^16843008*r;f[p]=v<<24|v>>>8,g[p]=v<<16|v>>>16,h[p]=v<<8|v>>>24,i[p]=v,v=16843009*u^65537*t^257*s^16843008*p,j[r]=v<<24|v>>>8,k[r]=v<<16|v>>>16,l[r]=v<<8|v>>>24,m[r]=v,p?(p=s^n[n[n[u^s]]],q^=n[n[q]]):p=q=1}var w=[0,1,2,4,8,16,32,64,128,27,54],c=c.AES=b.extend({_doReset:function(){for(var a=this._key,b=a.words,c=a.sigBytes/4,a=4*((this._nRounds=c+6)+1),e=this._keySchedule=[],f=0;a>f;f++)if(c>f)e[f]=b[f];else{var g=e[f-1];f%c?c>6&&4==f%c&&(g=d[g>>>24]<<24|d[g>>>16&255]<<16|d[g>>>8&255]<<8|d[255&g]):(g=g<<8|g>>>24,g=d[g>>>24]<<24|d[g>>>16&255]<<16|d[g>>>8&255]<<8|d[255&g],g^=w[f/c|0]<<24),e[f]=e[f-c]^g}for(b=this._invKeySchedule=[],c=0;a>c;c++)f=a-c,g=c%4?e[f]:e[f-4],b[c]=4>c||4>=f?g:j[d[g>>>24]]^k[d[g>>>16&255]]^l[d[g>>>8&255]]^m[d[255&g]]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,f,g,h,i,d)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this._doCryptBlock(a,b,this._invKeySchedule,j,k,l,m,e),c=a[b+1],a[b+1]=a[b+3],a[b+3]=c},_doCryptBlock:function(a,b,c,d,e,f,g,h){for(var i=this._nRounds,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[2],m=a[b+3]^c[3],n=4,o=1;i>o;o++)var p=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],q=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],r=d[l>>>24]^e[m>>>16&255]^f[j>>>8&255]^g[255&k]^c[n++],m=d[m>>>24]^e[j>>>16&255]^f[k>>>8&255]^g[255&l]^c[n++],j=p,k=q,l=r;p=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],q=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],r=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],m=(h[m>>>24]<<24|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++],a[b]=p,a[b+1]=q,a[b+2]=r,a[b+3]=m},keySize:8});a.AES=b._createHelper(c)}(),X.pad.NoPadding={pad:function(){},unpad:function(){}};var Y=function(){function a(a,b){var c=a[0]-b[0];return 0!==c?c:(c=a[1]-b[1],0!==c?c:(c=a[2]-b[2],0!==c?c:c=a[3]-b[3]))}var b="",c={mp4:!0},d=0,e=navigator.userAgent.match(/Chrome\/([\d\.]+)/);return e&&e[1]&&(e=e[1].split("."),e=[+e[0],+e[1],+e[2],+e[3]],a(e,[39,0,2171,103])>=0&&(b+=" webm!",c.webm=!0),a(e,[39,0,2171,105])>=0&&(b+=" m3u8!",d=1)),b&&console.info(b),{YT:c,M3U8:d}}(),Z=function(){function a(a){return a&&0!==a.indexOf("data:image")?f.exec(a):[]}var c=b.createElement("a"),d=/([^/]+)$/i,e=/\.([^/.]*)$/i,f={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}.strict,g=a(b.location.href);return{parse:function(a,b){var f=c;f.setAttribute("href",a);var g=(f.pathname.match(d)||[])[1]||"",h=g.split(".").map(function(a){return a.toLowerCase()});g=decodeURIComponent(g.replace(e,"")),h.shift();var i=h[h.length-1]||"",j={url:a,protocol:f.protocol,host:f.host,port:f.port,pathname:f.pathname,filename:g,ext:i,exts:h,search:f.search};return j.port||delete j.port,b&&(j.query={},f.search.replace(/^\?/,"").split(/\&/).forEach(function(a){a=a.split("="),j.query[a[0]]=a[1]})),j},format:function(a){if(a=Object.create(a),a.query){a.search=[];for(var b in a.query)"undefined"!=typeof a.query[b]?a.search.push(b+"="+encodeURIComponent(a.query[b])):a.search.push(b);a.search="?"+a.search.join("&"),delete a.query}for(var d in a)c[d]=a[d];var e=c.href;return e},parse0:a,resolve:function(b,c){b=a(b),c||(c=g);var d=b[1],e=b[2],f=b[9],h=b[12],i=b[13];if(!d&&(d=c[1],!e))if(e=c[2],f){if("/"!==f.charAt(0)){var j=c[10]||"/";f=j+f}}else f=c[9],h||(h=c[12]);var k=d+"://"+e+f;return h&&(k+="?"+h),i&&(k+="#"+i),k},getHost:function(b){return a(b)[6]||""},getMediaType:function(b){var c=a(b)[11]||"";if(!c)return"";var d=c.split("."),e=d.length-1;if(0>=e)return"";var f=d[e].toLowerCase();return U[f]}}}(),$={SIZES:["B","KB","MB","GB","TB","PB"],_BASE:-1!==navigator.appVersion.indexOf("Win")?1024:1e3,xmlParser:new DOMParser,endsWith:function(a,b){var c=a.length-b.length;return c>=0&&a.indexOf(b,c)===c},hash:function(a,b){if(b=0|b,0===a.length)return b;var c,d;for(c=0,d=a.length;d>c;c++)b=(b<<5)-b+a.charCodeAt(c),b|=0;return b},query:function(a,c){return c=c||b,c.querySelector(a)},queryAll:function(a,c){return c=c||b,$.toArray(c.querySelectorAll(a))},findParent:function(a,b){for(;null!==a&&!a.classList.contains(b);)a=a.parentNode;return a},nearestParent:function(a,c){for(;null!==a&&a!==b&&!a.matches(c);)a=a.parentNode;return a},closest:function(a,b){return a.matches(b)?[a]:$.queryAll(b,a)},toArray:function(a){return Array.prototype.slice.call(a)},unique:function(a){var b=[];return Array.isArray(a)?(a.forEach(function(a){-1===b.indexOf(a)&&b.push(a)}),b):a},extend:function(a,b){var c=function(){};c.prototype=a.prototype,b.prototype=new c,b.prototype.constructor=b,b._super=a.prototype},extendObject:function(a){return Array.prototype.forEach.call(Array.prototype.slice.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},isMatches:function(a,b){var c,d,e;if(Array.isArray(a)){for(c=0;c<a.length;++c)if($.isMatches(a[c],b))return!0;return!1}for(b=Array.isArray(b)?b:[b],c=0,d=b.length,e;d>c;++c)if(e=b[c],"string"==typeof e&&-1!==a.indexOf(e)||e instanceof RegExp&&a.match(e))return!0;return!1},_sendBackgroundRequest:function(a,b,c,d){var e=new ba;return chrome.runtime.sendMessage({requestType:"make_http_request",method:a,url:b,params:c,headers:d},function(a){e[a.success?"resolve":"reject"](a.data)}),e},send:function(a,b,c,d){var e=new ba,f=null;if($.IS_CONTENT_SCRIPT)return $._sendBackgroundRequest(a,b,c,d);try{var g=new XMLHttpRequest;if(g.open(a,b,!0),g.setRequestHeader("Cache-Control","no-cache"),"object"==typeof c&&(f=Object.keys(c).map(function(a){return a+"="+c[a]}).join("&")),"object"==typeof d)for(var h in d)g.setRequestHeader(h,d[h]);"POST"===a&&(g.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f&&g.setRequestHeader("Content-Length",f.length)),g.onload=function(){e.resolve(this.responseText)},g.onerror=function(){e.reject()},g.send(f)}catch(i){e.reject()}return e},get:function(a,b){return $.send("GET",a,{},b)},post:function(a,b,c){return $.send("POST",a,b,c)},_getSize:function(a){function b(a){d&&d[a?"resolve":"reject"](a),d=null,c.abort(),clearTimeout(e),e=null}var c=new XMLHttpRequest,d=new ba,e=null,f=1e4;return console.log("%c[SQ] %s","color:'navi';",a),c.open("GET",a),c.setRequestHeader("Cache-Control","no-cache"),c.url=a,c.onreadystatechange=function(){if(!(this.readyState<2)){var a=null;try{a=+this.getResponseHeader("Content-Length"),Number.isNaN(a)&&(a=null)}catch(c){}(null!==a||200===this.status)&&(200!==this.status&&(a=null),b(a))}},c.send(null),e=setTimeout(b,f),d},getSize:function(b){var c=new ba,d=a.cache;return d.get(b).success(function(a){a?(c.resolve(a),d.put(b,a)):c.bind($._getSize(b)).success(d.put.bind(d,b))}).fail(function(){c.bind($._getSize(b)).success(d.put.bind(d,b))}),c},beautifyFileSize:function(a){if(null===a||"undefined"==typeof a)return"???";for(var b=$._BASE,c=0;c<$.SIZES.length&&a>=b;++c,a/=b);return Math.round(10*a)/10+$.SIZES[c]},detectMediaTypeAndExt:function(a,b){b=b||"";var c=["application/x-mpegurl","application/vnd.apple.mpegurl","audio/x-mpegurl","audio/mpegurl"];if(-1!==c.indexOf(b))return a.type="video",a.ext="m3u8",a;var d=$.getMediaType(b,a.exts);return d&&T[d]&&(a.type=d,a.ext=this._findIntersection(a.exts,T[d].extensions)||$.extByContentType(b,d)||a.ext),a},getMediaType:function(a,b){var c;for(var d in T){if(c=T[d],a.match(c.rgxp))return d;if(Array.isArray(b)&&$._findIntersection(b,c.extensions)||-1!==c.extensions.indexOf(b))return d}return null},_findIntersection:function(a,b){for(var c=a.concat(b),d={},e=0;e<c.length;++e){
var f=c[e];if(d[f])return f;d[f]=!0}return null},extByContentType:function(a,b){var c=T[b].ctype2extension;for(var d in c)if(-1!==a.indexOf(d))return c[d];return null},call:function(a,b){if(a&&!(a.length<=0))for(var c=[].slice.call(arguments,2),d=0;d<a.length;d++)a[d].apply(b,c)},isTrue:function(a){return!!a},noop:function(){},defined:function(a){return"undefined"!=typeof a},notNull:function(a){return null!==a},replaceEntities:function(a){var b={"&amp;":"&"};return String(a).replace(/&amp;/g,function(a){return b[a]})}},_=chrome.i18n.getMessage;try{chrome.extension.getBackgroundPage(),$.IS_CONTENT_SCRIPT=!1}catch(aa){$.IS_CONTENT_SCRIPT=!0}var ba=function(a){if(0===arguments.length)return this._init(),this;if(a instanceof ba)return a;var b=new ba;return b.resolve(a),b};ba.RUNNING=0,ba.RESOLVED=1,ba.FAILED=2,ba.prototype={constructor:ba,_init:function(){this._results=[],this._subscribers=[],this.state=ba.RUNNING},_notify:function(){var a=this;this._subscribers.forEach(function(b){b.apply(a,a._results)}),this._subscribers=[]},resolve:function(){return this.state=ba.RESOLVED,this._results=arguments,this._notify(),this},reject:function(){return this.state=ba.FAILED,this._results=arguments,this._notify(),this},subscribe:function(a){this.state!==ba.RUNNING?a.apply(this,this._results):this._subscribers.push(a)},done:function(a){return this.subscribe(a),this},success:function(a){var b=this;return this.subscribe(function(){b.state===ba.RESOLVED&&a.apply(b,b._results)}),this},fail:function(a){var b=this;return this.subscribe(function(){b.state===ba.FAILED&&a.apply(b,b._results)}),this},bind:function(a){return a=new ba(a),a.success(this.resolve.bind(this)).fail(this.reject.bind(this)),this}},ba.when=function(){var a=[];return a=Array.isArray(arguments[0])?arguments[0]:$.toArray(arguments),new ba.When(a)},ba.When=function(a){this._doneCallbacks=[],this._successCallbacks=[],this._failCallbacks=[],this._state=ba.RUNNING,this._thingsToDo=a.length,this._results=Array(this._thingsToDo),this._init(a)},ba.When.prototype={constructor:ba.When,_init:function(a){var b=this;a.forEach(function(a,c){a=new ba(a),a.subscribe(function(){a.state===ba.FAILED&&(b._state=ba.FAILED),b._results[c]=$.toArray(arguments),b._thingsToDo--,b._checkIsDone()})}),this._checkIsDone()},_checkIsDone:function(){if(0!==this._thingsToDo)return!1;var a=[];this._results.forEach(function(b){a=a.concat(b)}),this._state===ba.FAILED?this._runCallbacks(this._failCallbacks,a):this._runCallbacks(this._successCallbacks,a),this._runCallbacks(this._doneCallbacks,a),this._doneCallbacks=[],this._successCallbacks=[],this._failCallbacks=[]},_runCallbacks:function(a,b){a.forEach(function(a){a.apply(this,b)})},done:function(a){return this._doneCallbacks.push(a),this._checkIsDone(),this},success:function(a){return this._successCallbacks.push(a),this._checkIsDone(),this},fail:function(a){return this._failCallbacks.push(a),this._checkIsDone(),this}},ba.chain=function(){function a(b){if(!b.length)return c.resolve.apply(c,d);var e,f=b.shift();"function"==typeof f?(e=ba(f()),e.done(function(c){d.push(c),a(b)})):(d.push(f),a(b))}var b,c=new ba,d=[];return b=Array.isArray(arguments[0])?arguments[0]:$.toArray(arguments),a(b),c};var ca=function(){};ca.QL_HIGH="High",ca.QL_MEDIUM="Medium",ca.QL_LOW="Low",ca.QL_VIDEO_ULTRAHD="Ultra HD",ca.QL_VIDEO_FULLHD="Full HD",ca.QL_VIDEO_HD="HD",ca.QL_VIDEO_STANDARD="Standard",ca.QL_VIDEO_MEDIUM="Medium",ca.QL_VIDEO_SMALL="Small",ca.QL_VIDEO_MOBILE="Mobile";var da={};da[ca.QL_VIDEO_ULTRAHD]={quality:ca.QL_HIGH,qualityIndex:6,size:3072,videoTitle:"Ultra HD",itag:[38,138]},da[ca.QL_VIDEO_FULLHD]={quality:ca.QL_HIGH,qualityIndex:5,size:1080,videoTitle:"Full HD",audioTitle:"High",itag:[37,46,137],vimeoQuality:"",zingTag:"f1080",dailymotionQuality:"hd1080",clipvnQuality:"5"},da[ca.QL_VIDEO_HD]={quality:ca.QL_HIGH,qualityIndex:4,size:720,videoTitle:"HD",audioTitle:"High",itag:[22,45,120,136,247],zingTag:["f720","hq"],vimeoQuality:"hd",dailymotionQuality:["hd","hd720"],facebookQuality:["hd_src","hd_src_no_ratelimit"],clipvnQuality:"4"},da[ca.QL_VIDEO_STANDARD]={quality:ca.QL_MEDIUM,qualityIndex:3,size:480,videoTitle:"Standard",audioTitle:"Normal",itag:[44,35,135,244],zingTag:["f480"],dailymotionQuality:"hq",vimeoQuality:"sd",facebookQuality:["sd_src","sd_src_no_ratelimit"],clipvnQuality:"3"},da[ca.QL_VIDEO_MEDIUM]={quality:ca.QL_MEDIUM,qualityIndex:2,size:360,videoTitle:"Medium",audioTitle:"Normal",itag:[18,43,34,134,243],vimeoQuality:"",dailymotionQuality:"sd",zingTag:["source","f360"],clipvnQuality:"2"},da[ca.QL_VIDEO_SMALL]={quality:ca.QL_LOW,qualityIndex:1,size:240,videoTitle:"Small",audioTitle:"Low",itag:[36,5,133,242],dailymotionQuality:"ld",vimeoQuality:"mobile",zingTag:["f","f240"],clipvnQuality:"1"},da[ca.QL_VIDEO_MOBILE]={quality:ca.QL_LOW,qualityIndex:0,size:144,videoTitle:"Mobile",audioTitle:"Low",itag:[17,6,160],vimeoQuality:"",clipvnQuality:"0"};var ea={};ea[ca.QL_HIGH]=da[ca.QL_VIDEO_ULTRAHD].qualityIndex,ea[ca.QL_MEDIUM]=da[ca.QL_VIDEO_STANDARD].qualityIndex,ea[ca.QL_LOW]=da[ca.QL_VIDEO_SMALL].qualityIndex,ca.prototype={constructor:ca,DEFAULT_QUALITY_LEVEL:ca.QL_HIGH,QUALITY_LEVELS:[ca.QL_HIGH,ca.QL_MEDIUM,ca.QL_LOW],VIDEO_QUALITY_LEVELS:[ca.QL_VIDEO_ULTRAHD,ca.QL_VIDEO_FULLHD,ca.QL_VIDEO_HD,ca.QL_VIDEO_STANDARD,ca.QL_VIDEO_MEDIUM,ca.QL_VIDEO_SMALL,ca.QL_VIDEO_MOBILE],DEFAULT_QUALITY_TYPE:ca.QL_VIDEO_STANDARD,QUALITY_TYPES:da,getFacebookQuality:function(a){return this._getVideoQuality("facebookQuality",a).videoTitle},getDailymotionQuality:function(a){return this._getVideoQuality("dailymotionQuality",a).videoTitle},getZingVideoQuality:function(a){return this._getVideoQuality("zingTag",a).videoTitle},getZingAudioQuality:function(a){return this._getVideoQuality("zingTag",a).audioTitle},getYoutubeQuality:function(a,b){var c=this._getVideoQuality("itag",+a,b);return c&&c.videoTitle},getVimeoQuality:function(a){return this._getVideoQuality("vimeoQuality",a).videoTitle},getClipvnQuality:function(a){return this._getVideoQuality("clipvnQuality",a).videoTitle},getQualityBySize:function(a,b){if(a=parseInt(a),isNaN(a))return null;var c=1/0,d=null,e=this.QUALITY_TYPES[this.DEFAULT_QUALITY_TYPE];for(var f in this.QUALITY_TYPES){var g=this.QUALITY_TYPES[f];g.size>e.size&&(e=g),a<=1.3*g.size&&g.size<c&&(d=g,c=g.size)}return d=d||e,d.videoTitle},_getVideoQuality:function(a,b,c){for(var d in this.QUALITY_TYPES){var e=this.QUALITY_TYPES[d][a];if(Array.isArray(e)||(e=[e]),-1!==e.indexOf(b))return this.QUALITY_TYPES[d]}return c?null:this.QUALITY_TYPES[this.DEFAULT_QUALITY_TYPE]},_getTypeByQualityType:function(a){for(var b in this.QUALITY_TYPES)if(a===b||a===this.QUALITY_TYPES[b].videoTitle||a===this.QUALITY_TYPES[b].audioTitle)return this.QUALITY_TYPES[b];return this.QUALITY_TYPES[this.DEFAULT_QUALITY_TYPE]},_calculateWeight:function(a,b){var c=T[a.get("type")].extensions,d=c.indexOf(a.get("ext")),e=this._getTypeByQualityType(a.get("quality")).qualityIndex,f=d/c.length+Math.abs(b-e)/7;return f},getQualityLevelByType:function(a){return Object.keys(this.QUALITY_TYPES).indexOf(this._getTypeByQualityType(a).videoTitle)},getVideoQualityIndex:function(a){return this.VIDEO_QUALITY_LEVELS.concat().reverse().indexOf(a)},getOneClickQualityIndex:function(a){return this.QUALITY_LEVELS.concat().reverse().indexOf(a)},getQualityLevelByQualityType:function(a){return this._getTypeByQualityType(a).quality},chooseBestDownload:function(a,b,c){var d=a.length;if(c)for(var e=0;d>e;++e){var f=a[e];if(f.extQuality()===c)return f}b=b||this.DEFAULT_QUALITY_LEVEL;for(var g=ea[b],h=1e3,i=-1,e=0;d>e;++e){var f=a[e],j=this._calculateWeight(f,g);h>j&&(h=j,i=e)}return a[i]}},a.quality=new ca;var fa=function(a){console.assert(a.id),this._values={},this._sizePromise=null,this._hls=!1,this.merge(a)};fa.MAX_FILE_NAME_LENGTH=128,fa.isValidData=function(a){if(Y.M3U8&&d(a.ext))return!0;var b=T[a.type];return b&&-1!==b.extensions.indexOf(a.ext)},fa.prototype._createFieldGetter=function(a){this[a]=function(){return this.get(a)}},fa.prototype.get=function(a){return"string"==typeof a||"number"==typeof a?this._values[a]:void 0},fa.prototype.set=function(a,b){return"string"!=typeof a&&"number"!=typeof a||this._values[a]===b||(this._values[a]=b,this[a]||this._createFieldGetter(a)),this},fa.prototype.merge=function(a){var b=a instanceof fa?a._values:a;for(var c in b)this.set(c,"undefined"!=typeof b[c]?b[c]:b[c]||null);return d(this.get("ext"))&&(this.set("ext","mp4"),this._hls=!0),this},fa.prototype.getName=function(){return $.replaceEntities(this._values.title||this._values.filename)},fa.prototype.title=function(){return this.getName().substr(0,fa.MAX_FILE_NAME_LENGTH)},fa.prototype.getFilename=function(){var a=this.getName(),b="."+this._values.ext;return $.endsWith(a,b)||(a+=b),a=a.replace(/\s+/g," ").replace(/[\/\\:*?"<>|\u200c\u200d]/g,"-"),a.substr(0,fa.MAX_FILE_NAME_LENGTH)},fa.prototype.extQuality=function(){return(this.get("ext")||"")+"/"+(this.get("quality")||"")},fa.prototype.size=function(){var a=this.get("size");return a?"("+$.beautifyFileSize(a)+")":""},fa.prototype.getSize=function(){function a(a){a&&e.push($.getSize(a))}var b=this;if(b._sizePromise)return b._sizePromise;var c=new ba;b._sizePromise=c;var d=b.get("size")||0;if(d||b._hls)return c.resolve(d),c;var e=[],f=b.get("url");if("object"==typeof f){var g=[f.audioUrl,f.videoUrl];g.forEach(a)}else a(f);e.length>0?e=1===e.length?e[0]:ba.when(e):(e=new ba,e.reject());var h=b.get("altUrl");return e.success(function(){for(var a=arguments,d=0,e=a.length-1;e>=0;e--)d+=a[e];b.set("size",d),c.resolve(d)}).fail(function(){if(h){var a=$.getSize(h);a.success(function(a){b.set("size",a)}),c.bind(a)}else c.reject(null)}),c};var ga=function(a,b){this.api=La,this._uninitialized=!0,$.defined(b)||(b=-1),this._tid=b,this.data=[],this.setMediaData(a)};ga.prototype={setMediaData:function(a){var b=this,c=new ba;return a?(ba(a).done(function(a){if(b._uninitialized&&0===a.length)return b._uninitialized=!1,void c.reject(b,!0);b._uninitialized=!1;var d=b.data,f=new Array(d.length),g=d.map(function(a){return a.id()});a.forEach(function(a){a.id=a.id||e(a);var c,h=g.indexOf(a.id);-1===h?(g.push(a.id),c=new fa(a),d.push(c)):(h<f.length&&(f[h]=!0),c=d[h],c.merge(a)),c._ditem=b.api.item(b._tid,a.id)});for(var h=f.length!==d.length,i=f.length-1;i>=0;i--)f[i]||(h=!0,d.splice(i,1));c.resolve(b,h)}),c):(c.reject(this,!1),c)},getMediaCount:function(){var a=this.data;if(0===a.length)return 0;for(var b=0,c={},d=0;d<a.length;++d){var e=a[d],f=e.title()+e.type();c[f]||(c[f]=!0,++b)}return b},getMedia:function(a){return this.data.filter(function(b){return b.id()==a})[0]},getMediaGroup:function(a){return this.data.filter(function(b){return-1!==a.indexOf(b.id())})},download:function(a){var b=this.getMedia(a);if(b){var c={id:b.id(),url:b.url(),filename:b.getFilename(),referrer:b.referrer(),hls:b._hls},d=this.api.download(this._tid,c);return d.success(function(a){b._ditem=a}),d}},onChange:function(a){this.api.onChange(this._tid,a)},group:function(){return i(f(this.data,["type","title","ext","quality"]))},isOneMedia:function(){for(var a,b,c=this.data,d={},e=0,f=0;e<c.length&&1>=f;++e)if(a=c[e],b=a.title()+a.type(),!d[b]&&(d[b]=!0,++f>1))return!1;return!0}};var ha=function(){this._storage=chrome.storage.local,this._options={},this._default={on_page_buttons:!0,min_stream_size:30720,prefer_last_quality:!0};var a=this;chrome.storage.onChanged.addListener(function(b,c){if("local"===c)for(var d in b)a._options[d]=b[d].newValue})};ha.prototype={load:function(){var a=new ba,b=this;return this._storage.get(null,function(c){b._options=c,a.resolve(c)}),a},set:function(a,b){var c={};("string"==typeof a||"number"==typeof a&&"undefined"!=typeof b)&&(c[a]=b,this._options[a]=b,this._storage.set(c))},get:function(a){return a in this._options?this._options[a]:this._default[a]}},function(){var c=function(){};c.SOURCE_POPUP_PAGE=0,c.SOURCE_OPTIONS_PAGE=10,c.SOURCE_CONTENT_SCRIPT=20,c.SOURCE_BACKGROUND_PAGE=30,c.prototype={LEGACY_METRICS_NAME_MAP:{ButtonClicked:"TryItNowButtonClicked",CheckBoxClicked:"OneClickCheckbox"},get source(){if(!chrome.extension.getBackgroundPage)return c.SOURCE_CONTENT_SCRIPT;switch(b.location.pathname){case"/popup.html":return c.SOURCE_POPUP_PAGE;case"/options.html":return c.SOURCE_OPTIONS_PAGE;case"/background.html":return c.SOURCE_BACKGROUND_PAGE;default:return}},_getFullName:function(a){return"Savior."+(this.LEGACY_METRICS_NAME_MAP[a]||a)},_getTotalValue:function(a,b,c){return c||"PageShown"===a||"number"!=typeof b?b:b+this.source},_doLog:function(a,b,d){var e=this._getFullName(b);if(this.source===c.SOURCE_CONTENT_SCRIPT)chrome.runtime.sendMessage({requestType:"metrics",method:"log",params:{name:b,value:d}});else if(chrome.metricsPrivate)switch(a){case"recordSmallCount":chrome.metricsPrivate.recordSmallCount(e,d);break;case"recordValue":chrome.metricsPrivate.recordValue({metricName:e,type:"histogram-linear",min:0,max:1e3,buckets:1002},d);break;case"recordSerpData":case"recordClickData":chrome.metricsPrivate[a](d)}else console.info("[Metrics]",a,e,d)},_getMethodByName:function(a){switch(a){case"Refr":case"RefrSE":case"RefrFE":return"recordValue";case"SerpData":return"recordSerpData";case"SerpClickData":return"recordClickData";default:return"recordSmallCount"}},log:function(a,b,c){var d=this._getMethodByName(a),e=this._getTotalValue(a,b,c);this._doLog(d,a,e)},logFromContentScript:function(a,b){this.log(a,b,!0)},PAGE_WELCOME_SCREEN:0,PAGE_DOWNLOADS_LIST:1,PAGE_ONE_CLICK_DOWNLOAD:2,PAGE_NO_MEDIA_FOUND:3,PAGE_OPTIONS:4,PAGE_CONTENT_SHOW_CONTROLS:5,PAGE_CONTENT_NO_MEDIA:9,DOWNLOAD_AUTO:0,DOWNLOAD_BUTTON:1,DOWNLOAD_ALL:2,DOWNLOAD_REQUEST_SIZE:3,DOWNLOAD_REQUEST_SIZE_FAILED:4,DOWNLOAD_CANCELED:7,BUTTON_MAIN:0,BUTTON_TRY_IT_NOW:1,BUTTON_SHOW_DOWNLOADS:2,BUTTON_HIDE_DOWNLOADS:3,BUTTON_DOWNLOAD_ALL:4,BUTTON_CHECK_ALL:5,BUTTON_CHECK_NONE:6,BUTTON_FAKE_QUALITY:7,CHECK_BOX_ENABLE_ONE_CLICK:0,CHECK_BOX_SHOW_ON_PAGE_BUTTONS:2,CHECK_BOX_PREFER_LAST_QUALITY:4},a.metrics=new c}();var ia,ja=function(){var c=function(a,b){var c=new Set(["string","number","boolean","undefined"]),d=function(a){if(null===a||c.has(typeof a))return a;if(Array.isArray(a))return a.map(d);if("object"==typeof a&&Object.getPrototypeOf(a)===Object.prototype){var b={};return Object.keys(a).forEach(function(c){b[c]=d(a[c])}),b}return null},e={report:function(b,c){b(Array.isArray(c)?d(c.reduce(function(a,b){return a&&a[b]},a)):null)}};a.addEventListener("message",function(c){if(c.origin===location.origin&&c.data&&c.data.port===b&&"coc_crx2page"===c.data.type){const d=c.data.id;var f=c.data.data,g=function(c){c={data:c,id:d,port:b,type:"coc_page2crx"},a.postMessage(c,location.origin)};"method"in f&&f.method in e&&e[f.method].apply(e,[g].concat(f.args))}})},d=function(){this.port=Math.floor(Math.random()*Math.pow(2,32)),this.msgId=0,this._promises={},this._initPage(),a.addEventListener("message",this._listener.bind(this))};return d.prototype={send:function(b){b={data:b,id:this.msgId,port:this.port,type:"coc_crx2page"};var c=new ba;return this._promises[this.msgId]=c,this.msgId++,a.postMessage(b,location.origin),c},_initPage:function(){var a=b.head||b.body;a||console.warn("trying to run pagecomm without target element!");var d=b.createElement("script"),e="("+c.toString()+")(window,"+this.port+")";d.innerText=e,a.appendChild(d),setTimeout(function(){a.removeChild(d)},100)},_listener:function(a){if(a.origin===location.origin&&a.data&&a.data.port===this.port&&"coc_page2crx"===a.data.type){var b=a.data;try{this._promises[b.id]instanceof ba&&this._promises[b.id].resolve(b.data)}finally{delete this._promises[b.id]}}}},d}();b.addEventListener("DOMContentLoaded",function(){ia=new ja});var ka=$.query.bind($),la=$.queryAll.bind($),ma=function(a,b,c,d,e){this._node=b,this._docId=d,this._index=e,this._data=this._extractData(b,c),this._validateAndSetDataType(a),this._attachClickHandler()};ma.prototype={TITLE_SELECTOR:"h3",VISIBLE_URL_SELECTOR:"cite",LINK_SELECTOR:"h3 a:not([id])",DESC_SELECTOR:".st",_extractData:function(a,b){var c=ka(this.TITLE_SELECTOR,a),d=ka(this.VISIBLE_URL_SELECTOR,a),e=ka(this.DESC_SELECTOR,a),f=ka(this.LINK_SELECTOR,a),g={url:j(f,"href"),visibleUrl:j(d,"textContent"),position:b,title:j(c,"textContent"),description:j(e,"textContent"),addRawContent:""};return g},_validateAndSetDataType:function(a){this._isDataValid(this._data)?this._data.type=a:this._data.type="unknown"},_isDataValid:function(a){return Boolean(a.title&&a.visibleUrl&&a.url&&a.description)},_attachClickHandler:function(){this._clickHandler=this._onClick.bind(this),this._node.addEventListener("click",this._clickHandler,!0)},_onClick:function(a){var b,c,d=$.nearestParent(a.target,"a");return d&&d.nodeType===Node.ELEMENT_NODE&&(b=d.getAttribute("href"),b.trim().match(/^(#|javascript:)/)||(c=d.dataset.href||d.href||this.data.url||"",this._reportClick(c))),!0},_reportClick:function(a){metrics.log("SerpClickData",{serpId:this._docId,itemIndex:this._index,timestamp:Date.now(),url:a})},_reportClickConsole:function(a){console.log("Click reported:\n%cserpId: %c%s\n%citem index: %c%s\n%curl: %c%s","font-weight:bold","font-weight:normal",this._docId,"font-weight:bold","font-weight:normal",this._index,"font-weight:bold","font-weight:normal",a)},destroy:function(){this._node.removeEventListener(this._clickHandler),this._node=null,this._data=null},get data(){return this._data},renderToConsole:function(){var a=this.data.type,b="top-ad"===a||"bottom-ad"===a||"side-ad"===a;b?console.log("%d. %c%s%c %s",this._index,"font-size:16px;font-family:arial,sans-serif;padding: 0 3px;background-color:#efc439;color:#fff;",this.data.type,"font-size:18px;font-family:arial,sans-serif;color:#1a0dab;",this.data.title):console.log("%d. [%s] %c%s",this._index,a,"color:#1a0dab; font-size:18px;font-family:arial,sans-serif;",this.data.title),console.groupCollapsed(this.data.visibleUrl),console.log("%curl: %c%s","font-weight:bold;","font-weight:normal",this.data.url),console.log("%cpos: %c%d","font-weight:bold;","font-weight:normal",this.data.position),this.data.addRawContent&&console.log("%cadditional content: %c%s","font-weight:bold;","font-weight:normal",this.data.addRawContent),console.groupEnd(this.data.visibleUrl),console.log("%c%s\n\n","color:#545454; font-size:13px; font-family:arial,sans-serif;",this.data.description)}};var na=function(){ma.apply(this,arguments)};na.prototype={__proto__:ma.prototype,DESC_SELECTOR:".ads-creative",LINK_SELECTOR:"h3 a:last-child",NOT_RAW_CONTENT_SELECTOR:"h3, .ads-visurl, .ads-creative",_extractAdditionalContent:function(){var a="";return $.toArray(this._node.children).forEach(function(b){b.matches(this.NOT_RAW_CONTENT_SELECTOR)||(a+=b.outerHTML+"\n")}.bind(this)),a},_extractData:function(){var a=ma.prototype._extractData.apply(this,arguments),b=this._extractAdditionalContent();return a.addRawContent=b,a}};var oa={"top-ad":na,"bottom-ad":na,"side-ad":na},pa=function(a,b,c,d,e){var f=oa[a]||ma;return new f(a,b,c,d,e)},ka=$.query.bind($),qa=function(){this._handlers=[],a.addEventListener("popstate",this._onPopState.bind(this)),a.addEventListener("DOMContentLoaded",function(){var a=this._queryParams;a.q&&(a.isHash?this._startPolling():this._fireHandlers())}.bind(this))};qa.prototype={POLLING_INTERVAL:200,_onPopState:function(a){this._startPolling()},_stashDOMState:function(){var a=ka("em");this._lastEm=a||null},get _queryParams(){var a=b.location,c=k(a.search),d=k(a.hash),e=$.defined(d.q);return{q:e?d.q:c.q||null,s:e?d.start||0:c.start||0,tbm:e?d.tbm:c.tbm||null,isHash:e}},get _isDOMStateDifferent(){var a=ka("em");return a&&a!==this._lastEm?!0:!1},_startPolling:function(){this._stopPolling(),this._stashDOMState(),this._timerId=setInterval(this._onTimerTick.bind(this),this.POLLING_INTERVAL)},_stopPolling:function(){clearInterval(this._timerId)},_onTimerTick:function(){this._isDOMStateDifferent&&(this._stopPolling(),this._fireHandlers())},_fireHandlers:function(){var a=this._queryParams;this._handlers.forEach(function(b){b(a)})},addHandler:function(a){this._handlers=this._handlers||[],this._handlers.push(a)},removeHandler:function(a){this._handlers=this._handlers.filter(function(b){return b!==a})}};var ra=function(){if(this.isValidSerpPage()){var a;this._items=[],this.isScrapeable&&(a=new qa,a.addHandler(this._onComplete.bind(this)))}};ra.prototype={isValidSerpPage:function(){var a="com|ac|ad|ae|al|am|as|at|az|ba|be|bf|bg|bi|bj|bs|bt|by|ca|cc|cd|cf|cat|cg|ch|ci|cl|cm|cn|cv|cz|de|dj|dk|ee|fi|dm|dz|es|fm|fr|ga|ge|gf|gg|gl|gm|gp|gr|gy|hn|hr|ht|hu|ir|iq|ie|im|io|is|it|je|ki|kg|jo|kz|la|lt|lu|lv|li|lk|md|me|mg|mk|ml|mn|ms|mu|mv|mw|nl|no|nr|nu|pl|ne|pn|ps|pt|ro|rs|ru|rw|sc|se|sh|si|sn|sm|so|tk|tl|tm|to|tn|st|sk|tt|td|vu|ws|vg|tg|us",c="th|id|il|in|jp|ke|ma|kr|mz|ls|nz|tz|ug|uk|uz|ve|vi|za|zm|zw|ao|ck|bw|cr",d="pr|py|qa|sa|sb|sg|sl|sv|tj|tn|tr|tw|gh|gi|gt|hk|jm|kw|lb|lc|ly|mm|mt|mx|my|na|nf|ng|ni|np|om|pa|pe|ph|pk|pg|ua|uy|vc|vn|af|ag|ai|ar|au|bd|bh|bn|bo|br|bz|kh|co|cu|cy|do|ec|eg|et|fj",e=b.location,f=new RegExp("^(www\\.)?google\\.(("+a+")|(co((\\.("+c+"))|m\\.("+d+"))))$","i");return e.host.match(f)},_onComplete:function(a){a.tbm||(this._cleanup(),this.scrape(a),this.report())},get isScrapeable(){return!0},_cleanup:function(){this._items.forEach(function(a){a.destroy()}),this._items=[]},_addItem:function(a,b,c){var d=this._items.length;this._items.push(new pa(a,b,c,this._docId,d))},_scrapeAds:function(a){var b={"top-ad":"#tads > ol > li","bottom-ad":"#tadsb > ol >li","side-ad":"#mbEnd > ol > li"},c=la(b[a]);return c.forEach(function(b,c){this._addItem(a,b,c)}.bind(this)),c.length},_scrapeSER:function(a,b){var c=$.toArray(a.children).filter(function(a){return a.nodeType===Node.ELEMENT_NODE});return c.forEach(function(a,c){this._addItem("organic",a,b+c)}.bind(this)),c.length},_scrapeResults:function(){var a=la("#ires ol > *"),b=0,c="hr";return a.forEach(function(a,d){if(""!==a.textContent.trim()&&!a.matches(c)){var e=a.matches(".srg")?a:a.querySelector(".srg");e?b+=this._scrapeSER(e,b):this._addItem("organic",a,b++)}}.bind(this)),b},_generateDocId:function(){return Date.now().toString(32)+"-"+Math.random().toString(32).slice(2)},scrape:function(a){this._docId=this._generateDocId(),this._q=a.q||"",this._s=a.s,this._scrapeAds("top-ad"),this._scrapeResults(),this._scrapeAds("bottom-ad"),this._scrapeAds("side-ad")},_metricsReport:function(){var a={type:"gsearch",id:this._docId,searchQuery:this._q,searchStart:this._s,timestamp:Date.now(),items:this._items.map(m("data"))};metrics.log("SerpData",a)},_consoleReport:function(){console.log("%cSerp Id: %c%s","font-size: 18px;font-weight:bold","font-size: 18px;font-weight:normal",this._docId),console.log("%cQuery: %c%s","font-size: 18px;font-weight:bold","font-size: 18px;font-weight:normal",this._q),console.log("%cStart: %c%s","font-size: 18px;font-weight:bold","font-size: 18px;font-weight:normal",this._s),this._items.forEach(l("renderToConsole"))},report:function(){this._metricsReport()}};var sa,ta=(new ra,{extract:function(a){var b,c=a.getAttribute("flashvars").split("&");return c.forEach(function(a){a=a.split("="),"file"===a[0]&&(b=decodeURIComponent(a[1]))}),b},parsePlaylist:function(a,b){var c=$.xmlParser.parseFromString(b,"text/xml"),e=[];return $.queryAll("track",c).forEach(function(a){var b=a.querySelector("location").textContent.trim(),c=Z.parse(b);if(!d(c.ext)){var f=[a.querySelector("title").textContent.trim()],g=a.querySelector("creator");g&&""!==g.textContent.trim()&&f.unshift(g.textContent.trim()),c.type="mp3"===c.ext?"audio":"video",c.title=f.join(" – "),e.push(c)}}),e}}),ua={_getMedia:function(a){var b=Z.parse(a);return b.type="video",b.ext="m3u8",b},parsePlaylist:function(a,b){var c=[];if(0!==b.indexOf("#EXTM3U"))return c;for(var d,e,f=Z.parse0(a),g=0,h=0,i=b.split("\n"),j=0;j<i.length;j++){var k=i[j];if(k)if(0===k.indexOf("#"))0===k.indexOf("#EXTINF:")?g=1:0===k.indexOf("#EXT-X-STREAM-INF:")&&(g=2);else{switch(g){case 1:h+=1;break;case 2:d=Z.resolve(k,f),e=ua._getMedia(d),e&&c.push(e)}g=0}}return 0===c.length&&h>0&&(e=ua._getMedia(a),e&&c.push(e)),c}};!function(){function a(a){return $.isMatches(a,V)}function b(){var a=$.queryAll(c).map(o).filter($.notNull);return a=$.unique(a),1===a.length?a[0]:null}var c='embed[type="application/x-shockwave-flash"], object[type="application/x-shockwave-flash"]';const e=q({request:{method:"GET",url:function(a){return d(a.ext)?a.url:null}},parse:function(a,b){return b?ua.parsePlaylist(a,b):[a]}});sa=r("default",function(){var c=location.host,d=[];if(a(c))return d;for(var f=$.queryAll("[src]"),g=[],h=0,i=f.length;i>h;++h){var j=f[h],k=j.src,l=Z.getMediaType(k);if(l&&j.getAttribute("src")){var m=Z.parse(k);s(m.host)||(m.type=l,fa.isValidData(m)&&(j=o(j),j?d.push(this.makePlayer0(j,[m],e)):g.push(m)))}}return g.length&&d.push(this.makePlayer(null,g,e)),d.push(this.makePlayer0(b(),this._ids,e)),d},!0)}();var va;const wa={"3072p":"Super HD","2160p":"Ultra HD","1440p":"Quad HD","1080p":"Full HD","720p":"HD","480p":"Standard","360p":"Medium","270p":"Small","240p":"Small","144p":"Mobile"};!function(){function a(b){var c=b.split("&"),d={},e=0;return c.forEach(function(b){var c=b.split("="),f=c[0],g=c[1];if(f&&"undefined"!=typeof g){var h="undefined"==typeof d[f]?f:f+e++;if("url"==f||"title"==f||"type"===f)d[h]=decodeURIComponent(g);else if("url_encoded_fmt_stream_map"===f||"adaptive_fmts"===f){var i=decodeURIComponent(g).split(",");d[h]=i.map(a)}else d[h]=a(decodeURIComponent(g||""))}else d=b}),d}function c(a){for(var b,c=0;c<k.length;++c)if(b=a.match(k[c]))return b[1];return null}function d(a){var b=new ba;return $.get(l+a).success(function(a){try{var c=JSON.parse(f(a))}catch(d){return b.reject(d)}i({},"todme",c,e.bind(this,b))}).fail(function(a){return b.reject(a)}),b}function e(a,b,c){var d={},e=[],f=c.formats.map(function(a){a.resolution&&wa[a.resolution]&&(a.quality=wa[a.resolution]);var b={ext:a.container,filename:c.title,quality:a.quality,url:a.url,type:$.getMediaType(a.type)},f=Z.parse(a.url);return f.host=a.fallback_host,f.host&&(b.altUrl=Z.format(f)),!a.encoding&&a.audioEncoding&&(d[a.container]=d[a.container]||{audioBitrate:0},d[a.container].audioBitrate<a.audioBitrate&&(d[a.container]=a)),a.audioEncoding||e.push(b),b});e.forEach(function(a,b){if(!d[a.ext]||!d[a.ext].url||!p[a.ext])return a.url=null,void(a.quality=null);var c=a.url;a.url={videoUrl:decodeURIComponent(c),audioUrl:decodeURIComponent(d[a.ext].url)}}),a.resolve(f.filter(function(a){return!!a.url}))}function f(a){var b=/ytplayer.config = (\{[\s\S]*?\});ytplayer.load/,c=a.match(b);return c&&c[1]||null}function g(b,c){var d=[];return b.url_encoded_fmt_stream_map&&(d=d.concat(b.url_encoded_fmt_stream_map.split(","))),b.adaptive_fmts&&(d=d.concat(b.adaptive_fmts.split(","))),d=d.map(function(b){var d=a(b);d.conn&&0===d.conn.indexOf("rtmp")&&(d.rtmp=!0);var e=t[d.itag];return!e&&c&&console.warn("No format metadata for itag "+d.itag+" found"),$.extendObject(d,e),d}),delete b.url_encoded_fmt_stream_map,delete b.adaptive_fmts,d.sort(h),d}function h(a,b){var c=a.resolution?parseInt(a.resolution.slice(0,-1),10):0,d=b.resolution?parseInt(b.resolution.slice(0,-1),10):0,e=a.audioBitrate||0,f=b.audioBitrate||0,g=2*~~!!c+~~!!e,h=2*~~!!d+~~!!f;if(g===h){if(c===d){var i,j,k;return a.bitrate?(k=a.bitrate.split("-"),i=parseFloat(k[k.length-1],10)):i=0,b.bitrate?(k=b.bitrate.split("-"),j=parseFloat(k[k.length-1],10)):j=0,i===j?f-e:j-i}return d-c}return h-g}function i(a,b,c,d){var e=c.args;return"fail"===e.status?void d(new Error("Error "+e.errorcode+": "+e.reason)):(u.forEach(function(a){e[a]&&(e[a]=e[a].split(",").filter(function(a){return""!==a}))}),e.fmt_list=e.fmt_list?e.fmt_list.map(function(a){return a.split("/")}):[],e.video_verticals&&(e.video_verticals=e.video_verticals.slice(1,-1).split(", ").filter(function(a){return""!==a}).map(function(a){return parseInt(a,10)})),e.formats=g(e),e.description=b,void v.get(e,c.assets.js,!1,d))}const j="https:"===location.protocol.toLowerCase()?"https:":"http:",k=[/^https?:\/\/(?:www\.)?youtube(?:-nocookie)?(?:\.googleapis)?\.com\/(?:(?:v)|(?:embed)|(?:e))\/([^&\?]+)/i,/https?:\/\/(?:www\.)?youtube\.com\/.*(?:\?|&)v=([^&\?]+)/i],l=j+"//www.youtube.com/watch?v=",m=[/^https?:\/\/(?:www\.)?facebook.com\//i],n=$.isMatches(b.location.href,m),p=Y.YT,s=(["&keepalive=yes","alr=yes","gir=yes","c=WEB","cver=html5"].join("&"),q({parse:function(a){return movies=d(a),movies}}));va=r("youtube",function(){var a,b=this,d=[],e=[];if(!$.query("#player-unavailable:not(.hid)")){a=$.query(".html5-video-player")||$.query("#player, #movie_player, #movie_player-html5, #movie_player-flash");var f=$.queryAll('embed[type="application/x-shockwave-flash"]',a);if(1===f.length&&(f=o(f[0]),f&&(a=f)),a){a=b.makePlayer(a,[],s);var g=c(location.href);g&&(a.ids.push(g),e.push(g))}}var h=$.query(".channels-video-player, #upsell-video");if(h){var i=h.dataset;if(h=b.makePlayer(h,[],s),i){var g=i.videoId;g&&(h.ids.push(g),e.push(g))}a||(a=h,h=null)}var j='iframe[src*="youtube"], embed[src*="youtube"]';return n&&(j+=', a[href*="youtube.com"]'),$.queryAll(j).forEach(function(a){var f=c(a.src||decodeURIComponent(a.href));f&&-1===e.indexOf(f)&&(e.push(f),"A"===a.tagName&&(a=null),d.push(b.makePlayer(a,[f],s)))}),h&&h.ids.length&&d.splice(0,0,h),a&&a.ids.length&&d.splice(0,0,a),d.push(b.makePlayer(null,this._ids,s)),d},!0),va.getMoviesById=d;const t={5:{container:"flv",resolution:"240p",encoding:"Sorenson H.283",profile:null,bitrate:"0.25",audioEncoding:"mp3",audioBitrate:64},6:{container:"flv",resolution:"270p",encoding:"Sorenson H.263",profile:null,bitrate:"0.8",audioEncoding:"mp3",audioBitrate:64},13:{container:"3gp",resolution:null,encoding:"MPEG-4 Visual",profile:null,bitrate:"0.5",audioEncoding:"aac",audioBitrate:null},17:{container:"3gp",resolution:"144p",encoding:"MPEG-4 Visual",profile:"simple",bitrate:"0.05",audioEncoding:"aac",audioBitrate:24},18:{container:"mp4",resolution:"360p",encoding:"H.264",profile:"baseline",bitrate:"0.5",audioEncoding:"aac",audioBitrate:96},22:{container:"mp4",resolution:"720p",encoding:"H.264",profile:"high",bitrate:"2-3",audioEncoding:"aac",audioBitrate:192},34:{container:"flv",resolution:"360p",encoding:"H.264",profile:"main",bitrate:"0.5",audioEncoding:"aac",audioBitrate:128},35:{container:"flv",resolution:"480p",encoding:"H.264",profile:"main",bitrate:"0.8-1",audioEncoding:"aac",audioBitrate:128},36:{container:"3gp",resolution:"240p",encoding:"MPEG-4 Visual",profile:"simple",bitrate:"0.175",audioEncoding:"aac",audioBitrate:36},37:{container:"mp4",resolution:"1080p",encoding:"H.264",profile:"high",bitrate:"3-5.9",audioEncoding:"aac",audioBitrate:192},38:{container:"mp4",resolution:"3072p",encoding:"H.264",profile:"high",bitrate:"3.5-5",audioEncoding:"aac",audioBitrate:192},43:{container:"webm",resolution:"360p",encoding:"VP8",profile:null,bitrate:"0.5",audioEncoding:"vorbis",audioBitrate:128},44:{container:"webm",resolution:"480p",encoding:"VP8",profile:null,bitrate:"1",audioEncoding:"vorbis",audioBitrate:128},45:{container:"webm",resolution:"720p",encoding:"VP8",profile:null,bitrate:"2",audioEncoding:"vorbis",audioBitrate:192},46:{container:"webm",resolution:"1080p",encoding:"vp8",profile:null,bitrate:null,audioEncoding:"vorbis",audioBitrate:192},82:{container:"mp4",resolution:"360p",encoding:"H.264",profile:"3d",bitrate:"0.5",audioEncoding:"aac",audioBitrate:96},83:{container:"mp4",resolution:"240p",encoding:"H.264",profile:"3d",bitrate:"0.5",audioEncoding:"aac",audioBitrate:96},84:{container:"mp4",resolution:"720p",encoding:"H.264",profile:"3d",bitrate:"2-3",audioEncoding:"aac",audioBitrate:192},85:{container:"mp4",resolution:"1080p",encoding:"H.264",profile:"3d",bitrate:"3-4",audioEncoding:"aac",audioBitrate:192},100:{container:"webm",resolution:"360p",encoding:"VP8",profile:"3d",bitrate:null,audioEncoding:"vorbis",audioBitrate:128},101:{container:"webm",resolution:"360p",encoding:"VP8",profile:"3d",bitrate:null,audioEncoding:"vorbis",audioBitrate:192},102:{container:"webm",resolution:"720p",encoding:"VP8",profile:"3d",bitrate:null,audioEncoding:"vorbis",audioBitrate:192
},133:{container:"mp4",resolution:"240p",encoding:"H.264",profile:"main",bitrate:"0.2-0.3",audioEncoding:null,audioBitrate:null},134:{container:"mp4",resolution:"360p",encoding:"H.264",profile:"main",bitrate:"0.3-0.4",audioEncoding:null,audioBitrate:null},135:{container:"mp4",resolution:"480p",encoding:"H.264",profile:"main",bitrate:"0.5-1",audioEncoding:null,audioBitrate:null},136:{container:"mp4",resolution:"720p",encoding:"H.264",profile:"main",bitrate:"1-1.5",audioEncoding:null,audioBitrate:null},137:{container:"mp4",resolution:"1080p",encoding:"H.264",profile:"high",bitrate:"2-3",audioEncoding:null,audioBitrate:null},138:{container:"mp4",resolution:"2160p",encoding:"H.264",profile:"high",bitrate:"13.5",audioEncoding:null,audioBitrate:null},160:{container:"mp4",resolution:"144p",encoding:"H.264",profile:"main",bitrate:"0.1",audioEncoding:null,audioBitrate:null},242:{container:"webm",resolution:"240p",encoding:"VP9",profile:null,bitrate:"0.14",audioEncoding:null,audioBitrate:null},243:{container:"webm",resolution:"360p",encoding:"VP9",profile:null,bitrate:"0.26",audioEncoding:null,audioBitrate:null},244:{container:"webm",resolution:"480p",encoding:"VP9",profile:null,bitrate:"0.585",audioEncoding:null,audioBitrate:null},247:{container:"webm",resolution:"720p",encoding:"VP9",profile:null,bitrate:"1.184",audioEncoding:null,audioBitrate:null},248:{container:"webm",resolution:"1080p",encoding:"VP9",profile:null,bitrate:"1.895",audioEncoding:null,audioBitrate:null},264:{container:"mp4",resolution:"1440p",encoding:"H.264",profile:"high",bitrate:"4-5",audioEncoding:null,audioBitrate:null},266:{container:"mp4",resolution:"2160p",encoding:"H.264",profile:"high",bitrate:"12.5-13.5",audioEncoding:null,audioBitrate:null},271:{container:"webm",resolution:"1440p",encoding:"VP9",profile:null,bitrate:"9",audioEncoding:null,audioBitrate:null},272:{container:"webm",resolution:"2160p",encoding:"VP9",profile:null,bitrate:"20",audioEncoding:null,audioBitrate:null},278:{container:"webm",resolution:"144p",encoding:"VP9",profile:null,bitrate:"0.08",audioEncoding:null,audioBitrate:null},298:{container:"mp4",resolution:"720p",encoding:"H.264",profile:"main",bitrate:"3-3.5",audioEncoding:null,audioBitrate:null},299:{container:"mp4",resolution:"1080p",encoding:"H.264",profile:"high",bitrate:"5.5",audioEncoding:null,audioBitrate:null},302:{container:"webm",resolution:"720p",encoding:"VP9",profile:null,bitrate:"2.5",audioEncoding:null,audioBitrate:null},303:{container:"webm",resolution:"1080p",encoding:"VP9",profile:null,bitrate:"5",audioEncoding:null,audioBitrate:null},139:{container:"mp4",resolution:null,encoding:null,profile:null,bitrate:null,audioEncoding:"aac",audioBitrate:48},140:{container:"mp4",resolution:null,encoding:null,profile:null,bitrate:null,audioEncoding:"aac",audioBitrate:128},141:{container:"mp4",resolution:null,encoding:null,profile:null,bitrate:null,audioEncoding:"aac",audioBitrate:256},171:{container:"webm",resolution:null,encoding:null,profile:null,bitrate:null,audioEncoding:"vorbis",audioBitrate:128},172:{container:"webm",resolution:null,encoding:null,profile:null,bitrate:null,audioEncoding:"vorbis",audioBitrate:192},92:{container:"ts",resolution:"240p",encoding:"H.264",profile:"main",bitrate:"0.15-0.3",audioEncoding:"aac",audioBitrate:48},93:{container:"ts",resolution:"480p",encoding:"H.264",profile:"main",bitrate:"0.5-1",audioEncoding:"aac",audioBitrate:128},94:{container:"ts",resolution:"720p",encoding:"H.264",profile:"main",bitrate:"0.8-1.25",audioEncoding:"aac",audioBitrate:128},95:{container:"ts",resolution:"1080p",encoding:"H.264",profile:"main",bitrate:"1.5-3",audioEncoding:"aac",audioBitrate:256},96:{container:"ts",resolution:"720p",encoding:"H.264",profile:"main",bitrate:"2.5-6",audioEncoding:"aac",audioBitrate:256},120:{container:"flv",resolution:"720p",encoding:"H.264",profile:"Main@L3.1",bitrate:"2",audioEncoding:"aac",audioBitrate:128},127:{container:"ts",resolution:null,encoding:null,profile:null,bitrate:null,audioEncoding:"aac",audioBitrate:96},128:{container:"ts",resolution:null,encoding:null,profile:null,bitrate:null,audioEncoding:"aac",audioBitrate:96},132:{container:"ts",resolution:"240p",encoding:"H.264",profile:"baseline",bitrate:"0.15-0.2",audioEncoding:"aac",audioBitrate:48},151:{container:"ts",resolution:"720p",encoding:"H.264",profile:"baseline",bitrate:"0.05",audioEncoding:"aac",audioBitrate:24}},u=["keywords","fmt_list","fexp","watermark"];var v=function(a){function b(a,b){var c=a[0];return a[0]=a[b%a.length],a[b]=c,a}a.get=function(b,c,d,e){b.formats[0]&&b.formats[0].s?(c=j+c,$.get(c).success(function(c){var f=a.extractActions(c);return f&&f.length?(b.formats.forEach(function(b){var c=a.decipher(f,b.s);b.url=a.getDownloadURL(b,c,d)}),void e(null,b)):void e(new Error("could not extract signature deciphering actions"))}).fail(e)):(b.formats.forEach(function(b){var c=b.sig||"";b.url=a.getDownloadURL(b,c,d)}),e(null,b))},a.getDownloadURL=function(a,b,c){var d;if(a.url)d=a.url;else{if(!a.stream)return c&&console.warn("download url not found for itag "+a.itag),null;a.conn?(d=a.conn,"/"!==d[d.length-1]&&(d+="/"),d+=a.stream):d=a.stream}try{d=decodeURIComponent(d)}catch(e){return c&&console.warn("could not decode url: "+e.message),null}var f=Z.parse(d,!0);delete f.search;var g=f.query;return g.ratebypass="yes",b&&(g.signature=b),Z.format(f)},a.decipher=function(a,c){c=c.split("");for(var d,e=0,f=a.length;f>e;e++){var g=a[e];switch(g[0]){case"r":c=c.reverse();break;case"w":d=~~g.slice(1),c=b(c,d);break;case"s":d=~~g.slice(1),c=c.slice(d);break;case"p":d=~~g.slice(1),c.splice(0,d)}}return c.join("")};var c="[a-zA-Z_\\$][a-zA-Z_0-9]*",d=":function\\(a\\)\\{(?:return )?a\\.reverse\\(\\)\\}",e=":function\\(a,b\\)\\{return a\\.slice\\(b\\)\\}",f=":function\\(a,b\\)\\{a\\.splice\\(0,b\\)\\}",g=":function\\(a,b\\)\\{var c=a\\[0\\];a\\[0\\]=a\\[b%a\\.length\\];a\\[b\\]=c(?:;return a)?\\}",h=new RegExp("var ("+c+")=\\{((?:(?:"+c+d+"|"+c+e+"|"+c+f+"|"+c+g+"),?)+)\\};function "+c+'\\(a\\)\\{a=a\\.split\\(""\\);((?:(?:a=)?\\1\\.'+c+'\\(a,\\d+\\);)+)return a\\.join\\(""\\)\\}'),i=new RegExp("(?:^|,)("+c+")"+d),k=new RegExp("(?:^|,)("+c+")"+e),l=new RegExp("(?:^|,)("+c+")"+f),m=new RegExp("(?:^|,)("+c+")"+g);return a.extractActions=function(a){var b=h.exec(a);if(!b)return null;var c=b[1].replace("$","\\$"),d=b[2].replace("$","\\$"),e=b[3].replace("$","\\$");b=i.exec(d);var f=b&&b[1].replace("$","\\$");b=k.exec(d);var g=b&&b[1].replace("$","\\$");b=l.exec(d);var j=b&&b[1].replace("$","\\$");b=m.exec(d);for(var n=b&&b[1].replace("$","\\$"),o="(?:a=)?"+c+"\\.("+[f,g,j,n].join("|")+")\\(a,(\\d+)\\)",p=new RegExp(o,"g"),q=[];null!==(b=p.exec(e));)switch(b[1]){case n:q.push("w"+b[2]);break;case f:q.push("r");break;case g:q.push("s"+b[2]);break;case j:q.push("p"+b[2])}return q},a}({})}();var xa;!function(){function b(a){for(var b,c=0;c<g.length;++c)if(b=a.match(g[c]),b&&b[1])return b[1];return null}function c(a){var b=a.match(h)||[];return b[1]}function d(b){var c=[],d=b.request.files.h264;return d?(Object.keys(d).forEach(function(e){c.push({type:"video",title:b.video.title,filename:b.video.title,ext:"mp4",url:d[e].url,quality:a.quality.getVimeoQuality(e)})}),c):c}function e(a){switch(a.tagName){case"IFRAME":return b(a.src);case"PARAM":return c(a.value);case"VIDEO":return c(a.src);default:return b(a.getAttribute("data-fallback-url")||"")}return null}const f="https:"===location.protocol.toLowerCase()?"https:":"http:",g=[/\/\/(?:player\.)?vimeo\.com(?:\/video)?\/([0-9]+)/i,/\/\/vimeo.com\/couchmode\/.*\/([0-9]+)/i,/\/\/player.vimeo.com\/v[0-9]\/video\/([0-9]+)/i,/\/\/player.vimeo.com\/moog\/([0-9]+)/i],h=/(?:&|\?)clip_id=([0-9]+)(?:&|$)/i,i=f+"//player.vimeo.com/video/{{id}}/config?referrer={{location}}",j=q({request:{method:"GET",url:function(a){return a.match(/\/video\/(\d+)\/config(\?|$)/i)?a:i.replace("{{id}}",a).replace("{{location}}",location.href)}},parse:function(a,b){var c=JSON.parse(b);return d(c)}});xa=r("vimeo",function(){var a=this,c=[],d=[],f=$.queryAll('iframe[src*="vimeo.com"], param[value*="vimeo.com"], video[src*="vimeo.com"], .player[data-fallback-url]');if(f.forEach(function(b){var f=e(b);f&&-1===d.indexOf(f)?(d.push(f),c.push(a.makePlayer(b,[f],j))):console.log("missed",b,f)}),"vimeo.com"===location.host||"player.vimeo.com"===location.host){var g=$.query("#videos_gallery li.selected a"),h=g&&g.href||location.href,i=b(h);i&&-1===d.indexOf(i)&&(d.push(i),c.push(a.makePlayer(g,[i],j)))}return c.push(a.makePlayer(null,a._ids,j)),c},!0)}();var ya;!function(){function a(a){var b={};return a.split("&").forEach(function(a){var c=a.split("=");if("params"===c[0])try{b[c[0]]=JSON.parse(decodeURIComponent(c[1]))}catch(d){}else b[c[0]]=decodeURIComponent(c[1])}),b}function b(a,b){var c=[],d=a.video_data||a.params&&a.params.video_data;if(d){var f=$.query("h2.uiHeaderTitle")||$.query(".fbPhotoMediaTitleNoFullScreen");b=b||f&&f.textContent,j.forEach(function(a){d.forEach(function(d){var f=e(d[a],b||d.video_id,a);f&&c.push(f)})})}return c}function c(a){for(var b=/fbPhotoMediaTitleNoFullScreen\\">([^>]*)\\u003C|fbPhotoSnowliftVideoTitle\\">([^>]*)\\u003C/g,c=null;c=b.exec(a);)if(c&&(c[1]||c[2]))return c[1];return null}function d(a){var b=a.match(/\[\\"params\\",\\"([^"]+)\\"/i),c={};try{c=JSON.parse(decodeURIComponent(b[1].replace(/\\\\u0025/g,"%")))}catch(d){}return c}function e(a,b,c){var d;return a&&(d=Z.parse(a),d.type="video",c&&(d.quality=quality.getFacebookQuality(c)),b&&(d.title=b.replace(/\+(?!\+)/g," ").trim())),d}function f(a){var b=a.href||"",c=b.match(l);if(!c||!c[1])return null;for(var d=c[1],e=null;(a=a.parentNode)&&!(e=a.getAttribute("data-gt")););try{e=JSON.parse(e)}catch(f){return null}var g=e.viewerid;return g?k.replace("{{user_id}}",g).replace("{{data}}",encodeURIComponent(JSON.stringify({v:d,theater:null,firstLoad:!0}))):null}const g='embed[flashvars*="fbcdn.net"], embed[flashvars*="fbcdn-video"]',h="a.videoThumb",i=/(\.|^)(facebook|fb).com$/i,j=["hd_src","hd_src_no_ratelimit","sd_src","sd_src_no_ratelimit"],k="https://www.facebook.com/ajax/pagelet/generic.php/PhotoViewerInitPagelet?no_script_path=1&data={{data}}&__user={{user_id}}&__a=1&__dyn={{dyn}}&__req=jsonp_2&__adt=2",l=/^https?:\/\/(?:www\.)(?:facebook|fb)\.com\/(?:v\/|photo\.php\?v=)([0-9]+)/i,m=q({request:{method:"GET",url:function(a){return a.replace("{{dyn}}",Math.random().toString().slice(2))}},parse:function(a,e){var f=d(e),g=c(e);return b(f,g)}}),n=q({nocache:!0,parse:b});ya=r("facebook",function(){var b=this,c=[];if(location.host.match(i)){var d=$.queryAll(h);d.forEach(function(a){var d=f(a);d&&c.push(b.makePlayer(a,[d],m))})}var d=$.queryAll(g);return d.forEach(function(d){var e=d.getAttribute("flashvars");e=a(e),e&&c.push(b.makePlayer(d,[e],n))}),c})}();var za;!function(){function a(a){for(var b,c=[],d=[],e=/"stream_h264_(|ld_|hq_|hd_|hd1080_)url":"(http.*?)"/g;b=e.exec(a);)d.push(b[0]);if(0===d.length)return c;d=JSON.parse("{"+d.join(",")+"}");var g=a.match(/<title>(.*?)<\/title>/);return g&&(g=g[1].trim()),Object.keys(d).forEach(function(a){var b=d[a];if(b){var e=Z.parse(b);e.ext="mp4",e.type="video",e.quality=quality.getDailymotionQuality(f[a]),g&&(e.title=g),c.push(e)}}),c}const b=/^https?:\/\/(?:www\.)dailymotion\.com\/embed\/video\/([a-z0-9]+)/i,c=/"videoId":"([a-z0-9]+)"/i,d=/^#video=([a-z0-9]+)/i,e='param[name="flashvars"][value*="dailymotion.com"], iframe[src*="http://www.dailymotion.com/embed/video/"], embed[src*="http://www.dailymotion.com/embed/video/"]',f={stream_h264_url:"sd",stream_h264_ld_url:"ld",stream_h264_hq_url:"hq",stream_h264_hd_url:"hd",stream_h264_hd1080_url:"hd1080"},g=q({request:{method:"GET",url:function(a){return"http://www.dailymotion.com/embed/video/"+a}},parse:function(b,c){return a(c)}});za=r("dailymotion",function(){var a,f=this,h=[],i=[],j=$.queryAll(e);if(j.forEach(function(d){var e,j,k=!1;"PARAM"===d.tagName?(e=c,j=decodeURIComponent(d.value)):(e=b,j=d.src,k=!0);var l=j.match(e),m=l&&l[1];if(m&&-1===i.indexOf(m)){i.push(m);var n=f.makePlayer(d,[m],g);h.push(n),(k||!a)&&(a=n)}}),"www.dailymotion.com"===location.host){var k=location.hash.match(d)||location.href.match(b),l=k&&k[1];if(l&&-1===i.indexOf(l))if(a)a.ids.push(l);else{var m=f.makePlayer(null,[l],g);h.push(m)}}return a&&(this._ids!==a.ids&&(a.ids=$.unique(a.ids.concat(this._ids))),this._ids=a.ids),h},!0)}();var Aa;!function(){const a=q({nocache:!0,parse:function(a){return va.getMoviesById(a)}}),b=q({request:{method:"GET"},parse:ta.parsePlaylist});Aa=r("vietgiaitri",function(){var c=this,d=[],e=location.href.match(/vietgiaitri\.com\/.*id\.([^\.]+)\.vgt/i),f=(e||[])[1];return f&&d.push(this.makePlayer(null,[f],a)),location.host.match(/vietgiaitri\.com/i)&&$.queryAll('embed[src*="vietgiaitri.com"]').forEach(function(a){var e=ta.extract(a);e&&d.push(c.makePlayer(a,[e],b))}),d})}();var Ba;!function(){function a(a){try{var e;switch(a.tagName){case"IFRAME":e=a.src.match(b);break;case"PARAM":e=a.getAttribute("value").match(d)}return(e||[])[1]}catch(f){return c}}const b=/https?:\/\/clip\.vn\/embed\/([0-9a-z_-]+)/i,d=/(?:^|&)id=([0-9a-z_-]+)/i,e=q({request:{method:"POST",url:function(a){return"http://clip.vn/movies/nfo/"+a},params:function(){return{referrer:encodeURIComponent(btoa(location.href)),onsite:"clip"}},headers:function(){return{"X-REFERRER":location.href,"Content-type":"application/x-www-form-urlencoded"}}},parse:function(a,b){var c=$.xmlParser.parseFromString(b,"text/xml"),d=c.querySelector("ClipInfo title"),e=$.queryAll("ClipInfo enclosure",c).map(function(a){var b=a.getAttribute("url"),c=Z.parse(b),e=a.getAttribute("quality");return c.type="video",d&&(c.title=d.textContent),c.quality=quality.getClipvnQuality(e),c});return e}});Ba=r("clipvn",function(){var b=this,c=[],d=[],f=$.queryAll('param[name="flashvars"][value*="clip.vn"], iframe[src*="clip.vn"]');return f.forEach(function(f){var g=a(f);g&&-1===d.indexOf(g)&&(d.push(g),c.push(b.makePlayer(f,[g],e)))}),c})}();var Ca;!function(){function a(a){try{return X.AES.decrypt({ciphertext:X.enc.Hex.parse(a),salt:""},X.enc.Utf8.parse(g),{iv:X.enc.Utf8.parse(h),mode:X.mode.CBC,padding:X.pad.NoPadding}).toString(X.enc.Utf8)}catch(b){return""}}function b(a){var b=$.queryAll("script"),c=[];return b.forEach(function(b){var d=b.textContent.match(/<source\s+src="([^"]+)"\s+type="([^"]+)"/i);if(d){var e=Z.parse(d[1]);e=$.detectMediaTypeAndExt(e,d[2]),e.title=a,c.push(e)}}),c}function c(a){return-1===a.indexOf("load-song")}const e='param[value*=".zing.vn/xml/"], param[value*="tv.zing.vn/tv/xml/"], embed#player',f=/xmlURL=([^&]+)/i,g="f_pk_ZingTV_1_@z",h="f_iv_ZingTV_1_@z",i=/^https?:\/\//i,j=["f1080","f720","hq","f480","f360","source","f240","f"],k=q({request:{method:"GET"},parse:function(c,e){var f=$.xmlParser.parseFromString(e,"text/xml"),g=[];return $.queryAll("data > item",f).forEach(function(c){var e=c.getAttribute("type"),f=[c.querySelector("title").textContent],h=c.querySelector("performer");h&&""!==h.textContent.trim()&&f.unshift(h.textContent.trim()),f=f.join(" – "),$.toArray(c.childNodes).forEach(function(b){if(-1!==j.indexOf(b.tagName)){var c=b.textContent;if($.isMatches(c,i)||(c=a(c)),"require vip"!==c&&""!==c&&-1===c.indexOf("/rplaylist")&&$.isMatches(c,i)){var h=Z.parse(c);(Y.M3U8||!d(h.ext))&&("mp3"===e?(h.type="audio",h.quality=quality.getZingAudioQuality(b.tagName)):(h.type="video",h.quality=quality.getZingVideoQuality(b.tagName)),h.ext=h.ext||e,h.title=f,g.push(h))}}}),g.length||(g=b(f))}),g}});var l=/^([\d\w_-]+\.)*zing\.vn$/,m=function(a){var b=a.mp3;if(!b)return null;var c=Z.parse(b);c.type="audio";var d=a.artist?a.artist+" - ":"";return c.title=d+(a.title||"").trim(),c.force=!0,c.ext="mp3",c};Ca=r("zingvn",function(){var a=this,b=[],d=[],g=$.queryAll(e);if(g.forEach(function(e){var g=e.getAttribute("value")||e.getAttribute("flashvars"),h=(g.match(f)||[])[1];h&&c(h)&&-1===d.indexOf(h)&&(d.push(h),b.push(a.makePlayer(e,[h],k)))}),b.push(a.makePlayer(null,this._ids,k)),ia&&location.host.match(l)){var h=new ba;ia.send({method:"report",args:[["zmp3HTML5","playlist"]]}).success(function(a){return Array.isArray(a)?(a=a.map(m).filter(function(a){return a}),void h.resolve(a)):void h.resolve([])}),b.push(a.makePlayer0(null,[h]))}return b},!0)}();var Da;!function(){function a(){if("www.nhaccuatui.com"!==location.hostname)return null;var a=$.queryAll('object[type="application/x-shockwave-flash"]');if(1!==a.length)return null;var b=a[0];return b.getAttribute("data").match(/flash\/player\.nct/)?b:o(b)}const b='meta[content*="flash/xml?key"]',c=/https?:\/\/[^\?]+xml\?key.*/,d=q({request:{method:"GET"},parse:ta.parsePlaylist});var e=/^([\w\d_-]+\.)*nhaccuatui.com$/,f=function(a){var b=a.location.replace(/^[\n\s]*|[\n\s]*$/gm,"");if(!b)return null;var c=Z.parse(b);return c.type="audio",c.title=a.title.replace(/^[\n\s]*|[\n\s]*$/gm,""),c.force=!0,c.ext="mp3",c};Da=r("nhaccuatui",function(){var g=this,h=[],i=[];if($.queryAll(b).forEach(function(a){var b=a.getAttribute("content")||"",d=b.match(c),e=d&&d[0];e&&-1===i.indexOf(e)&&i.push(e)}),i.length&&h.push(this.makePlayer(null,i,d)),ia&&location.host.match(e)){var j=new ba;ia.send({method:"report",args:[["__data","flashPlayer","mp3"]]}).success(function(a){return Array.isArray(a)?(a=a.map(f).filter(function(a){return a}),void j.resolve(a)):void j.resolve([])}),h.push(g.makePlayer0(null,[j]))}return h.push(this.makePlayer0(a(),this._ids,d)),h},!0)}();var Ea;!function(){function a(a){var b={};return a.split("&").forEach(function(a){var c=a.split("=");b[c[0]]=decodeURIComponent(c[1])}),b}function b(a){return a.replace(/&#(\d+);/g,function(a,b){return String.fromCharCode(+b)})}const c="http://nhac.vui.vn",d='param[name="flashvars"][value*="vui.vn"]',e="http://nhac.vui.vn/asx2.php?type={{type}}&id={{id}}",f=/playlistfile=([^?&]+)/i,g=/(a|m|clip)(\d+)[^-]+$/i,h={a:3,m:1,clip:1},i=q({request:{method:"GET",url:function(a){return a.match(/^https?:\/\//i)?a:c+a}},parse:function(a,c){var d=$.xmlParser.parseFromString(c,"text/xml"),e=[];return $.queryAll("item",d).forEach(function(a){try{var c=[b(a.querySelector("title").textContent)],d=a.querySelector("description");d&&(d=d.textContent.replace(/thể hiện:/i,"").trim(),""!==d&&c.unshift(d));var f=a.getElementsByTagNameNS("http://developer.longtailvideo.com/","file")[0].textContent;if(!f.match(/^https?:\/\//i))return;var g=Z.parse(f);g.type="mp3"===g.ext?"audio":"video",g.title=c.join(" – "),e.push(g)}catch(h){}}),e}});Ea=r("vui",function(){var b=this,c=Z.parse(location.href);if(c.host.match(/vui\.vn$/))if("html"===c.ext){var j=c.filename.match(g);if(j&&j[1]&&j[2]){for(var k=j[2],l=null,m=$.queryAll('param[name="flashvars"]'),n=m.length-1;n>=0;n--){var o=m[n];if(o.value&&-1!==o.value.indexOf(k)){l=o;break}}var c=e.replace("{{type}}",h[j[1]]).replace("{{id}}",k);return[b.makePlayer(l,[c],i)]}}else if("swf"===c.ext){var j=c.search.match(f);if(j&&j[1]){var c=decodeURIComponent(j[1]);return[b.makePlayer(null,[c],i)]}}var p=[],q=$.queryAll(d);return q.forEach(function(c){var d=a(c.value);d&&d.playlistfile&&p.push(b.makePlayer(c,[d.playlistfile],i))}),p})}();var Fa;!function(){function a(a){var b,c,d=/^https?:\/\/nhacso.net\/embed\/([^\/]+)\/(.+)/i;if(a.src){if(c=a.src.match(d),3!==c.length)return null;switch(c[1]){case"album":b=h+c[2];break;case"video":b=g+c[2];break;default:return null}}else b=a.value.replace(/^.*xmlPath=([^&]+).*$/i,"$1");return b}function b(a,b){var c=l[b];return c&&a?location.origin+c+encodeURIComponent(a):void 0}function c(a){var c=a.getAttribute("object-id"),d=a.getAttribute("object-type");return c?b(c,d):null}function d(){if(!location.host.match(i))return!1;var a=location.pathname;return 0===a.indexOf("/xem-video/")||0===a.indexOf("/nghe-playlist/")||0===a.indexOf("/nghe-album/")||0===a.indexOf("/nghe-nhac/")}const e=['param[name="flashvars"][value*="xmlPath=http://nhacso.net"]','iframe[src*="http://nhacso.net/embed"]','param[name="movie"][value*="xmlPath=http://nhacso.net"]'].join(","),f="a.play[object-type]",g="http://nhacso.net/flash/video2/xnl/1/id/",h="http://nhacso.net/flash/album/xnl/1/uid/X1xQVUNcZgQEBQ==,",i=/(\w+\.)?nhacso\.net$/,j=q({request:{method:"GET"},parse:function(a,b){var c=$.xmlParser.parseFromString(b,"text/xml"),d=[];return $.queryAll("track, song",c).forEach(function(a){try{var b=[a.querySelector("name, title").textContent],c=a.querySelector("artist");c&&""!==c.textContent.trim()&&b.unshift(c.textContent.trim());var e=a.querySelector("sourceUrl, url, mp3link").textContent,f=Z.parse(e);f.type="mp3"===f.ext?"audio":"video",f.title=b.join(" – "),d.push(f)}catch(g){}}),d}}),k=q({nocache:!0,request:{method:"GET"},parse:function(a,b){var c=JSON.parse(b),d=(c.object_name||"").trim();d&&(d+=" - ");for(var e=c.songs||[],f=e.filter(function(a){return a.link_mp3}).map(function(a){}),g=0;g<e.length;g++){var h=e[g],i=h.link_mp3;if(i){var j=Z.parse(i);j.type="audio",j.title=d+(h.name||"").trim(),f.push(j)}}return f}});var l={album:"/albums/ajax-get-detail-album?dataId=",playlist:"/playlists/ajax-get-detail-playlist?dataId=",song:"/songs/ajax-get-detail-song?dataId="},m=function(a){var b=a.url;if(!b)return null;var c=Z.parse(b);c.type="audio";var d=a.singer[0]?a.singer[0].alias+" - ":"";return c.title=d+(a.name||"").trim(),c};Fa=r("nhacso",function(){var b=this,g=[],h=[];if($.queryAll(e).forEach(function(c){var d=a(c);d&&-1===h.indexOf(d)&&(h.push(d),g.push(b.makePlayer(c,[d],j)))}),ia&&location.host.match(i)){var l=new ba;ia.send({method:"report",args:[["myPeakPlayer","songs"]]}).success(function(a){return Array.isArray(a)?(a=a.map(m).filter(function(a){return a}),void l.resolve(a)):void l.resolve([])}),g.push(b.makePlayer0(null,[l]))}if(!d())return g;var n=[];return $.queryAll(f).forEach(function(a){var b=c(a);b&&-1===n.indexOf(b)&&n.push(b)}),n.length>0&&g.push(b.makePlayer(null,n,k)),$.queryAll(".video-details").forEach(function(a){var c=$.query("video",a),d=c&&c.src;if(d){var e=Z.parse(d);e.type="video";var f=$.query(".singer-link",a);f=f&&f.textContent.trim()||"";var h=$.query("h3.name");h=h&&h.textContent.trim()||"",f&&h&&(h=f+" - "+h),h&&(e.title=h),g.push(b.makePlayer(c,[e]))}}),g})}();var Ga=function(){this._providers=[new sa,new va,new xa,new ya,new Ca,new Da,new Aa,new Ba,new Ea,new Fa,new za]};!function(){function a(a,b){Array.prototype.push.apply(a,b)}function b(a){var b=new ba;return ba.when(a).done(function(){var a=w(),c=[];Array.prototype.concat.apply([],arguments).forEach(function(b){b&&(fa.isValidData(b)||b.force)&&(b.referrer=b.referrer||location.href,!b.title&&a&&a.test(b)&&(b.title=a.title),c.push(b))}),b.resolve(c)}),b}Ga.prototype={constructor:Ga,processRequest:function(a){for(var b=a.name,c=0;c<this._providers.length;++c){var d=this._providers[c];if(d.name===b&&d.processRequest){d.processRequest(a.result);break}}},getMedia:function(){var c=this._players;if(!c){var d=new ba;return d.reject([]),d}var e=[];return c.forEach(function(b){a(e,b.getMedia())}),b(e)},getMediaForPlayer:function(a){return b(a.getMedia())},getMediaPlayers:function(){var b=[];return this._providers.forEach(function(c){a(b,c.getMediaPlayers())}),this._players=b,b}}}();var Ha=[t({hosts:["ustream.tv"]},/^ustream.tv\/recorded\/([0-9]+)/i,"#ViewerContent h2"),t({hosts:["yan.vn"]},/^yan\.vn/i,'title, [role="complementary"] h3'),t({hosts:["vcdn.vn",".googlevideo.com","docs.google.com"]},/^phim22\.com/i,"title"),t({hosts:["olivia24.com"]},/^olivia24\.com/,"h1.visible-lg.visible-md"),t({},/vipphim\.net/,"title"),t({},/kenh14\.vn/,"h1.title"),t({},/vtv\.vn/,"h1.news-title,h1.video-title"),t({},/dantri\.com\.vn/,"#video-title"),t({hosts:[".memeclip.com"]},/nguoiduatin\.vn/,"title"),u(/^phim3s.net\/phim/i,"h2.title a",".serverlist .server li a.active"),u(/^thegioiphim\.eu\/movie-episode-full\.php/i,".category-main"),u(/^hayghe\.com\/xem-phim/i,"#tit_player"),u(/^phim14\.net\/xem-phim/i,".blocktitle h1 a",".server_item .active a"),u(/^phimnhanh\.net\/movie/i,"h1 > a",".epicurrent"),u(/^xemnghe\.com\/phim/i,"h1"),u(/^phimhd\.vn\/xem-phim/i,"h1.title","a.playing"),v(/^phimmoi\.net\/phim/i,".episode .active"),v(/^phimtv\.vn\/xem-phim/i,"a.playing"),t({hosts:["203.162.121.25:88","110.164.180.35","130.211.247.87"]},/^m-viet\.com/i,"h1"),t({hosts:["memeclip.com"]},/^meme\.vn/i,"h1"),t({hosts:["memeclip.com"]},/^doisongphapluat\.com/,"title"),v(/phim/i)],Ia=/^((xem )?phim)|(video:)/i,Ja=/(-? picasaweb( \d+)?)|(\| server .*)?$/i,Ka=/^https?:\/\/(www\.)?/i;x.prototype={processRequest:function(a,b){var c=this;switch(a){case"created":c._onCreated(b);break;case"erased":console.log("erased download:",b),delete c._data[b];break;case"changed":c._onChange(b)}},_sendMessage:function(a,b,c){chrome.runtime.sendMessage({requestType:"downloads",method:a,params:b},c)},_onCreated:function(a){var b=this;if(a){var c=a.item.id;b._data[c]=a,b._media2id[a.mid]=c}},_onChange:function(a){var b=this,c=b._data[a.id];if(c){var d=c.item;for(var e in a)"id"!==e&&(d[e]=a[e].current);$.call(b._callbacks,b,c.mid,d,a)}},onChange:function(a,b){console.assert(-1===a),this._callbacks.push(b)},download:function(a,b){console.assert(-1===a);var c=this,d=b.id,e=new ba;return this._sendMessage("download",b,function(a){var b=a.data;a.success?(c._data[b.id]={item:b,mid:d},c._media2id[d]=b.id,e.resolve(b)):e.reject(b)}),e},item:function(a,b){console.assert(-1===a);var c=this,d=c._media2id[b],e=c._data[d];return e&&e.item},pause:function(a){this._sendMessage("pause",a)},resume:function(a){this._sendMessage("resume",a)},cancel:function(a){this._sendMessage("cancel",a)},open:function(a){this._sendMessage("open",a)},show:function(a){this._sendMessage("show",a)}};var La=new x,Ma=function(){};Ma.prototype={constructor:Ma,_sendMessage:function(a,b,c){chrome.runtime.sendMessage({requestType:"cache",method:a,params:b},c)},get:function(a){var b=new ba;return this._sendMessage("get",{key:a},function(a){b[a.success?"resolve":"reject"](a.data)}),b},put:function(a,b,c){this._sendMessage("put",{key:a,value:b,ttl:c})},"delete":function(a){this._sendMessage("delete",{key:a})},proxy:function(a,b,c,d){var e=this,f=new ba;return this.get(b+d).success(f.resolve.bind(f)).fail(function(){var g=new ba(c.call(a,d));g.success(function(a){e.put(b+d,a)}).done(function(a){f.resolve(a)})}),f}};var Na=!$.IS_CONTENT_SCRIPT;z.prototype={setDownloads:function(a){this._downloads=a},render:function(b,c,d){c.downloads=this._downloads.group(),Na&&(c.is_only=this._downloads.isOneMedia());var e=$.query("#downloads",this._widget);e.innerHTML=Mustache.render(b,c,{media_template:a.options.get("template-media")}),e.classList.add("content");var f=this.applyCurrentValues(d);if(Na){var g=$.query(".downloads-list",this._widget);g.scrollHeight>g.offsetHeight&&(y($.queryAll("h1",this._widget),g),g.addEventListener("scroll",this._getSizeOfVisibleMedia.bind(this),!1),$.query("#close-popup",this._widget).classList.add("pulled")),this._widget.classList.add("done")}return f},_checkFileSize:function(a){var b=this._downloads.getMedia(a);b&&!b.get("size")&&(metrics.log("Download",metrics.DOWNLOAD_REQUEST_SIZE),b.getSize().done(function(a){var c=$.query("#size_"+b.id(),this._widget);c&&(c.classList.add("done"),c.textContent=b.size(),a||metrics.log("Download",metrics.DOWNLOAD_REQUEST_SIZE_FAILED))}.bind(this)))},_applyCurrentValues:function(a){var b=a.querySelector(".j-quality-selector"),c=b.value;$.queryAll(".j-quality-option, .j-quality-download",a).forEach(function(a){a.hidden=a.dataset.quality!==c,Na||a.hidden||!a.classList.contains("j-quality-download")||this._checkFileSize(a.dataset.id)},this),Na&&this._getSizeOfVisibleMedia()},applyCurrentValues:function(a){var b=this._downloads,c=options.get("prefer_last_quality")&&options.get("preferred_quality:"+a),d=$.queryAll(".j-media-scope",this._widget);return d.forEach(function(d){var e=$.queryAll(".j-quality-download",d);if(e.length>1){var f=e.map(function(a){return a.dataset.id}),g=quality.chooseBestDownload(b.getMediaGroup(f),a,c),h=$.query(".j-quality-selector",d);h&&(h.value=g.extQuality())}this._applyCurrentValues(d)},this),d},_getSizeOfVisibleMedia:function(){for(var a=$.query(".downloads-list",this._widget),b=a.scrollTop,c=a.offsetHeight,d=$.queryAll(".j-quality-download:not([hidden])",a),e=0,f=d.length;f>e;++e){var g=d[e];if(g.offsetTop>b+c+10)break;this._checkFileSize(g.dataset.id)}},download:function(a){return a.classList.contains("j-disabled")?void 0:(a.classList.add("j-disabled"),a.classList.add("btn-progress"),this._downloads.download(a.dataset.id).success(function(){a.classList.remove("btn-progress"),a.classList.add("btn-started")}).fail(function(b){a.classList.remove("btn-progress"),a.classList.remove("j-disabled"),console.warn("failed to download :(",a.dataset.id,b)}))}};var Oa=function(){this._widget=A("div","downloads"),this._widget.innerHTML=Mustache.render(a.options.get("template-widget"),{i18n_download:_("popup_download")}),this._userInitiated=!1,this._ready=!1,this._make_action=c,this._dl=new z(this._widget),this._dl.setDownloads(new ga),this._init()};Oa.prototype={constructor:Oa,_init:function(){this._setPreferredQuality(options.get("preferred_quality_level")),this._widget.addEventListener("click",this._onWidgetClick.bind(this),!1),this._widget.addEventListener("change",this._onSelectChange.bind(this),!1)},attach:function(a){var b=a.firstChild;b?b!==this._widget&&a.replaceChild(this._widget,b):a.appendChild(this._widget),this._updateDownloads()},_setPreferredQuality:function(a){if(a=a||quality.DEFAULT_QUALITY_LEVEL,!this._userInitiated&&this._preferredQuality!==a){this._preferredQuality=a;var b=$.query("#preferred-select",this._widget);b&&(b.value=a,b.innerText=_("popup_preferred_quality_hint")+" "+_("ql_"+a.toLowerCase()))}},_updateDownloads:function(){if(!this._player||!this._userInitiated)return void this._setPreferredQuality(options.get("preferred_quality_level"));var a=this._dl._downloads.setMediaData(this._manager.getMediaForPlayer(this._player));this._player=null,this._manager=null,a.done(this._showDownloads.bind(this))},_showDownloads:function(a,b){if(b){var c=this._widget,d=a.getMediaCount(),e=$.query("#showhide-all",c);if(0===d)return c.className="downloads-empty",e.textContent=e.title=_("popup_no_media_found"),void metrics.log("PageShown",metrics.PAGE_CONTENT_NO_MEDIA);c.className=d>1?"downloads-multi":"downloads-single main",e.textContent=_("popup_how_many_media_found",[d]),B(this)}},_onClick:function(a){var b=this,c=a.target;switch(c.id){case"download-main":case"preferred-select":if(!b._userInitiated){c.setAttribute("disabled",!0);var d="preferred-select"===c.id;b._make_action=d?"select":"download",b._userInitiated=!0,metrics.log("ButtonClicked",d?metrics.BUTTON_FAKE_QUALITY:metrics.BUTTON_MAIN),b._updateDownloads()}return;case"showhide-all":var e=$.query("#downloads",b._widget);if(e){var f=!e.hidden;e.hidden=f,metrics.log("ButtonClicked",f?metrics.BUTTON_HIDE_DOWNLOADS:metrics.BUTTON_SHOW_DOWNLOADS)}return;case"download-selected":return metrics.log("ButtonClicked",metrics.BUTTON_DOWNLOAD_ALL),$.queryAll(".j-media-scope.selected",b._widget).forEach(function(a){b._download($.query(".j-quality-download:not([hidden])",a))&&metrics.log("Download",metrics.DOWNLOAD_ALL)}),void b._updateDownloadSelected();case"check-all":return metrics.log("ButtonClicked",metrics.BUTTON_CHECK_ALL),void b._toggleSelectMedia($.queryAll(".j-media-scope",b._widget),!0);case"check-none":return metrics.log("ButtonClicked",metrics.BUTTON_CHECK_NONE),void b._toggleSelectMedia($.queryAll(".j-media-scope",b._widget),!1)}switch(c.tagName){case"LI":if(c.classList.contains("j-media-scope")){var g=!c.classList.contains("selected");return void b._toggleSelectMedia(c,g)}break;case"SPAN":var h=c.parentNode;return h.classList.contains("j-quality-download")?void(b._download(h)&&(metrics.log("Download",metrics.DOWNLOAD_BUTTON),b._updateDownloadSelected())):!0;case"SELECT":return;case"INPUT":if("checkbox"===c.type){var i=$.findParent(c,"j-media-scope");return i&&b._toggleSelectMedia(i,c.checked),!0}}return!0},_onSelectChange:function(a){var b=a.target;if("SELECT"===b.tagName){if("quality-level-selection"===b.id);else{var c=b.value.trim(),d=c.split("/")[1];
if(options.get("prefer_last_quality")&&1===$.queryAll(".j-media-scope",this._widget).length){var e=quality.getQualityLevelByQualityType(d);options.set("preferred_quality_level",e),options.set("preferred_quality:"+e,c)}var f=$.findParent(b,"j-media-scope");this._dl._applyCurrentValues(f),metrics.log("VideoQualityChanged",quality.getVideoQualityIndex(d)),this._updateDownloadSelected()}return!1}},_onWidgetClick:function(a){return this._onClick(a)?void 0:(a.preventDefault(),a.stopPropagation(),!0)},_toggleSelectMedia:function(a,b){function c(a){a.classList.toggle("selected",b),$.query('.filename [type="checkbox"]',a).checked=b}Array.isArray(a)?a.forEach(c):c(a),this._updateDownloadSelected()},_updateDownloadSelected:function(){var a=!0;$.queryAll(".j-media-scope.selected",this._widget).some(function(b){return $.query(".j-quality-download:not([hidden]):not(.j-disabled)",b)?(a=!1,!0):void 0}),$.query("#download-selected",this._widget).classList.toggle("disabled",a)},_download:function(a){return!!this._dl.download(a)},setMediaData:function(a,b){this._manager=a,this._player=b,this._ready=b.ids.length>0,this._updateDownloads()},isReady:function(){return this._ready}};var Pa,Qa=3e3,Ra=null,Sa=null,Ta=null;R()}(window,document);