!function(a,b,c){function d(a){return-1!==["m3u8","m3u"].indexOf(a)}function e(a){var b=a.url,c=a.quality,d=!!a.soundOnly;a="object"==typeof b?b.videoUrl+"\n"+b.audioUrl:b+(d?"mp3_"+c:"");var e=W.hash(a);return e.toString()}function f(a,b){var d=b[0],e={};if(!d){if(a.length>1)for(var g=0;g<a.length;++g){var h=a[g],i=h.url();if("object"==typeof i&&(i=i.videoUrl),-1!==i.indexOf(".googlevideo.com"))return[h]}return[a[0]]}return a.forEach(function(a){var b=a[d]&&a[d]()||"";e[b]=e[b]||[],e[b].push(a)}),Object.keys(e).map(function(a){var g=f(e[a],b.slice(1)),h={media:g};return h[d]=W.defined(a)?a:c,h.is_only=1===g.length&&(!W.defined(g[0].is_only)||g[0].is_only),h["i18n_"+d]=X("media_fields_"+d+"_"+a),g.length&&"function"==typeof g[0].soundOnly&&(h.soundOnly=g[0].soundOnly()),h})}function g(a){return a.forEach(function(a){var b=a.type;a.media.forEach(function(a){a.media=a.media.sort(function(a,c){return O[b].extensions.indexOf(a.ext)-O[b].extensions.indexOf(c.ext)})})}),a}function h(a){return a.ext?(a.media=a.media.sort(function(a,b){return quality.getQualityLevelByType(a.quality)-quality.getQualityLevelByType(b.quality)}),a):(Array.isArray(a)?a=a.map(h):a.media=h(a.media),a)}function i(a){return h(g(a))}function j(a){return function(b){return b[a]}}function k(a){var b=W.toArray(arguments);return b.shift(),function(c,d){return c[a].apply(c,b)}}function l(a){return a?S.check(a)?!1:!0:!1}function m(a){if(!l(a))return null;if(-1!==["PARAM","SOURCE"].indexOf(a.tagName)&&(a=a.parentElement),"OBJECT"===a.tagName){var b=a.querySelectorAll("embed");b&&1===b.length&&(a=b[0])}return a}function n(a){var b=a.parse,c=a.request;if(!c)return b;var d=c.url||function(a){return a},e=c.params||function(){},f=c.headers||function(){};return function(a){var g=d(a);if(!g)return b(a);var h=new Z;return W.send(c.method,g,e(a),f(a)).done(function(a){try{h.bind(b(g,a))}catch(c){h.reject()}}),h}}function o(a){return{nocache:!!a.nocache,getPlaylist:n(a)}}function p(a,b,c){function d(b,d,e,f){var g=c&&c.pip||null,h={name:a,node:b,ids:d,opts:f||{},scraper:e,getMedia:function(){var b=[],c=this.ids;if(!c.length)return b;var d=this.scraper;return d?(c.forEach(function(c){if(d.nocache)return void b.push(d.getPlaylist(c));var e=a+"_"+(c.url||c),f=new Z;cache.get(e).success(function(a){f.resolve(a)}).fail(function(){var a=new Z(d.getPlaylist(c));a.success(function(a){cache.put(e,a)}).done(function(a){f.resolve(a)})}),b.push(f)}),b):(b.push.apply(b,c),b)}};return g&&g.restore&&g.detach&&(h.restore=g.restore,h.detach=g.detach),h}var e=Boolean(c&&c.dynamic),f=e?function(){this._ids=[]}:function(){};return f.prototype={constructor:f,name:a,getMediaPlayers:b,makePlayer:function(a,b,c,e){return d(m(a),b,c,e)},makePlayer0:d},e&&(f.prototype.processRequest=function(a){a&&-1===this._ids.indexOf(a)&&this._ids.push(a)}),f}function q(a){return!!a&&W.endsWith(a,"adnetwork.vn")}function r(a,b,c,d){return{match:function(b){if(a.filename&&a.filename!==b.filename)return!1;var c=b.host;if(!c||b.title)return!1;if(!a.hosts)return!0;for(var d=a.hosts.length-1;d>=0;d--)if(W.endsWith(c,a.hosts[d]))return!0;return!1},location:Array.isArray(b)?b:[b],selector:c,auxSelector:d}}function s(a,b,c){return r({hosts:[".googlevideo.com","docs.google.com"],filename:"videoplayback"},a,b,c)}function t(a,b){return s(a,"title",b)}function u(){var a=location.href;if(!La.test(a))return null;a=a.replace(La,"");for(var b,c,d=0;d<Ia.length;++d)if(c=Ia[d],W.isMatches(a,c.location)){try{if(b=W.queryAll(c.selector).pop().textContent,"title"===c.selector&&(b=b.replace(Ja,"").replace(Ka,"")),c.auxSelector){var e=W.query(c.auxSelector).textContent.trim();e&&(b+=" ("+e+")")}b=b.replace(/\s+/g," ").trim()}catch(f){}if(b)return{title:b,test:c.match}}return a.match(/^fptplay\.net/i)?{title:null,test:function(a){var b=a.pathname.split("/"),c=b.length-1,d=b[c];return"chunklist.m3u8"===d&&c>0&&(d=b[c-1]),d&&(this.title=d),!0}}:null}function v(){var a=this;a._callbacks=[],a._data={},a._media2id={}}function w(a,c){function d(){for(var a=10,b=c.scrollTop,d=-1;f-1>d&&e[d+1].top<=b;)d++;return-1===d?!1:(g!==d&&(-1!==g&&(e[g].node.style.position="static",e[g].placeholder.hidden=!0),e[d].node.style.position="fixed",e[d].placeholder.hidden=!1,g=d),d!==f-1&&b+e[d].height>e[d+1].top?(e[d].node.style.top=a-(b+e[d].height-e[d+1].top)+"px",e[d].node.classList.contains("pulled")||e[d].node.classList.add("pulled")):(e[d].node.style.top=a+"px",e[d].node.classList.contains("pulled")&&e[d].node.classList.remove("pulled")),!1)}var e=[],f=a.length,g=-1;1>f||(c.style.position="relative",e=a.map(function(a){var c=b.createElement("div");return c.style.height=a.offsetHeight+"px",c.hidden=!0,a.parentNode.insertBefore(c,a),{node:a,top:a.offsetTop,height:a.offsetHeight,placeholder:c}}),c.addEventListener("scroll",d,!1))}function x(a){this._widget=a,this._downloads=null,location.protocol.includes("chrome")&&location.pathname.includes("popup.html")&&this.initPlayNowListener()}function y(a,c){var d=b.createElement(a);return c&&(d.className=c),d}function z(d){var e=d._dl.render(a.options.get("template-list"),{i18n_check_label:X("popup_check_label"),i18n_check_all:X("popup_check_all"),i18n_check_none:X("popup_check_none"),i18n_download_selected:X("popup_download_selected"),i18n_download:X("popup_download"),i18n_wait:X("popup_download_starting"),i18n_one_click:X("popup_one_click"),i18n_preferred_quality:X("popup_preferred_quality"),i18n_no_media_found:X("popup_no_media_found"),i18n_download_failed:X("popup_download_failed"),i18n_pip_button:X("popup_pip_button"),i18n_sound_only:X("popup_sound_only"),has_pip:S.check(a.location.hostname,"pip")},d._preferredQuality),f=1===e.length?e[0]:null;if(f)if("select"===d._make_action){var g=W.query(".j-quality-selector:not([hidden])",f);g&&setTimeout(function(){var c=b.createEvent("MouseEvents");c.initMouseEvent("mousedown",!0,!0,a),g.dispatchEvent(c)},4)}else if("download"===d._make_action){var h=W.query(".j-quality-download:not([hidden])",f);h&&d._download(h)&&(metrics.log("Download",metrics.DOWNLOAD_AUTO),d.serverLogDownload(h,{autoselect:1}),d._updateDownloadSelected())}d._make_action=c}function A(){this.overlayCtl=null,this.currentPlayer=null,this.tourState=options.get("pip_tour_state")||this.STATE.VIRGIN}function B(){this.node=null,this.isShown=!1}function C(a){return(a.createShadowRoot||a.webkitCreateShadowRoot).call(a)}function D(a,b){for(b=b.parentNode;b&&b!==a;)b=b.parentNode;return!!b}function E(a){a=a||{};var b=y("div"),c=C(b),d=y("style"),e="",f=a.styles||chrome.runtime.getManifest().web_accessible_resources||[];f.forEach(function(a){W.endsWith(a,".css")&&(e+='@import "'+chrome.extension.getURL(a)+'";\n')}),d.innerHTML=e,c.appendChild(d);var g=y("div","body");return c.appendChild(g),{element:b,shadowElement:g}}function F(a){function b(a){return-1!==["mouseenter","mouseover","touchstart","touchmove"].indexOf(a)}function c(c){var d=a.getTarget(c.target);return d?(f(d,b(c.type)),!0):void 0}function d(a){var b=g[a.type];b&&(null!==e&&(e=a),b(a)&&(a.preventDefault(),a.stopPropagation()))}var e,f=W.debounce(a.onFocus.bind(this),Ra,!1),g={mouseenter:c,mouseleave:c},h=Object.keys(g);return{emitLastEvent:function(){var a=e&&g[e.type];a&&a(e),e=null},attach:function(a){for(var b=h.length-1;b>=0;b--)a.addEventListener(h[b],d,!0)},detach:function(a){for(var b=h.length-1;b>=0;b--)a.removeEventListener(h[b],d,!0)}}}function G(a,c){for(;c&&c!==b;){var d=a.getComputedStyle(c);if(d&&"fixed"===d.getPropertyValue("position"))return"fixed";c=c.parentNode}return"absolute"}function H(a){try{if(a.matches("object, embed")){var b=a.parentNode&&a.parentNode.matches("object")?a.parentNode:a.querySelector("embed");b&&b.offsetHeight>a.offsetHeight&&(a=b)}var c=a.ownerDocument.defaultView,d=G(c,a),e=a.getBoundingClientRect(),f=e.top,g=e.left;"fixed"!==d&&(f+=c.pageYOffset,g+=c.pageXOffset),a.matches("video")&&a.controls&&a.offsetHeight<35&&(g+=5,f=f+a.offsetHeight-35);const h=W.dom.getOffset(a);return h.top<=Sa&&(f+=Sa),{position:d,top:f+"px",left:g+"px",height:e.height+"px",width:e.width+"px"}}catch(i){return null}}function I(c){function d(a){if(a){for(var b=a.parentNode;b;)a=b,b=a.parentNode;return a.activeElement}}function e(){i.hidden&&metrics.log("PageShown",metrics.PAGE_CONTENT_SHOW_CONTROLS),i.hidden=!1}function f(){setTimeout(function(){if(j.hide){var a=W.query(".downloads-multi #downloads",i);a&&(a.hidden=!0),i.hidden=!0}},Qa)}function g(){if(j.node){var a="",b=H(j.node);Object.keys(b).forEach(function(c){a+=c+":"+b[c]+";"}),i.setAttribute("style",a)}}function h(){W.isFullscreen()&&(j.hide=!0,f())}var i=y("div","base overlay");i.innerHTML="&nbsp;",i.hidden=!0;var j={hide:!0,node:null,forced:!1};a.addEventListener("resize",g),b.addEventListener("webkitfullscreenchange",h);var k=F({onFocus:function(b,c){if(!j.forced){var h;if(!c&&(h=d(i),h&&h.matches("select"))){if("o"===b)return;h.blur()}if(!c||!a.options.get("on_page_buttons"))return j.hide=!0,void f();if(j.hide=!1,"o"!==b){j.node=b.node;var k=b.widget;k&&k.isReady()&&(k.attach(i),g(),e())}}},getTarget:function(a){return a?a===i?"o":c.findEntry(a):a}});return k.attach(i),k.attach(b),{attach:function(a){a.appendChild(i),k.emitLastEvent()},destroy:function(){k.detach(b),k.detach(i),a.removeEventListener("resize",g),b.removeEventListener("webkitfullscreenchange",h)},forceShow:function(a){var b=c.findEntry(a);return b&&b.widget.isReady()?(j.hide=!1,j.node=a,j.forced=!0,b.widget.attach(i),g(),e(),b.widget):!1},cancelForced:function(){j.hide=!0,j.forced=!1,j.node=null,f()}}}function J(){this.reset(),this.nodeWithoutPlayer=null}function K(a){var b,c=new J,d=I(c),e=new A;const f=new B;return e.overlayCtl={forceShow:d.forceShow,cancelForced:d.cancelForced},{destroy:function(){d&&(d.destroy(),d=null),b&&(a.removeChild(b.element),b=null),c.reset()},setMediaPlayers:function(g,h){c.setMediaPlayers(g,h)&&!b&&(b=E(),a.appendChild(b.element),d.attach(b.shadowElement),e.attach(b.shadowElement),T.PLAY_NOW_BOTTOM_TOOLTIP&&(f.init(),f.attach(b.shadowElement))),e.processPlayers(g,h)},playNowBottomTooltip:T.PLAY_NOW_BOTTOM_TOOLTIP?f:null}}function L(){this._init()}var M=M||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},g=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var e=0;a>e;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-8*(e%4)&255)<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;a>e;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(4294967296*a.random()|0);return new g.init(c,b)}}),h=c.enc={},i=h.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++){var e=b[d>>>2]>>>24-8*(d%4)&255;c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-8*(d%4)&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-8*(d%4);return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=e/(4*f),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0);if(b=h*f,e=a.min(4*b,e),b){for(var i=0;b>i;i+=f)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return new g.init(i,e)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}});var m=c.algo={};return c}(Math);!function(){var a=M,b=a.lib.WordArray;a.enc.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp(),a=[];for(var e=0;c>e;e+=3)for(var f=(b[e>>>2]>>>24-8*(e%4)&255)<<16|(b[e+1>>>2]>>>24-8*((e+1)%4)&255)<<8|b[e+2>>>2]>>>24-8*((e+2)%4)&255,g=0;4>g&&c>e+.75*g;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(a){var c=a.length,d=this._map,e=d.charAt(64);e&&(e=a.indexOf(e),-1!=e&&(c=e));for(var e=[],f=0,g=0;c>g;g++)if(g%4){var h=d.indexOf(a.charAt(g-1))<<2*(g%4),i=d.indexOf(a.charAt(g))>>>6-2*(g%4);e[f>>>2]|=(h|i)<<24-8*(f%4),f++}return b.create(e,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(a){function b(a,b,c,d,e,f,g){return a=a+(b&c|~b&d)+e+g,(a<<f|a>>>32-f)+b}function c(a,b,c,d,e,f,g){return a=a+(b&d|c&~d)+e+g,(a<<f|a>>>32-f)+b}function d(a,b,c,d,e,f,g){return a=a+(b^c^d)+e+g,(a<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){return a=a+(c^(b|~d))+e+g,(a<<f|a>>>32-f)+b}for(var f=M,g=f.lib,h=g.WordArray,i=g.Hasher,g=f.algo,j=[],k=0;64>k;k++)j[k]=4294967296*a.abs(a.sin(k+1))|0;g=g.MD5=i.extend({_doReset:function(){this._hash=new h.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(a,f){for(var g=0;16>g;g++){var h=f+g,i=a[h];a[h]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var g=this._hash.words,h=a[f+0],i=a[f+1],k=a[f+2],l=a[f+3],m=a[f+4],n=a[f+5],o=a[f+6],p=a[f+7],q=a[f+8],r=a[f+9],s=a[f+10],t=a[f+11],u=a[f+12],v=a[f+13],w=a[f+14],x=a[f+15],y=g[0],z=g[1],A=g[2],B=g[3],y=b(y,z,A,B,h,7,j[0]),B=b(B,y,z,A,i,12,j[1]),A=b(A,B,y,z,k,17,j[2]),z=b(z,A,B,y,l,22,j[3]),y=b(y,z,A,B,m,7,j[4]),B=b(B,y,z,A,n,12,j[5]),A=b(A,B,y,z,o,17,j[6]),z=b(z,A,B,y,p,22,j[7]),y=b(y,z,A,B,q,7,j[8]),B=b(B,y,z,A,r,12,j[9]),A=b(A,B,y,z,s,17,j[10]),z=b(z,A,B,y,t,22,j[11]),y=b(y,z,A,B,u,7,j[12]),B=b(B,y,z,A,v,12,j[13]),A=b(A,B,y,z,w,17,j[14]),z=b(z,A,B,y,x,22,j[15]),y=c(y,z,A,B,i,5,j[16]),B=c(B,y,z,A,o,9,j[17]),A=c(A,B,y,z,t,14,j[18]),z=c(z,A,B,y,h,20,j[19]),y=c(y,z,A,B,n,5,j[20]),B=c(B,y,z,A,s,9,j[21]),A=c(A,B,y,z,x,14,j[22]),z=c(z,A,B,y,m,20,j[23]),y=c(y,z,A,B,r,5,j[24]),B=c(B,y,z,A,w,9,j[25]),A=c(A,B,y,z,l,14,j[26]),z=c(z,A,B,y,q,20,j[27]),y=c(y,z,A,B,v,5,j[28]),B=c(B,y,z,A,k,9,j[29]),A=c(A,B,y,z,p,14,j[30]),z=c(z,A,B,y,u,20,j[31]),y=d(y,z,A,B,n,4,j[32]),B=d(B,y,z,A,q,11,j[33]),A=d(A,B,y,z,t,16,j[34]),z=d(z,A,B,y,w,23,j[35]),y=d(y,z,A,B,i,4,j[36]),B=d(B,y,z,A,m,11,j[37]),A=d(A,B,y,z,p,16,j[38]),z=d(z,A,B,y,s,23,j[39]),y=d(y,z,A,B,v,4,j[40]),B=d(B,y,z,A,h,11,j[41]),A=d(A,B,y,z,l,16,j[42]),z=d(z,A,B,y,o,23,j[43]),y=d(y,z,A,B,r,4,j[44]),B=d(B,y,z,A,u,11,j[45]),A=d(A,B,y,z,x,16,j[46]),z=d(z,A,B,y,k,23,j[47]),y=e(y,z,A,B,h,6,j[48]),B=e(B,y,z,A,p,10,j[49]),A=e(A,B,y,z,w,15,j[50]),z=e(z,A,B,y,n,21,j[51]),y=e(y,z,A,B,u,6,j[52]),B=e(B,y,z,A,l,10,j[53]),A=e(A,B,y,z,s,15,j[54]),z=e(z,A,B,y,i,21,j[55]),y=e(y,z,A,B,q,6,j[56]),B=e(B,y,z,A,x,10,j[57]),A=e(A,B,y,z,o,15,j[58]),z=e(z,A,B,y,v,21,j[59]),y=e(y,z,A,B,m,6,j[60]),B=e(B,y,z,A,t,10,j[61]),A=e(A,B,y,z,k,15,j[62]),z=e(z,A,B,y,r,21,j[63]);g[0]=g[0]+y|0,g[1]=g[1]+z|0,g[2]=g[2]+A|0,g[3]=g[3]+B|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/4294967296);for(c[(e+64>>>9<<4)+15]=16711935&(f<<8|f>>>24)|4278255360&(f<<24|f>>>8),c[(e+64>>>9<<4)+14]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8),b.sigBytes=4*(c.length+1),this._process(),b=this._hash,c=b.words,d=0;4>d;d++)e=c[d],c[d]=16711935&(e<<8|e>>>24)|4278255360&(e<<24|e>>>8);return b},clone:function(){var a=i.clone.call(this);return a._hash=this._hash.clone(),a}}),f.MD5=i._createHelper(g),f.HmacMD5=i._createHmacHelper(g)}(Math),function(){var a=M,b=a.lib,c=b.Base,d=b.WordArray,b=a.algo,e=b.EvpKDF=c.extend({cfg:c.extend({keySize:4,hasher:b.MD5,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var c=this.cfg,e=c.hasher.create(),f=d.create(),g=f.words,h=c.keySize,c=c.iterations;g.length<h;){i&&e.update(i);var i=e.update(a).finalize(b);e.reset();for(var j=1;c>j;j++)i=e.finalize(i),e.reset();f.concat(i)}return f.sigBytes=4*h,f}});a.EvpKDF=function(a,b,c){return e.create(c).compute(a,b)}}(),M.lib.Cipher||function(a){var b=M,c=b.lib,d=c.Base,e=c.WordArray,f=c.BufferedBlockAlgorithm,g=b.enc.Base64,h=b.algo.EvpKDF,i=c.Cipher=f.extend({cfg:d.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){f.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){return a&&this._append(a),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(a){return{encrypt:function(b,c,d){return("string"==typeof c?o:n).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?o:n).decrypt(a,b,c,d)}}}});c.StreamCipher=i.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var j=b.mode={},k=function(b,c,d){var e=this._iv;e?this._iv=a:e=this._prevBlock;for(var f=0;d>f;f++)b[c+f]^=e[f]},l=(c.BlockCipherMode=d.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}})).extend();l.Encryptor=l.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize;k.call(this,a,b,d),c.encryptBlock(a,b),this._prevBlock=a.slice(b,b+d)}}),l.Decryptor=l.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=a.slice(b,b+d);c.decryptBlock(a,b),k.call(this,a,b,d),this._prevBlock=e}}),j=j.CBC=l,l=(b.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,d=c<<24|c<<16|c<<8|c,f=[],g=0;c>g;g+=4)f.push(d);c=e.create(f,c),a.concat(c)},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}},c.BlockCipher=i.extend({cfg:i.cfg.extend({mode:j,padding:l}),reset:function(){i.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var m=c.CipherParams=d.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),j=(b.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;return a=a.salt,(a?e.create([1398893684,1701076831]).concat(a).concat(b):b).toString(g)},parse:function(a){a=g.parse(a);var b=a.words;if(1398893684==b[0]&&1701076831==b[1]){var c=e.create(b.slice(2,4));b.splice(0,4),a.sigBytes-=16}return m.create({ciphertext:a,salt:c})}},n=c.SerializableCipher=d.extend({cfg:d.extend({format:j}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);return b=e.finalize(b),e=e.cfg,m.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),b=(b.kdf={}).OpenSSL={execute:function(a,b,c,d){return d||(d=e.random(8)),a=h.create({keySize:b+c}).compute(a,d),c=e.create(a.words.slice(b),4*c),a.sigBytes=4*b,m.create({key:a,iv:c,salt:d})}},o=c.PasswordBasedCipher=n.extend({cfg:n.cfg.extend({kdf:b}),encrypt:function(a,b,c,d){return d=this.cfg.extend(d),c=d.kdf.execute(c,a.keySize,a.ivSize),d.iv=c.iv,a=n.encrypt.call(this,a,b,c.key,d),a.mixIn(c),a},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt),d.iv=c.iv,n.decrypt.call(this,a,b,c.key,d)}})}(),function(){for(var a=M,b=a.lib.BlockCipher,c=a.algo,d=[],e=[],f=[],g=[],h=[],i=[],j=[],k=[],l=[],m=[],n=[],o=0;256>o;o++)n[o]=128>o?o<<1:o<<1^283;for(var p=0,q=0,o=0;256>o;o++){var r=q^q<<1^q<<2^q<<3^q<<4,r=r>>>8^255&r^99;d[p]=r,e[r]=p;var s=n[p],t=n[s],u=n[t],v=257*n[r]^16843008*r;f[p]=v<<24|v>>>8,g[p]=v<<16|v>>>16,h[p]=v<<8|v>>>24,i[p]=v,v=16843009*u^65537*t^257*s^16843008*p,j[r]=v<<24|v>>>8,k[r]=v<<16|v>>>16,l[r]=v<<8|v>>>24,m[r]=v,p?(p=s^n[n[n[u^s]]],q^=n[n[q]]):p=q=1}var w=[0,1,2,4,8,16,32,64,128,27,54],c=c.AES=b.extend({_doReset:function(){for(var a=this._key,b=a.words,c=a.sigBytes/4,a=4*((this._nRounds=c+6)+1),e=this._keySchedule=[],f=0;a>f;f++)if(c>f)e[f]=b[f];else{var g=e[f-1];f%c?c>6&&4==f%c&&(g=d[g>>>24]<<24|d[g>>>16&255]<<16|d[g>>>8&255]<<8|d[255&g]):(g=g<<8|g>>>24,g=d[g>>>24]<<24|d[g>>>16&255]<<16|d[g>>>8&255]<<8|d[255&g],g^=w[f/c|0]<<24),e[f]=e[f-c]^g}for(b=this._invKeySchedule=[],c=0;a>c;c++)f=a-c,g=c%4?e[f]:e[f-4],b[c]=4>c||4>=f?g:j[d[g>>>24]]^k[d[g>>>16&255]]^l[d[g>>>8&255]]^m[d[255&g]]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,f,g,h,i,d)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this._doCryptBlock(a,b,this._invKeySchedule,j,k,l,m,e),c=a[b+1],a[b+1]=a[b+3],a[b+3]=c},_doCryptBlock:function(a,b,c,d,e,f,g,h){for(var i=this._nRounds,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[2],m=a[b+3]^c[3],n=4,o=1;i>o;o++)var p=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],q=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],r=d[l>>>24]^e[m>>>16&255]^f[j>>>8&255]^g[255&k]^c[n++],m=d[m>>>24]^e[j>>>16&255]^f[k>>>8&255]^g[255&l]^c[n++],j=p,k=q,l=r;p=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],q=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],r=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],m=(h[m>>>24]<<24|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++],a[b]=p,a[b+1]=q,a[b+2]=r,a[b+3]=m},keySize:8});a.AES=b._createHelper(c)}(),M.pad.NoPadding={pad:function(){},unpad:function(){}};var N=function(){this.events={}};N.prototype.on=function(a,b){"object"!=typeof this.events[a]&&(this.events[a]=[]),this.events[a].push(b)},N.prototype.removeListener=function(a,b){var c;"object"==typeof this.events[a]&&(c=indexOf(this.events[a],b),c>-1&&this.events[a].splice(c,1))},N.prototype.emit=function(a){var b,c,d,e=[].slice.call(arguments,1);if("object"==typeof this.events[a])for(c=this.events[a].slice(),d=c.length,b=0;d>b;b++)c[b].apply(this,e)},N.prototype.once=function(a,b){this.on(a,function c(){this.removeListener(a,c),b.apply(this,arguments)})};const O={audio:{title:"Audio",rgxp:/audio/i,extensions:["mp3","flac","m4a","wma","ogg","wav","aif","mid","opus"],ctype2extension:{midi:"mid",mp4:"m4a",m4a:"m4a",mpeg:"mp3",mpeg3:"mp3",wav:"wav",aiff:"aif",opus:"opus"}},video:{title:"Video",rgxp:/video/i,extensions:["mp4","mpeg4","mp3","mpg","mpeg","m4v","avi","divx","mov","wmv","movie","asf","webm","flv","3gp","yt_srt"],ctype2extension:{mpeg:"mp4",mp4:"mp4",m4v:"mp4","3gpp":"3gp",flv:"flv",quicktime:"mov",msvideo:"avi","ms-wmv":"wmv","ms-asf":"asf"}}},P=function(){var a={};return Object.keys(O).forEach(function(b){for(var c=O[b].extensions,d=0;d<c.length;d++)a[c[d]]=b}),a}(),Q=[/^(.+\.)?youtube.com/i,/^(.+\.)?zing.vn/i,/^(.+\.)?nhaccuatui.com/i,/^(.+\.)?vimeo.com/i,/^(.+\.)?clip.vn/i,/vietgiaitri\.com/i,/^(.+\.)?soundcloud\.com/i,/^(.+\.)?kenh14\.vn/i,/^(.+\.)?xvideos\.com/i];var R=function(){this.extra={}};if(R.prototype={check:function(a,b){var c=b?this.extra[b]:this.rules;return this._testRules(a,c)},_testRules:function(a,b){Date.now();if(!b)return!1;var c;if("string"==typeof a?c=a:(a.src||a.href)&&(c=a.src||a.href),c){for(var d=b.wlUrls.length,e=0;d>e;e++)if(b.wlUrls[e].test(c))return!1;d=b.blUrls.length;for(var e=0;d>e;e++)if(b.blUrls[e].test(c))return!0}if(!(a instanceof Node))return!1;for(var f=a.ownerDocument.location.href,e=0;e<b.wlCosmetics.length;e++){var g=b.wlCosmetics[e];if(("~"===g.domain[0]&&f.match(g.domain.substr(1))||f.match(g.domain))&&g.selectors.some(a.matches.bind(a)))return!1}for(var e=0;e<b.blCosmetics.length;e++){var g=b.blCosmetics[e];if(("~"===g.domain[0]&&f.match(g.domain.substr(1))||f.match(g.domain))&&g.selectors.some(a.matches.bind(a)))return!0}return!1},convertWildcard:function(a){if(/^\/.*?\/$/.test(a)&&/[\[\\(){}]/.test(a))return new RegExp(a.replace(/^\/|\/$/g,""),"i");var b=a.replace(/[.?+\\\[{()]/g,function(a){return"\\"+a}).replace(/\^/g,"[\\w\\d_.%-]").replace(/\*/g,".*").replace(/\|\|/g,"^\\w+://([\\d\\w-]+\\.)*").replace(/\|/g,"$");return new RegExp(b,"i")},getParsingRegex:function(){if(this.regex)return this.regex;var a="^\\s*(@@)?(/(?:[^/]|\\\\/)+/|(?:[^#$]+|#(?!#))+)?(?:(#@#|##)([^$]+))?(?:\\$(.*))?\\s*$";return this.regex=new RegExp(a,"i"),this.regex},parseFilters:function(a){var b=a;"string"==typeof b&&(b=b.split(/[\r\n]+/));for(var c={blUrls:[],wlUrls:[],blCosmetics:[],wlCosmetics:[]},d={"":{bl:[],wl:[]}},e=0;e<b.length;e++){var f=b[e];if(!/^\s*!|^\s*\[.*?\]\s*$/.test(f)){var g=this.getParsingRegex().exec(f);if(g){var h={whitelist:g[1],url:g[2],separator:g[3],selector:g[4],comment:g[5]};if(h.separator)for(var i=h.url?h.url.split(/,/):[""],j=0;j<i.length;j++){var k=i[j];k in d||(d[k]={bl:[],wl:[]}),k=d[k],"#@#"===h.separator?(h.whiteList||d[""].wl.push(h.selector),k[h.whitelist?"bl":"wl"].push(h.selector)):k[h.whitelist?"wl":"bl"].push(h.selector)}else{if(!h.url)continue;var l="@@"===h.whitelist?c.wlUrls:c.blUrls,m=this.convertWildcard(h.url);l.push(m)}}}}for(var n=Object.keys(d),e=0;e<n.length;e++){var o=n[e],k=d[o];k.bl.length&&c.blCosmetics.push({domain:this.convertWildcard(o),selectors:d[o].bl}),k.wl.length&&c.wlCosmetics.push({domain:this.convertWildcard(o),selectors:d[o].wl})}return c},loadRules:function(a,b){var c=this.parseFilters(a);b?this.extra[b]=c:this.rules=c}},"undefined"!=typeof module)module.exports=R;else var S=new R;S.loadRules(["/pre-roll/","/preroll/","/ads/","||histats.com/","||adnetwork.vn/","||doubleclick.net/","||admicro/","||adnet.vn/","||ds-vn.serving-sys.com/","||lavanetwork.net/","||video.sgame.vn:8080/","||cdn.blueseed/","||vcmedia.vn/","||innity.net/","||serving-sys.com/","||ambientplatform.vn/","||gvt1.com/","||comment.dantri.com.vn/","||adsquangcao.com/","||facebook.com/connect","||facebook.com/plugins/likebox.php","||facebook.com/plugins/comments.php","||facebook.com/connect/xd_arbiter","||facebook.com/plugins/page.php","||facebook.com/v*/plugins/*","||googlesyndication.com","||qccoccocmedia.vn/","||coccoc.com/webhp##*","||meme.vn/##*","||ads.phimnhanh.net/","||adsquangcao.com/","||edgecastcdn.net/","||qccoccocmedia.vn/","||dev-qccoccocmedia.vn/","||media.adnetwork.vn/","@@||vhosting.vcmedia.vn/","@@||vcplayer.vcmedia.vn/","@@||vscc.hosting.vcmedia.vn/","@@||vscc.dantri.hosting.vcmedia.vn/","@@||vscc-kenh14-hosting.vcmedia.vn/","@@||hls.vcmedia.vn/","##.adsbygoogle iframe","###adcontainer *","##.ad-container *",'##.facebook-top *, .fb-like-box *, iframe[title^="fb:like_box"]','##iframe[title^="fb:page"]','##[id^="AbdVideoPreroll"]','##[data^="player-ads"]','##[id^="google_ads_iframe_"]',"###pyv-iframe","##.box-ads *","##.ads *","##.video-ads *",'##iframe[onload*="google_iframe_oncopy"]','||youtube.com##[id*="sidebar-ads"] *',"||bit.ly/",'##[name*="zeroclipboard"],[data*="zeroclipboard"]',"||xemphimso.com/##.right-menu *","###AbdPopupAd_left iframe",'||phim.hayhd.vn/###adsdiv iframe,div[class*="ads"] iframe',"||nhaccuatui.com/##.box_right *,#banner-container-bottom *","||adxpansion.com/","||porn99.net##.content-right *","||thuvienanh.org/","||xemvtv.net/###ads-slider *",'||yeucahat.com/##div[id^="adscont"] *',"||sexad.net/","||ads.sex.com/",'||redtube.com/##div[id^="as_"] *','##object[id^="abdPopup"]',"||adnetwork.vn/",'##object[data*=".adnetwork.vn/"]',"||phim3s.net/##.ad_location *","||xhamster.com/###plAds *,.adVideo *,#adBottom *","||exoclick.com/","||trafficstars.com/","||traffichaus.com/","||trafficjunky.net/","||vivo.vn##.content-right-sidebar *",'||dailymotion.com##div[id^="mc_"] *',"||pornhub.com/###pb_block *,.right-ads *",'||xemphimso.com/##[id^="ebAd"],#eyeDiv *','||vivo.vn/##div[class*="ads"] *',"||phim.hayhd.vn/###block-resize-sidebar *","||phim.hayhd.vn/##.container .col-sm-8+.col-sm-4 *","||pornhub.com,tube8.com,youporn.com,redtube.com###pb_template *","||nhac.vui.vn/##.colRight *","||tube8.com/##.blockHtml *","||vkool.net/##.float-ck *,.col-left *,#sidebar *, #boxes *","||comment.vietid.net/comments","||dantri.com.vn/comment","||dantri.com.vn/##.fr.w510 *",'||vnexpress.net/##[id*="_BANNER_"] *, .block_banner *','||24h.com.vn/##[id*="ADS_"] *',"||ngoisao.net/###right *","||nhaccuatui.com/##.coverImage *","||phimsexporn.com/##.balloons-ck *","/twitter\\.com\\/.*cards\\/.*cardname=poll/","##.twitter-tweet.twitter-tweet-rendered",'##[id^="preroll"] *','##[class^="preroll"] *',"||adpoints.media","||media.yomedia.vn","goldendatagroup.*"]),S.loadRules(["||mail.google.com/","||docs.google.com/","||dropbox.com/","||meme.vn/"],"pip"),S.loadRules(["||fptplay.net/##.hls-playback embed","||pubvn.tv/bar/threads/##iframe#player","||www.24h.com.vn/###player_video_kieu_moi iframe",'||facebook.com/##iframe[src^="https://attachment.fbsbx.com/external_iframe.php"]'],"pip-allowfullscreen-false"),S.loadRules(["||mail.google.com/","||docs.google.com/","||drive.google.com/","||dropbox.com/","||fptplay.net/livetv","||twitch.tv","||talktv.vn","@@||talktv.vn/video/"],"download"),S.loadRules(["/fbcdn([^.]+\\.akamaihd)?\\.net/","/.*dailymotion.*\\/frag\\(\\d+\\)\\//","||youtube.com/","||vimeo.com/","||vimeocdn.com/","||clip.vn/","||subs.xemphimonlines.com/","||dailymotion.com/","||dmcdn.net/","||nhacrap.tv/","||nixcdn.com/","||zdn.vn/","||vui.vn/","/fptplay\\.net\\/.*?seg\\d*-frag\\d*/","/hlscache\\.fptplay\\.net(?:\\.vn)?\\//","/49ef4358-e34d-484f-a18e-495cd9fe3817","/75247339-7897-437d-9627-55b1a1528700"],"requests");var T=function(){function a(a,b){var c=a[0]-b[0];return 0!==c?c:(c=a[1]-b[1],0!==c?c:(c=a[2]-b[2],0!==c?c:c=a[3]-b[3]))}var b="",c={mp4:!0},d=0,e=0,f=0,g=0,h=navigator.userAgent.match(/Chrome\/([\d\.]+)/);return h&&h[1]&&(h=h[1].split("."),h=[+h[0],+h[1],+h[2],+h[3]],a(h,[39,0,2171,103])>=0&&(b+=" webm!",c.webm=!0),a(h,[39,0,2171,105])>=0&&(b+=" m3u8!",d=1),a(h,[55,4,2883,114])>=1&&(b+=" soundOnly!",e=1),a(h,[55,4,2883,114])>=1&&(b+=" Subtitles!",f=1),a(h,[55,4,2883,126])>=1&&(b+=" PlayNowBottomTooltip!",g=1)),{YT:c,M3U8:d,SOUND_ONLY:e,SUBTITLES:f,PLAY_NOW_BOTTOM_TOOLTIP:g}}(),U=function(){function a(a){return a&&0!==a.indexOf("data:image")?f.exec(a):[]}var c=b.createElement("a"),d=/([^\/]+)$/i,e=/\.([^\/.]*)$/i,f={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
}.strict,g=a(b.location.href);return{parse:function(a,b){var f=c;f.setAttribute("href",a);var g=(f.pathname.match(d)||[])[1]||"",h=g.split(".").map(function(a){return a.toLowerCase()});g=decodeURIComponent(g.replace(e,"")),h.shift();var i=h[h.length-1]||"",j={url:a,protocol:f.protocol,host:f.host,port:f.port,pathname:f.pathname,filename:g,ext:i,exts:h,hash:f.hash,search:f.search};return j.port||delete j.port,b&&(j.query={},f.search.replace(/^\?/,"").split(/\&/).forEach(function(a){a=a.split("="),j.query[a[0]]=a[1]})),j},parseParamString:function(a){a=a.replace(/^[#?]{1}/,"");var b=a.split("&"),c={};return b.forEach(function(a){var b=a.split("=");W.defined(b[0])&&W.defined(b[1])&&(c[b[0]]=decodeURIComponent(b[1].replace(/\+/g," ")))}),c},format:function(a){if(a=Object.create(a),a.query){a.search=[];for(var b in a.query)"undefined"!=typeof a.query[b]?a.search.push(b+"="+encodeURIComponent(a.query[b])):a.search.push(b);a.search="?"+a.search.join("&"),delete a.query}for(var d in a)c[d]=a[d];var e=c.href;return e},parse0:a,resolve:function(b,c){b=a(b),c||(c=g);var d=b[1],e=b[2],f=b[9],h=b[12],i=b[13];if(!d&&(d=c[1],!e))if(e=c[2],f){if("/"!==f.charAt(0)){var j=c[10]||"/";f=j+f}}else f=c[9],h||(h=c[12]);var k=d+"://"+e+f;return h&&(k+="?"+h),i&&(k+="#"+i),k},getHost:function(b){return a(b)[6]||""},getMediaType:function(b){var c=a(b)[11]||"";if(!c)return"";var d=c.split("."),e=d.length-1;if(0>=e)return"";var f=d[e].toLowerCase();return P[f]}}}(),V={sendMessage:function(a,b){try{chrome.runtime.sendMessage(a,b)}catch(c){return!1}return!0}},W={SIZES:["B","KB","MB","GB","TB","PB"],_BASE:-1!==navigator.appVersion.indexOf("Win")?1024:1e3,xmlParser:new DOMParser,endsWith:function(a,b){var c=a.length-b.length;return c>=0&&a.indexOf(b,c)===c},hash:function(a,b){if(b=0|b,0===a.length)return b;var c,d;for(c=0,d=a.length;d>c;c++)b=(b<<5)-b+a.charCodeAt(c),b|=0;return b},query:function(a,c){return c=c||b,c.querySelector(a)},queryAll:function(a,c){return c=c||b,W.toArray(c.querySelectorAll(a))},findParent:function(a,b){for(;null!==a&&!a.classList.contains(b);)a=a.parentNode;return a},nearestParent:function(a,c){for(;null!==a&&a!==b&&!a.matches(c);)a=a.parentNode;return a},closest:function(a,b){return a.matches(b)?[a]:W.queryAll(b,a)},getNodePropOrEmptyString:function(a,b){return a&&a[b]||""},toArray:function(a){return Array.prototype.slice.call(a)},unique:function(a){var b=[];return Array.isArray(a)?(a.forEach(function(a){-1===b.indexOf(a)&&b.push(a)}),b):a},extend:function(a,b){var c=function(){};c.prototype=a.prototype,b.prototype=new c,b.prototype.constructor=b,b._super=a.prototype},extendObject:function(a){return Array.prototype.forEach.call(Array.prototype.slice.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},isMatches:function(a,b){var c,d,e;if(Array.isArray(a)){for(c=0;c<a.length;++c)if(W.isMatches(a[c],b))return!0;return!1}for(b=Array.isArray(b)?b:[b],c=0,d=b.length,e;d>c;++c)if(e=b[c],"string"==typeof e&&-1!==a.indexOf(e)||e instanceof RegExp&&a.match(e))return!0;return!1},_sendBackgroundRequest:function(a,b,c,d){var e=new Z;return chrome.runtime.sendMessage({requestType:"make_http_request",method:a,url:b,params:c,headers:d},function(a){e[a.success?"resolve":"reject"](a.data)}),e},getYoutubeInfo:function(a){var b=new Z;return chrome.runtime.sendMessage({requestType:"youtube_get_info",method:"GET",url:a},function(a){b[a.success?"resolve":"reject"](a.data)}),b},send:function(a,b,c,d){var e=new Z,f=null;if(W.IS_CONTENT_SCRIPT)return W._sendBackgroundRequest(a,b,c,d);try{var g=new XMLHttpRequest;if(g.open(a,b,!0),g.setRequestHeader("Cache-Control","no-cache"),"object"==typeof c&&(f=Object.keys(c).map(function(a){return a+"="+c[a]}).join("&")),"object"==typeof d)for(var h in d)g.setRequestHeader(h,d[h]);"POST"===a&&(g.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f&&g.setRequestHeader("Content-Length",f.length)),g.onload=function(){e.resolve(this.responseText)},g.onerror=function(){e.reject()},g.send(f)}catch(i){e.reject()}return e},get:function(a,b){return W.send("GET",a,{},b)},post:function(a,b,c){return W.send("POST",a,b,c)},_getSize:function(a){function b(a){d&&d[a?"resolve":"reject"](a),d=null,c.abort(),clearTimeout(e),e=null}var c=new XMLHttpRequest,d=new Z,e=null,f=1e4;return c.open("GET",a),c.setRequestHeader("Cache-Control","no-cache"),c.url=a,c.onreadystatechange=function(){if(!(this.readyState<2)){var a=null;try{a=+this.getResponseHeader("Content-Length"),Number.isNaN(a)&&(a=null)}catch(c){}(null!==a||200===this.status)&&(200!==this.status&&(a=null),b(a))}},c.send(null),e=setTimeout(b,f),d},getSize:function(b){var c=new Z,d=a.cache;return d.get(b).success(function(a){a?(c.resolve(a),d.put(b,a)):c.bind(W._getSize(b)).success(d.put.bind(d,b))}).fail(function(){c.bind(W._getSize(b)).success(d.put.bind(d,b))}),c},beautifyFileSize:function(a,b){if(null===a||"undefined"==typeof a)return"???";for(var c=W._BASE,d=0;d<W.SIZES.length&&a>=c;++d,a/=c);const e=W.SIZES[d];var f=Math.round(10*a)/10;return b&&e&&"kb"===e.toLowerCase()&&(f=f.toFixed(0)),f+W.SIZES[d]},detectMediaTypeAndExt:function(a,b){b=b||"";var c=["application/x-mpegurl","application/vnd.apple.mpegurl","audio/x-mpegurl","audio/mpegurl"];if(-1!==c.indexOf(b))return a.type="video",a.ext="m3u8",a;var d=W.getMediaType(b,a.exts);return d&&O[d]&&(a.type=d,a.ext=this._findIntersection(a.exts,O[d].extensions)||W.extByContentType(b,d)||a.ext),a},getMediaType:function(a,b){var c;for(var d in O){if(c=O[d],a.match(c.rgxp))return d;if(Array.isArray(b)&&W._findIntersection(b,c.extensions)||-1!==c.extensions.indexOf(b))return d}return null},_findIntersection:function(a,b){for(var c=a.concat(b),d={},e=0;e<c.length;++e){var f=c[e];if(d[f])return f;d[f]=!0}return null},extByContentType:function(a,b){var c=O[b].ctype2extension;for(var d in c)if(-1!==a.indexOf(d))return c[d];return null},getProp:function(a,b){function c(a,b){var d=b.shift();return!d||"object"!=typeof a&&"function"!=typeof a||null===a?void 0:0===b.length?a[d]:c(a[d],b)}return c(a,b.split("."))},call:function(a,b){if(a&&!(a.length<=0))for(var c=[].slice.call(arguments,2),d=0;d<a.length;d++)a[d].apply(b,c)},isTrue:function(a){return!!a},noop:function(){},defined:function(a){return"undefined"!=typeof a},notNull:function(a){return null!==a},debounce:function(a,b,c){var d;return function(){function e(){c||a.apply(f,g),d=null}var f=this,g=arguments;d?clearTimeout(d):c&&a.apply(f,g),d=setTimeout(e,b||100)}},unescapeHTML:function(){var a;return function(c){a=a||b.createElement("div"),a.innerHTML=(""+c).replace(/</g,"&lt;");var d=a.firstChild.textContent;return a.innerHTML="",d}}(),replaceEntities:function(a){var b={"&amp;":"&"};return String(a).replace(/&amp;/g,function(a){return b[a]})},isFullscreen:function(){return Boolean(b.fullscreenElement||b.webkitFullscreenElement)},splitMediaSourcesByFilename:function(a){const b=new Map;return a.forEach(function(a){const c=a.filename;b.has(c)?b.set(c,b.get(c).concat(a)):b.set(c,[a])}),b},xpath:function(){function a(a){return a&&a.id&&!/\d/.test(a.id)?"//"+a.tagName+'[@id="'+a.id+'"]':c(a)}function c(a){for(var b=[];a&&a.nodeType==Node.ELEMENT_NODE;a=a.parentNode){for(var c=0,d=!1,e=a.previousSibling;e;e=e.previousSibling)e.nodeType!=Node.DOCUMENT_TYPE_NODE&&e.nodeName==a.nodeName&&++c;for(e=a.nextSibling;e&&!d;e=e.nextSibling)e.nodeName==a.nodeName&&(d=!0);var f=(a.prefix?a.prefix+":":"")+a.localName,g=c||d?"["+(c+1)+"]":"";b.splice(0,0,f+g)}return b.length?"/"+b.join("/"):null}function d(a,c){return c=c||b,b.evaluate(a,c,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}return{forElement:a,find:d}}(),dom:function(){function a(a,b){return Object.keys(b).forEach(function(c){a.setAttribute(c,b[c])}),a}function c(a,b){return Object.keys(b).forEach(function(c){a.style[c]=b[c]}),a}function d(a){var c=b.createElement("div"),d=b.createDocumentFragment();return c.innerHTML=a,[].slice.call(c.childNodes).forEach(d.appendChild,d),c=null,d}function e(a){if(!(a instanceof HTMLElement))return{width:0,height:0};a.matches("embed")&&a.parentNode.matches("object")&&(a=a.parentNode);var b=a.querySelector("embed");return b&&!S.check(b)&&b.offsetWidth&&b.offsetHeight&&(a=b),{width:a.offsetWidth,height:a.offsetHeight}}function f(a){return a.split(";").reduce(function(a,b){var c=b.indexOf(":");if(-1!==c){var d=b.substr(0,c).trim(),e=b.substr(c+1).trim();a[d]=e}return a},{})}function g(a){return Object.keys(a).map(function(b){return b+": "+a[b]}).join("; ")+";"}function h(a){for(var b={top:0,left:0,height:a.offsetHeight,width:a.offsetWidth};a;)b.left+=a.offsetLeft,b.top+=a.offsetTop,a=a.offsetParent;return b}return{attr:function(b,c){Array.isArray(b)?b.forEach(function(b){a(b,c)}):a(b,c)},style:function(a,b){Array.isArray(a)?a.forEach(function(a){c(a,b)}):c(a,b)},setStyleAttr:function(a,b){var c=function(a){var c=a.getAttribute("style")||"",d=f(c);for(var e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);var h=g(d);c!==h&&a.setAttribute("style",h)}.bind(this);Array.isArray(a)?a.forEach(c):c(a)},parseStyleAttr:f,parseHTML:d,getOffset:h,getEmbedSize:e}}(),google:function(){var a="com|ac|ad|ae|al|am|as|at|az|ba|be|bf|bg|bi|bj|bs|bt|by|ca|cc|cd|cf|cat|cg|ch|ci|cl|cm|cn|cv|cz|de|dj|dk|ee|fi|dm|dz|es|fm|fr|ga|ge|gf|gg|gl|gm|gp|gr|gy|hn|hr|ht|hu|ir|iq|ie|im|io|is|it|je|ki|kg|jo|kz|la|lt|lu|lv|li|lk|md|me|mg|mk|ml|mn|ms|mu|mv|mw|nl|no|nr|nu|pl|ne|pn|ps|pt|ro|rs|ru|rw|sc|se|sh|si|sn|sm|so|tk|tl|tm|to|tn|st|sk|tt|td|vu|ws|vg|tg|us",b="th|id|il|in|jp|ke|ma|kr|mz|ls|nz|tz|ug|uk|uz|ve|vi|za|zm|zw|ao|ck|bw|cr",c="pr|py|qa|sa|sb|sg|sl|sv|tj|tn|tr|tw|gh|gi|gt|hk|jm|kw|lb|lc|ly|mm|mt|mx|my|na|nf|ng|ni|np|om|pa|pe|ph|pk|pg|ua|uy|vc|vn|af|ag|ai|ar|au|bd|bh|bn|bo|br|bz|kh|co|cu|cy|do|ec|eg|et|fj",d=new RegExp("^(www\\.)?google\\.(("+a+")|(co((\\.("+b+"))|m\\.("+c+"))))$","i"),e=/[&?]q=[^&]/i;return{isSERPHost:function(a){return Boolean(a.match(d))},isSERPRequest:function(a){var b=U.parse(a);return Boolean(this.isSERPHost(b.host)&&b.pathname.match(/\/s(earch)?/i)&&b.search.match(e))},getSearchParams:function(a){var b=U.parse(a),c=U.parseParamString(b.search),d=U.parseParamString(b.hash||"#"),e=W.defined(d.q);return{_rawSearch:c,_rawHash:d,q:e?d.q:c.q||null,s:e?d.start||0:c.start||0,tbm:e?d.tbm:c.tbm||null,isXHR:c.tch,isHash:e}}}}()};a.SAVIOR_VERSION=a.SAVIOR_VERSION||"dev";try{var X=chrome.i18n.getMessage}catch(Y){}try{chrome.extension.getBackgroundPage(),W.IS_CONTENT_SCRIPT=!1}catch(Y){W.IS_CONTENT_SCRIPT=!0}try{W.IS_INCOGNITO=chrome.extension.inIncognitoContext}catch(Y){W.IS_INCOGNITO=!1}var Z=function(a){if(0===arguments.length)return this._init(),this;if(a instanceof Z)return a;var b=new Z;return b.resolve(a),b};Z.RUNNING=0,Z.RESOLVED=1,Z.FAILED=2,Z.prototype={constructor:Z,_init:function(){this._results=[],this._subscribers=[],this.state=Z.RUNNING},_notify:function(){var a=this;this._subscribers.forEach(function(b){b.apply(a,a._results)}),this._subscribers=[]},resolve:function(){return this.state=Z.RESOLVED,this._results=arguments,this._notify(),this},reject:function(){return this.state=Z.FAILED,this._results=arguments,this._notify(),this},subscribe:function(a){this.state!==Z.RUNNING?a.apply(this,this._results):this._subscribers.push(a)},done:function(a){return this.subscribe(a),this},success:function(a){var b=this;return this.subscribe(function(){b.state===Z.RESOLVED&&a.apply(b,b._results)}),this},fail:function(a){var b=this;return this.subscribe(function(){b.state===Z.FAILED&&a.apply(b,b._results)}),this},bind:function(a){return a=new Z(a),a.success(this.resolve.bind(this)).fail(this.reject.bind(this)),this}},Z.when=function(){var a=[];return a=Array.isArray(arguments[0])?arguments[0]:W.toArray(arguments),new Z.When(a)},Z.When=function(a){this._doneCallbacks=[],this._successCallbacks=[],this._failCallbacks=[],this._state=Z.RUNNING,this._thingsToDo=a.length,this._results=Array(this._thingsToDo),this._init(a)},Z.When.prototype={constructor:Z.When,_init:function(a){var b=this;a.forEach(function(a,c){a=new Z(a),a.subscribe(function(){a.state===Z.FAILED&&(b._state=Z.FAILED),b._results[c]=W.toArray(arguments),b._thingsToDo--,b._checkIsDone()})}),this._checkIsDone()},_checkIsDone:function(){if(0!==this._thingsToDo)return!1;var a=[];this._results.forEach(function(b){a=a.concat(b)}),this._state===Z.FAILED?this._runCallbacks(this._failCallbacks,a):this._runCallbacks(this._successCallbacks,a),this._runCallbacks(this._doneCallbacks,a),this._doneCallbacks=[],this._successCallbacks=[],this._failCallbacks=[]},_runCallbacks:function(a,b){a.forEach(function(a){a.apply(this,b)})},done:function(a){return this._doneCallbacks.push(a),this._checkIsDone(),this},success:function(a){return this._successCallbacks.push(a),this._checkIsDone(),this},fail:function(a){return this._failCallbacks.push(a),this._checkIsDone(),this}},Z.chain=function(){function a(b){if(!b.length)return c.resolve.apply(c,d);var e,f=b.shift();"function"==typeof f?(e=Z(f()),e.done(function(c){d.push(c),a(b)})):(d.push(f),a(b))}var b,c=new Z,d=[];return b=Array.isArray(arguments[0])?arguments[0]:W.toArray(arguments),a(b),c};var $=function(){};$.QL_HIGH="High",$.QL_MEDIUM="Medium",$.QL_LOW="Low",$.QL_VIDEO_ULTRAHD="Ultra HD",$.QL_VIDEO_FULLHD="Full HD",$.QL_VIDEO_HD="HD",$.QL_VIDEO_STANDARD="Standard",$.QL_VIDEO_MEDIUM="Medium",$.QL_VIDEO_SMALL="Small",$.QL_VIDEO_MOBILE="Mobile";var _={};_[$.QL_VIDEO_ULTRAHD]={quality:$.QL_HIGH,qualityIndex:6,size:3072,videoTitle:"Ultra HD",itag:[38,138]},_[$.QL_VIDEO_FULLHD]={quality:$.QL_HIGH,qualityIndex:5,size:1080,videoTitle:"Full HD",audioTitle:"High",itag:[37,46,137],vimeoQuality:"1080p",zingTag:"f1080",dailymotionQuality:"hd1080",clipvnQuality:"5"},_[$.QL_VIDEO_HD]={quality:$.QL_HIGH,qualityIndex:4,size:720,videoTitle:"HD",audioTitle:"High",itag:[22,45,120,136,247],zingTag:["f720","hq","320"],vimeoQuality:"720p",dailymotionQuality:["hd","hd720"],facebookQuality:["hd_src","hd_src_no_ratelimit"],JWQuality:"highquality",clipvnQuality:"4"},_[$.QL_VIDEO_STANDARD]={quality:$.QL_MEDIUM,qualityIndex:3,size:480,videoTitle:"Standard",audioTitle:"Normal",itag:[44,35,135,244],zingTag:["f480"],dailymotionQuality:"hq",vimeoQuality:"480p",facebookQuality:["sd_src","sd_src_no_ratelimit"],JWQuality:"location",clipvnQuality:"3"},_[$.QL_VIDEO_MEDIUM]={quality:$.QL_MEDIUM,qualityIndex:2,size:360,videoTitle:"Medium",audioTitle:"Normal",itag:[18,43,34,134,243],vimeoQuality:"360p",dailymotionQuality:"sd",zingTag:["source","f360","128"],JWQuality:"lowquality",clipvnQuality:"2"},_[$.QL_VIDEO_SMALL]={quality:$.QL_LOW,qualityIndex:1,size:240,videoTitle:"Small",audioTitle:"Low",itag:[36,5,133,242],dailymotionQuality:"ld",vimeoQuality:"270p",zingTag:["f","f240"],clipvnQuality:"1"},_[$.QL_VIDEO_MOBILE]={quality:$.QL_LOW,qualityIndex:0,size:144,videoTitle:"Mobile",audioTitle:"Low",itag:[17,6,160],vimeoQuality:"",clipvnQuality:"0"};var aa={};aa[$.QL_HIGH]=_[$.QL_VIDEO_ULTRAHD].qualityIndex,aa[$.QL_MEDIUM]=_[$.QL_VIDEO_STANDARD].qualityIndex,aa[$.QL_LOW]=_[$.QL_VIDEO_SMALL].qualityIndex,$.prototype={constructor:$,DEFAULT_QUALITY_LEVEL:$.QL_HIGH,QUALITY_LEVELS:[$.QL_HIGH,$.QL_MEDIUM,$.QL_LOW],VIDEO_QUALITY_LEVELS:[$.QL_VIDEO_ULTRAHD,$.QL_VIDEO_FULLHD,$.QL_VIDEO_HD,$.QL_VIDEO_STANDARD,$.QL_VIDEO_MEDIUM,$.QL_VIDEO_SMALL,$.QL_VIDEO_MOBILE],DEFAULT_QUALITY_TYPE:$.QL_VIDEO_STANDARD,QUALITY_TYPES:_,getFacebookQuality:function(a){return this._getVideoQuality("facebookQuality",a).videoTitle},getDailymotionQuality:function(a){return this._getVideoQuality("dailymotionQuality",a).videoTitle},getZingVideoQuality:function(a){return this._getVideoQuality("zingTag",a).videoTitle},getZingAudioQuality:function(a){return this._getVideoQuality("zingTag",a).audioTitle},getYoutubeQuality:function(a,b){var c=this._getVideoQuality("itag",+a,b);return c&&c.videoTitle},getVimeoQuality:function(a){return this._getVideoQuality("vimeoQuality",a).videoTitle},getClipvnQuality:function(a){return this._getVideoQuality("clipvnQuality",a).videoTitle},getJWQuality:function(a){return this._getVideoQuality("JWQuality",a).videoTitle},getQualityBySize:function(a){return this._getVideoQuality("size",a).videoTitle},getSizeByQuality:function(a){return(_[a]||{}).size||0},_getVideoQuality:function(a,b,c){for(var d in this.QUALITY_TYPES){var e=this.QUALITY_TYPES[d][a];if(Array.isArray(e)||(e=[e]),-1!==e.indexOf(b))return this.QUALITY_TYPES[d]}return c?null:this.QUALITY_TYPES[this.DEFAULT_QUALITY_TYPE]},_getTypeByQualityType:function(a){for(var b in this.QUALITY_TYPES)if(a===b||a===this.QUALITY_TYPES[b].videoTitle||a===this.QUALITY_TYPES[b].audioTitle)return this.QUALITY_TYPES[b];return this.QUALITY_TYPES[this.DEFAULT_QUALITY_TYPE]},_calculateWeight:function(a,b){var c=O[a.get("type")].extensions,d=c.indexOf(a.get("ext")),e=this._getTypeByQualityType(a.get("quality")).qualityIndex,f=d/c.length+Math.abs(b-e)/7;return f},getQualityLevelByType:function(a){return Object.keys(this.QUALITY_TYPES).indexOf(this._getTypeByQualityType(a).videoTitle)},getVideoQualityIndex:function(a){return this.VIDEO_QUALITY_LEVELS.concat().reverse().indexOf(a)},getOneClickQualityIndex:function(a){return this.QUALITY_LEVELS.concat().reverse().indexOf(a)},getQualityLevelByQualityType:function(a){return this._getTypeByQualityType(a).quality},chooseBestDownload:function(a,b,c){var d=a.length;if(c)for(var e=0;d>e;++e){var f=a[e];if(f.extQuality()===c)return f}b=b||this.DEFAULT_QUALITY_LEVEL;for(var g=aa[b],h=1e3,i=-1,e=0;d>e;++e){var f=a[e],j=this._calculateWeight(f,g);h>j&&(h=j,i=e)}return a[i]}},a.quality=new $;var ba=function(a){this._date=Date.now(),this._values={},this._sizePromise=null,this._hls=!1,this.merge(a)};ba.MAX_FILE_NAME_LENGTH=128,ba.isValidData=function(a){if(T.M3U8&&d(a.ext))return!0;var b=O[a.type],c=b&&b.extensions;return b&&-1!==c.indexOf(a.ext)},ba.prototype._createFieldGetter=function(a){this[a]=function(){return this.get(a)}},ba.prototype._generateFakeName=function(){return[this._values.type,e(this._values)].join("-").replace(/-+/g,"-")},ba.prototype.get=function(a){return"string"==typeof a||"number"==typeof a?this._values[a]:void 0},ba.prototype.set=function(a,b){return"string"!=typeof a&&"number"!=typeof a||this._values[a]===b||(this._values[a]=b,this[a]||this._createFieldGetter(a)),this},ba.prototype.merge=function(a){var b=a instanceof ba?a._values:a;for(var c in b)this.set(c,"undefined"!=typeof b[c]?b[c]:b[c]||null);return d(this.get("ext"))&&(this.set("ext","mp4"),this._hls=!0),this},ba.prototype.getName=function(){return W.replaceEntities(this._values.title||this._values.filename||this._generateFakeName())},ba.prototype.title=function(){return this.getName().substr(0,ba.MAX_FILE_NAME_LENGTH)},ba.prototype.getFilename=function(){var a=this.getName(),b="."+this._values.ext,c=0;return a.endsWith(b)&&(c=b.length+1),a=a.replace(/\s+/g," ").replace(/[\/\\:*?"<>|\u200c\u200d]/g,"-").substr(0,ba.MAX_FILE_NAME_LENGTH-c)+b},ba.prototype.extQuality=function(){return(this.get("ext")||"")+"/"+(this.get("quality")||"")},ba.prototype.size=function(){var a=this.get("size");return a?"("+W.beautifyFileSize(a)+")":""},ba.prototype.getSize=function(){function a(a){a&&e.push(W.getSize(a))}var b=this;if(b._sizePromise)return b._sizePromise;var c=new Z;b._sizePromise=c;var d=b.get("size");if(d=W.defined(d)?d:0,d||null===d||b._hls)return c.resolve(d),c;var e=[],f=b.get("url");if("object"==typeof f){var g=[f.audioUrl,f.videoUrl];g.forEach(a)}else a(f);e.length>0?e=1===e.length?e[0]:Z.when(e):(e=new Z,e.reject());var h=b.get("altUrl");return e.success(function(){for(var a=arguments,d=0,e=a.length-1;e>=0;e--)d+=a[e];b.set("size",d),c.resolve(d)}).fail(function(){if(h){var a=W.getSize(h);a.success(function(a){b.set("size",a)}),c.bind(a)}else c.reject(null)}),c};var ca=function(a,b){this.api=Na,this._uninitialized=!0,W.defined(b)||(b=-1),this._tid=b,this.data=[],this.setMediaData(a)};ca.prototype={setMediaData:function(a){var b=this,c=new Z;return a?(Z(a).done(function(a){if(b._uninitialized&&0===a.length)return b._uninitialized=!1,void c.reject(b,!0);b._uninitialized=!1;var d=b.data,f=new Array(d.length),g=d.map(function(a){return a.id()});a.forEach(function(a){a.id=a.id||e(a);var c,h=g.indexOf(a.id);-1===h?(g.push(a.id),c=new ba(a),d.push(c)):(h<f.length&&(f[h]=!0),c=d[h],c.merge(a)),c._ditem=b.api.item(b._tid,a.id)});for(var h=f.length!==d.length,i=f.length-1;i>=0;i--)f[i]||(h=!0,d.splice(i,1));c.resolve(b,h)}),c):(c.reject(this,!1),c)},getMediaCount:function(){var a=this.data;if(0===a.length)return 0;for(var b=0,c={},d=0;d<a.length;++d){var e=a[d],f=e.title()+e.type();c[f]||(c[f]=!0,++b)}return b},getMedia:function(a){return this.data.filter(function(b){return b.id()==a})[0]},getMediaGroup:function(a){return this.data.filter(function(b){return-1!==a.indexOf(b.id())})},download:function(a){var b=this.getMedia(a);if(b){var c={id:b.id(),url:b.url(),filename:b.getFilename(),referrer:b.referrer(),hls:b._hls};"function"==typeof b.soundOnly&&(c.soundOnly=b.soundOnly()),"function"==typeof b.quality&&(c.quality=b.quality());var d=this.api.download(this._tid,c);return d.success(function(a){b._ditem=a}),"undefined"!=typeof c.soundOnly&&c.soundOnly&&metrics.log("Download",metrics.DOWNLOAD_SOUND_ONLY),c.filename&&c.filename.match(/\.yt_srt$/i)&&metrics.log("Download",metrics.DOWNLOAD_SUBTITLES),d}},onChange:function(a){this.api.onChange(this._tid,a)},group:function(){return i(f(this.data,["type","title","ext","quality"]))},filterByCommonFields:function(a,b,c){var d=this.getMedia(a);return c=c||[],this.data.filter(function(e){return a!==e.id&&b.reduce(function(a,b){return a&&d[b]&&e[b]&&d[b]()===e[b]()},!0)&&c.reduce(function(a,b){return a&&d[b]&&e[b]&&d[b]()!==e[b]()},!0)})},getSameQualityMediaFormats:function(a){var b=this.filterByCommonFields(a,["title","type","quality"],["ext"]).map(function(a){return a.ext&&a.ext()});return Array.from(new Set(b))},getSameFormatMediaQuality:function(a){var b=this.filterByCommonFields(a,["title","type","ext"],["quality"]).map(function(a){var b=a.quality?quality.getSizeByQuality(a.quality()):0;return b});return Array.from(new Set(b))},getAllMediaFormats:function(a){return this.filterByCommonFields(a,["title","type"]).reduce(function(a,b){var c=b.ext&&b.ext(),d=b.quality?quality.getSizeByQuality(b.quality()):0;return c?(a[c]||(a[c]=[]),-1===a[c].indexOf(d)&&a[c].push(d),a):a},{})},isOneMedia:function(){for(var a,b,c=this.data,d={},e=0,f=0;e<c.length&&1>=f;++e)if(a=c[e],b=a.title()+a.type(),!d[b]&&(d[b]=!0,++f>1))return!1;return!0}};var da=function(){this._storage=chrome.storage.local,this._options={},this._default={detach_enabled:!0,on_page_buttons:!0,min_stream_size:30720,prefer_last_quality:!0,hide_play_now_tooltip:!1,hide_play_now_tooltip_bottom:!1};var a=this;chrome.storage.onChanged.addListener(function(b,c){if("local"===c)for(var d in b)a._options[d]=b[d].newValue})};da.prototype={load:function(){var a=new Z,b=this;return this._storage.get(null,function(c){b._options=c,a.resolve(c)}),a},set:function(a,b){var c={};("string"==typeof a||"number"==typeof a&&"undefined"!=typeof b)&&(c[a]=b,this._options[a]=b,this._storage.set(c))},get:function(a){return a in this._options?this._options[a]:this._default[a]}},function(){var c=function(){};c.SERVER_LOG_URL="https://coccoc.com/s_log",c.SOURCE_POPUP_PAGE=0,c.SOURCE_OPTIONS_PAGE=10,c.SOURCE_CONTENT_SCRIPT=20,c.SOURCE_BACKGROUND_PAGE=30,c.prototype={LEGACY_METRICS_NAME_MAP:{ButtonClicked:"TryItNowButtonClicked",CheckBoxClicked:"OneClickCheckbox"},get source(){if(!chrome.extension.getBackgroundPage)return c.SOURCE_CONTENT_SCRIPT;switch(b.location.pathname){case"/popup.html":return c.SOURCE_POPUP_PAGE;case"/options.html":return c.SOURCE_OPTIONS_PAGE;case"/background.html":return c.SOURCE_BACKGROUND_PAGE;default:return}},_getFullName:function(a){return"Savior."+(this.LEGACY_METRICS_NAME_MAP[a]||a)},_getTotalValue:function(a,b,c){var d=0===a.indexOf("Refr");return d||c||"PageShown"===a||"number"!=typeof b?b:b+this.source},_doLog:function(a,b,d){var e=this._getFullName(b);if(this.source===c.SOURCE_CONTENT_SCRIPT)chrome.runtime.sendMessage({requestType:"metrics",method:"log",params:{name:b,value:d}});else if(chrome.metricsPrivate)switch(a){case"recordSmallCount":chrome.metricsPrivate.recordValue({metricName:e,type:chrome.metricsPrivate.MetricTypeType.HISTOGRAM_LINEAR,min:0,max:100,buckets:100},d);break;case"recordValue":chrome.metricsPrivate.recordValue({metricName:e,type:chrome.metricsPrivate.MetricTypeType.HISTOGRAM_LINEAR,min:0,max:1e3,buckets:1002},d);break;case"recordSerpData":case"recordClickData":chrome.metricsPrivate[a](d)}},_getMethodByName:function(a){switch(a){case"Refr":case"RefrSE":case"RefrFE":return"recordValue";case"SerpData":return"recordSerpData";case"SerpClickData":return"recordClickData";default:return"recordSmallCount"}},log:function(a,b,c){var d=this._getMethodByName(a),e=this._getTotalValue(a,b,c);this._doLog(d,a,e)},logFromContentScript:function(a,b){this.log(a,b,!0)},serverLog:function(a,b){var d=new Image,e=[];b=Object.assign({action:a,source:this.source,version:"0.17.2"},b),Object.keys(b).reduce(function(a,c){return e.push(c+"="+encodeURIComponent(b[c])),e},e),d.src=c.SERVER_LOG_URL+"?"+e.join("&")},PAGE_WELCOME_SCREEN:0,PAGE_DOWNLOADS_LIST:1,PAGE_ONE_CLICK_DOWNLOAD:2,PAGE_NO_MEDIA_FOUND:3,PAGE_OPTIONS:4,PAGE_CONTENT_SHOW_CONTROLS:5,PAGE_CONTENT_NO_MEDIA:9,DOWNLOAD_AUTO:0,DOWNLOAD_BUTTON:1,DOWNLOAD_ALL:2,DOWNLOAD_REQUEST_SIZE:3,DOWNLOAD_REQUEST_SIZE_FAILED:4,DOWNLOAD_SOUND_ONLY:5,DOWNLOAD_SUBTITLES:6,DOWNLOAD_CANCELED:7,BUTTON_MAIN:0,BUTTON_TRY_IT_NOW:1,BUTTON_SHOW_DOWNLOADS:2,BUTTON_HIDE_DOWNLOADS:3,BUTTON_DOWNLOAD_ALL:4,BUTTON_CHECK_ALL:5,BUTTON_CHECK_NONE:6,BUTTON_FAKE_QUALITY:7,BUTTON_DETACH:8,BUTTON_HIDE:9,CHECK_BOX_ENABLE_ONE_CLICK:0,CHECK_BOX_SHOW_ON_PAGE_BUTTONS:2,CHECK_BOX_PREFER_LAST_QUALITY:4,CHECK_BOX_DETACH_ENABLED:6,PIP_DETACH_CLICK:0,PIP_RESTORE_CLICK:1,PIP_SITE_LINK_CLICK:2,PLAY_NOW_SHOWN:0,PLAY_NOW_WIDGET_CLICKED:1,PLAY_NOW_TOOLTIP_SHOWN:2,PLAY_NOW_TOOLTIP_CLOSED:3,PLAY_NOW_TOOLTIP_NOT_SHOW_AGAIN:4,PLAY_NOW_TOOLTIP_BOTTOM_SHOWN:5,PLAY_NOW_TOOLTIP_BOTTOM_CLOSED:6,PLAY_NOW_TOOLTIP_BOTTOM_NOT_SHOW_AGAIN:7},a.metrics=new c}();var ea,fa=function(){var c=function(a,b){var c=new Set(["string","number","boolean","undefined"]),d=function(a){if(null===a||c.has(typeof a))return a;if(Array.isArray(a))return a.map(d);if("object"==typeof a&&Object.getPrototypeOf(a)===Object.prototype){var b={};return Object.keys(a).forEach(function(c){b[c]=d(a[c])}),b}return null},e={report:function(b,c){b(Array.isArray(c)?d(c.reduce(function(a,b){return a&&a[b]},a)):null)},eval:function(a,b){var c=null;try{c=new Function(b).call(this)}catch(e){c=e.toString()}a(d(c))}};a.addEventListener("message",function(c){if(c.origin===location.origin&&c.data&&c.data.port===b&&"coc_crx2page"===c.data.type){const d=c.data.id;var f=c.data.data,g=function(c){c={data:c,id:d,port:b,type:"coc_page2crx"},a.postMessage(c,location.origin)};"method"in f&&f.method in e&&e[f.method].apply(e,[g].concat(f.args))}})},d=function(){this.port=Math.floor(Math.random()*Math.pow(2,32)),this.msgId=0,this._promises={},this._initPage(),a.addEventListener("message",this._listener.bind(this))};return d.prototype={send:function(b){b={data:b,id:this.msgId,port:this.port,type:"coc_crx2page"};var c=new Z;return this._promises[this.msgId]=c,this.msgId++,a.postMessage(b,location.origin),c},_initPage:function(){var a=b.head||b.body;if(a){var d=b.createElement("script"),e="("+c.toString()+")(window,"+this.port+")";d.innerText=e,a.appendChild(d),setTimeout(function(){a.removeChild(d)},100)}},_listener:function(a){if(a.origin===location.origin&&a.data&&a.data.port===this.port&&"coc_page2crx"===a.data.type){var b=a.data;try{this._promises[b.id]instanceof Z&&this._promises[b.id].resolve(b.data)}finally{delete this._promises[b.id]}}}},d}();b.addEventListener("DOMContentLoaded",function(){ea=new fa});var ga=W.query.bind(W),ha=W.queryAll.bind(W),ia=W.getNodePropOrEmptyString.bind(W),ja=function(a,b,c,d,e){this._node=b,this._docId=d,this._index=e,this._data=this._extractData(b,c),this._validateAndSetDataType(a),this._attachClickHandler()};ja.prototype={TITLE_SELECTOR:"h3 a",VISIBLE_URL_SELECTOR:"cite",LINK_SELECTOR:"h3 a:not([id])",DESC_SELECTOR:".st",_extractData:function(a,b){var c=ga(this.TITLE_SELECTOR,a),d=ga(this.VISIBLE_URL_SELECTOR,a),e=ga(this.DESC_SELECTOR,a),f=ga(this.LINK_SELECTOR,a),g={url:ia(f,"href"),visibleUrl:ia(d,"textContent"),position:b,title:ia(c,"textContent"),description:ia(e,"textContent"),addRawContent:""};return g},_validateAndSetDataType:function(a){this._isDataValid(this._data)?this._data.type=a:this._data.type="unknown"},_isDataValid:function(a){return Boolean(a.title&&a.visibleUrl&&a.url&&a.description)},_attachClickHandler:function(){this._clickHandler=this._onClick.bind(this),this._node.addEventListener("click",this._clickHandler,!0)},_onClick:function(a){var b,c,d=W.nearestParent(a.target,"a");return d&&d.nodeType===Node.ELEMENT_NODE&&(b=d.getAttribute("href"),b.trim().match(/^(#|javascript:)/)||(c=d.dataset.href||d.href||this.data.url||"",gserp.triggeResultClicked(),this._reportClick(c))),!0},_reportClick:function(a){metrics.log("SerpClickData",{serpId:this._docId,itemIndex:this._index,timestamp:Date.now(),url:a})},_reportClickConsole:function(a){},destroy:function(){this._node.removeEventListener("click",this._clickHandler),this._node=null,this._data=null},get data(){return this._data},renderToConsole:function(){this.data.type;this.data.addRawContent}};var ka=function(){ja.apply(this,arguments)};ka.prototype={__proto__:ja.prototype,DESC_SELECTOR:".ads-creative",LINK_SELECTOR:"h3 a:last-child",NOT_RAW_CONTENT_SELECTOR:"h3, .ads-visurl, .ads-creative",TITLE_SELECTOR:"h3 a:last-child",_extractAdditionalContent:function(){var a="";return W.toArray(this._node.children).forEach(function(b){b.matches(this.NOT_RAW_CONTENT_SELECTOR)||(a+=b.outerHTML+"\n")}.bind(this)),a},_extractData:function(){var a=ja.prototype._extractData.apply(this,arguments),b=this._extractAdditionalContent();return a.addRawContent=b,a}};var ga=W.query.bind(W),ia=W.getNodePropOrEmptyString.bind(W),la=function(){ja.apply(this,arguments)};la.prototype={__proto__:ja.prototype,IMAGE_NODE_SELECTOR:"#imagebox_bigimages",IMAGE_TITLE:"h3 > a",SEARCH_BLOCKS_SELECTOR:"#ires .g",_validateAndSetDataType:function(a){if(this._node.matches(this.IMAGE_NODE_SELECTOR)){var b=ga(this.IMAGE_TITLE,this._node);this._data.type=a,this._data.title=ia(b,"textContent"),this._data.url=ia(b,"href")}else this._data.type="unknown"}};var ga=W.query.bind(W),ma=function(){ja.apply(this,arguments)};ma.prototype={__proto__:ja.prototype,LINK_SELECTOR:'a[tabindex="0"]',LINK_MAP:"#lu_map",_validateAndSetDataType:function(a){var b=this._node.querySelector(this.LINK_MAP);if(b){var c=b.parentNode;this._data.url=ia(c,"href"),this._data.type=a}else this._data.type="unknown"}};var na={"top-ad":ka,"bottom-ad":ka,image:la,"poi-serp":ma,"poi-side":ma},oa=function(a,b,c,d,e){var f=na[a]||ja;return new f(a,b,c,d,e)};GoogleSERPResults=function(){this._items=[],this._isReported=!1,this._scrape()},GoogleSERPResults.VERSION=6,GoogleSERPResults.prototype={ITEMS_PER_PAGE:10,NOT_SERP_NODES_SELECTOR:"hr",IMAGE_NODE_SELECTOR:"#imagebox_bigimages",SEARCH_BLOCKS_SELECTOR:"#ires .g",POI_SERP_SELECTOR:"#rso > div > div[data-hveid] > div[jsl]",POI_SIDE_SELECTOR:"#rhs_block > div",_addItem:function(a,b,c){var d=this._items.length;this._items.push(new oa(a,b,c,this._docId,d))},_scrapeAds:function(a){var b={"top-ad":"#tads > ol > li","bottom-ad":"#bottomads ol >li"},c=ha(b[a]);return c.forEach(function(b,c){this._addItem(a,b,c)}.bind(this)),c.length},_scrapeSER:function(a,b){var c=W.toArray(a.children).filter(function(a){return a.nodeType===Node.ELEMENT_NODE});return c.forEach(function(a,c){this._addItem("organic",a,b+c)}.bind(this)),c.length},_scrapeResults:function(){var a=ha(this.SEARCH_BLOCKS_SELECTOR+", "+this.POI_SERP_SELECTOR),b=0;return a.forEach(function(a,c){if(""!==a.textContent.trim()&&!a.matches(this.NOT_SERP_NODES_SELECTOR)){var d=a.matches(".srg")?a:a.querySelector(".srg");d?b+=this._scrapeSER(d,b):a.matches(this.IMAGE_NODE_SELECTOR)?this._addItem("image",a,b++):a.matches(this.POI_SERP_SELECTOR)?this._addItem("poi-serp",a,b++):this._addItem("organic",a,b++);
}}.bind(this)),b},_generateDocId:function(){return Date.now().toString(32)+"-"+Math.random().toString(32).slice(2)},_scrapeSidePOI:function(){var a=ga(this.POI_SIDE_SELECTOR);a&&this._addItem("poi-side",a,this._items.length)},get _q(){function a(a){return a.offsetWidth&&a.offsetHeight}var b=ga(".spell_orig b");if(b&&a(b))return b.textContent.trim();var c=ga("a.spell_orig");return c&&c.href&&a(c)||(c=ga(".qs")),c&&a(c)&&c.href?W.google.getSearchParams(c.href).q:null},_parsePage:function(){var a=ga("#nav .cur");return a?parseInt(a.textContent.trim()):1},_scrape:function(a){this._docId=this._generateDocId(),this._s=(this._parsePage()-1)*this.ITEMS_PER_PAGE,this._scrapeAds("top-ad"),this._scrapeResults(),this._scrapeAds("bottom-ad"),this._scrapeSidePOI()},getSERPData:function(){var b={type:"gsearch",id:this._docId,domain:a.location.href,referer:this._extractReferer(),searchQuery:this._q,searchStart:this._s,timestamp:Date.now(),items:this._items.map(j("data")),version:GoogleSERPResults.VERSION};return b},_extractReferer:function(){if(b.referrer)return b.referrer;if(this._isFromIndexPage)return"google_index";var a=b.location.search,c=b.location.hash,d=/[&?]sourceid=chrome&?/gi,e=/#q=./gi;return e.test(c)?"google_serp":d.test(a)?"omnibox":"unknown"},_metricsReport:function(){metrics.log("SerpData",this.getSERPData())},_consoleReport:function(){this._items.forEach(k("renderToConsole"))},isSameSearchAs:function(a){return a&&a.q===this._q&&a.s==this._s},report:function(a){this._isFromIndexPage=a,this._isReported||(this._isReported=!0,this._metricsReport())},destroy:function(){this._items.forEach(k("destroy"))}};var ga=W.query.bind(W);GoogleSERPPage=function(){W.google.isSERPHost(location.host)&&(this._lastQs=null,this._currentQParams=W.google.getSearchParams(location.href),this._isLastWasIndex=this._isIndexPage,a.addEventListener("popstate",this._onPopState.bind(this)),a.addEventListener("hashchange",this._onPopState.bind(this)),this._startPolling())},GoogleSERPPage.prototype={POLLING_INTERVAL:200,SERP_URL_PATTERN:/[#?&]q=.+/,get _isOrganic(){return!W.google.getSearchParams(location.href).tbm},_clearResults:function(){this._currentResults&&this._currentResults.destroy(),this._currentResults=null,this._currentQParams=null},_reportResultsIfQueriesMatch:function(){this._currentResults&&this._currentResults.isSameSearchAs(this._currentQParams)&&(this._currentResults.report(this._isLastWasIndex),this._isLastWasIndex=!1)},_onPopState:function(a){return this._isOrganic?(this._currentQParams=W.google.getSearchParams(location.href),void this._reportResultsIfQueriesMatch()):void this._clearResults()},_onResultsRendered:function(a){return this._isOrganic?(this._currentResults&&this._currentResults.destroy(),this._currentResults=new GoogleSERPResults,void this._reportResultsIfQueriesMatch()):void this._clearResults()},triggeResultClicked:function(){return this._isOrganic?void(this._currentResults&&(this._currentResults.report(this._isLastWasIndex),this._isLastWasIndex=!1)):void this._clearResults()},get _isDOMStateDifferent(){var a=ga(".qs");return a&&a!==this._lastQs?(this._lastQs=a,!0):!1},get _areQParamsDifferent(){var a=W.google.getSearchParams(location.href);return!this._currentQParams&&a.q||a.q!==this._currentQParams.q||a.s!=this._currentQParams.s},get _isResultBlockVisible(){var a=ga("#search");return a?"hidden"!==a.style.visibility:!1},get _isIndexPage(){return!this.SERP_URL_PATTERN.test(a.location.href)},_startPolling:function(){setInterval(this._onTimerTick.bind(this),this.POLLING_INTERVAL)},_onTimerTick:function(){this._isResultBlockVisible&&this._isDOMStateDifferent&&this._onResultsRendered(),this._areQParamsDifferent&&this._onPopState(),this._isLastWasIndex||(this._isLastWasIndex=this._isIndexPage)}},gserp=new GoogleSERPPage;var pa,qa={extract:function(a){var b,c=a.getAttribute("flashvars").split("&");return c.forEach(function(a){a=a.split("="),"file"===a[0]&&(b=decodeURIComponent(a[1]))}),b},parsePlaylist:function(a,b){var c=W.xmlParser.parseFromString(b,"text/xml"),e=[],f="location, highquality, lowquality";return W.queryAll("track",c).forEach(function(a){W.queryAll(f,a).forEach(function(b){var c=b.textContent.trim(),f=U.parse(c);if(!d(f.ext)){var g=[a.querySelector("title").textContent.trim()],h=a.querySelector("creator");h&&""!==h.textContent.trim()&&g.unshift(h.textContent.trim()),f.type="mp3"===f.ext?"audio":"video",f.title=g.join(" – "),f.quality=quality.getJWQuality(b.nodeName),e.push(f)}})}),e}},ra={_getMedia:function(a){var b=U.parse(a);return b.type="video",b.ext="m3u8",b},parsePlaylist:function(a,b){var c=[];if(0!==b.indexOf("#EXTM3U"))return c;for(var d,e,f=U.parse0(a),g=0,h=0,i=b.split("\n"),j=0;j<i.length;j++){var k=i[j];if(k)if(0===k.indexOf("#"))0===k.indexOf("#EXTINF:")?g=1:0===k.indexOf("#EXT-X-STREAM-INF:")&&(g=2);else{switch(g){case 1:h+=1;break;case 2:d=U.resolve(k,f),e=ra._getMedia(d),e&&c.push(e)}g=0}}return 0===c.length&&h>0&&(e=ra._getMedia(a),e&&c.push(e)),c}};!function(){function a(a){return W.isMatches(a,Q)}const b=o({request:{method:"GET",url:function(a){return d(a.ext)?a.url:null}},parse:function(a,b){return b?ra.parsePlaylist(a,b):[a]}});pa=p("default",function(){var c=location.host,d=[];if(a(c))return d;for(var e=W.queryAll("[src]"),f=[],g=0,h=e.length;h>g;++g){var i=e[g],j=i.src,k=U.getMediaType(j);if(k&&i.getAttribute("src")){var l=U.parse(j);q(l.host)||(l.type=k,ba.isValidData(l)&&(i=m(i),i?d.push(this.makePlayer0(i,[l],b)):f.push(l)))}}return f.length&&d.push(this.makePlayer(null,f,b)),this._ids.length&&d.push(this.makePlayer0(null,this._ids,b)),d},{dynamic:!0}),S.check(location.href,"download")&&(pa.prototype.processRequest=W.noop)}();var sa;const ta={"3072p":"Super HD","2160p":"Ultra HD","1440p":"Quad HD","1080p":"Full HD","720p":"HD","480p":"Standard","360p":"Medium","270p":"Small","240p":"Small","144p":"Mobile"};!function(){function a(a){for(var b,c=0;c<h.length;++c)if(b=a.match(h[c]))return b[1];return null}function c(){var b=a(location.href);if(!b){var c=W.query("[data-video-id]");b=c&&c.dataset.videoId}return b||null}function d(a){var b=new Z;return W.getYoutubeInfo(i+a).success(function(a){f(b,a)}).fail(function(a){return b.reject(a)}),b}function e(a,b){const c="en";if(!a.caption_tracks)return null;var d={},e={};if(a.caption_tracks.split(",").forEach(function(a){var b=a.split("&").reduce(function(a,b){var c=b.split("="),d=c[0],e=decodeURIComponent(c[1]);return a[d]=e,a},{});d[b.lc]=b}),0===Object.keys(d).length)return null;var f=d[c]||d[Object.keys(d)[0]];return b.forEach(function(a){var b,c=d[a],g=g=X("subtitles_lang_"+a)||a.toUpperCase();c?b=c.u:(g+=" "+X("subtitles_auto_translated"),b=f.u+"&tlang="+a),e[g]=b}),e}function f(a,b){var c={},d=[],f=null;T.SUBTITLES&&(f=e(b,["en","vi"]));var g=b.formats.map(function(a){a.resolution&&ta[a.resolution]&&(a.quality=ta[a.resolution]);var e={ext:a.container,filename:b.title,quality:a.quality,url:a.url,type:W.getMediaType(a.type)},f=U.parse(a.url);return f.host=a.fallback_host,f.host&&(e.altUrl=U.format(f)),!a.encoding&&a.audioEncoding&&(c[a.container]=c[a.container]||{audioBitrate:0},c[a.container].audioBitrate<a.audioBitrate&&(c[a.container]=a)),a.audioEncoding||d.push(e),e});if(d.forEach(function(a,b){if(!c[a.ext]||!c[a.ext].url||!l[a.ext])return a.url=null,void(a.quality=null);var d=a.url;a.url={videoUrl:decodeURIComponent(d),audioUrl:decodeURIComponent(c[a.ext].url)}}),f){const h=Object.keys(f).map(function(a){var c=U.parse(f[a]);return c.ext="yt_srt",c.i18n_ext=X("media_fields_ext_yt_srt"),c.filename=b.title,c.quality=a,c.type="video",c.isSubtitles=!0,c});g=g.concat(h)}a.resolve(g.filter(function(a){return!!a.url}))}const g="https:"===location.protocol.toLowerCase()?"https:":"http:",h=[/^https?:\/\/(?:www\.)?youtube(?:-nocookie)?(?:\.googleapis)?\.com\/(?:(?:v)|(?:embed)|(?:e))\/(?!videoseries)([^&\?]+)/i,/https?:\/\/(?:www\.)?youtu\.be\/([^#&\?]+)/i,/https?:\/\/(?:www\.)?youtube\.com\/.*(?:\?|&)v=([^#&\?]+)/i],i=g+"//www.youtube.com/watch?v=",j=[/^https?:\/\/(?:www\.)?facebook.com\//i],k=W.isMatches(b.location.href,j),l=T.YT,n=(["&keepalive=yes","alr=yes","gir=yes","c=WEB","cver=html5"].join("&"),o({parse:function(a){return movies=d(a),movies}}));sa=p("youtube",function(){var b,c=this,d=[],e=[];if(!W.query("#player-unavailable:not(.hid)")){b=W.query(".html5-video-player")||W.query("#player, #movie_player, #movie_player-html5, #movie_player-flash");var f=W.queryAll('embed[type="application/x-shockwave-flash"]',b);if(1===f.length&&(f=m(f[0]),f&&(b=f)),b){b=c.makePlayer(b,[],n);var g=a(location.href);g&&(b.ids.push(g),e.push(g))}}var h=W.query(".channels-video-player, #upsell-video");if(h){var i=h.dataset;if(h=c.makePlayer(h,[],n),i){var g=i.videoId;g&&(h.ids.push(g),e.push(g))}b||(b=h,h=null)}return W.queryAll('iframe[src*="youtube"], embed[src*="youtube"]').forEach(function(b){var f=a(b.src);f&&-1===e.indexOf(f)&&(e.push(f),d.push(c.makePlayer(b,[f],n)))}),k&&W.queryAll('a[href*="youtube.com"], a[href*="youtu.be"]').forEach(function(b){var f=a(decodeURIComponent(b.href));f&&-1===e.indexOf(f)&&(e.push(f),b=null,d.push(c.makePlayer(b,[f],n,{aggressive:!0})))}),h&&h.ids.length&&d.splice(0,0,h),b&&b.ids.length&&d.splice(0,0,b),d.push(c.makePlayer(null,this._ids,n)),d},{dynamic:!0,pip:{detach:function(a){if(this.node.matches("iframe, embed"))return a(this.node),!0;var d=c();if(!d)return!1;var e="https://www.youtube";e+=".com/embed/"+d+"?showinfo=0&autohide=1&enablejsapi=1";var f=W.closest(this.node,"video");f.length&&(f=f[0],this._videoNode=f,f.currentTime>0&&(e+="&start="+Math.floor(f.currentTime)),f.ended||(e+="&autoplay=1"),f.pause()),b.body.style.overflow="hidden";var g=b.createElement("iframe");W.dom.style(g,{position:"fixed",left:0,right:0,top:0,bottom:0,width:"100%",height:"100%","z-index":Number.MAX_SAFE_INTEGER-1}),g.setAttribute("allowfullscreen",!0),g.src=e;var h=b.body.children[0];return h?b.body.insertBefore(g,h):b.body.appendChild(g),this._pipNode=g,!0},restore:function(d){if(this.node.matches("iframe, embed"))return d(this.node);if(this._pipNode){var e=this._pipNode&&this._pipNode.contentWindow,f=e&&e.document.querySelector("video"),g=e&&e.document.querySelector("a.ytp-title-link");if(f&&g){var h=c(),i=a(g.href);h!==i?location.href=g.href+"#t="+Math.floor(f.currentTime):this._videoNode&&(this._videoNode.currentTime=f.currentTime,this._videoNode[f.paused?"pause":"play"]())}b.body.removeChild(this._pipNode),b.body.style.overflow="auto"}}}}),sa.getMoviesById=d}();var ua;!function(){function c(a){for(var b,c=0;c<h.length;++c)if(b=a.match(h[c]),b&&b[1])return b[1];return null}function d(a){var b=a.match(i)||[];return b[1]}function e(b){var c=[],d=[];try{d=W.getProp(b,"request.files.progressive")||[]}catch(e){return c}return d.forEach(function(d){c.push({type:"video",title:b.video.title,filename:b.video.title,ext:"mp4",url:d.url,quality:a.quality.getVimeoQuality(d.quality)})}),c}function f(a){switch(a.tagName){case"IFRAME":return c(a.src);case"PARAM":return d(a.value);case"VIDEO":return d(a.src);default:return c(a.getAttribute("data-fallback-url")||"")}return null}const g="https:"===location.protocol.toLowerCase()?"https:":"http:",h=[/\/\/(?:player\.)?vimeo\.com(?:\/video)?\/([0-9]+)/i,/\/\/vimeo.com\/couchmode\/.*\/([0-9]+)/i,/\/\/player.vimeo.com\/v[0-9]\/video\/([0-9]+)/i,/\/\/player.vimeo.com\/moog\/([0-9]+)/i],i=/(?:&|\?)clip_id=([0-9]+)(?:&|$)/i,j=g+"//player.vimeo.com/video/{{id}}/config",k=o({request:{method:"GET",url:function(a){return a.match(/\/video\/(\d+)\/config(\?|$)/i)?a:j.replace("{{id}}",a).replace("{{location}}",location.href)},headers:function(a){return{"X-Savior-Replace-Referer":b.location.href}}},parse:function(a,b){var c=JSON.parse(b);return e(c)}});ua=p("vimeo",function(){var a=this,b=[],d=[],e=W.queryAll('iframe[src*="vimeo.com"], param[value*="vimeo.com"], video[src*="vimeo.com"], .player[data-fallback-url]');if(e.forEach(function(c){var e=f(c);e&&-1===d.indexOf(e)&&(d.push(e),b.push(a.makePlayer(c,[e],k)))}),"vimeo.com"===location.host||"player.vimeo.com"===location.host){var g=W.query("#videos_gallery li.selected a"),h=g&&g.href||location.href,i=c(h);i&&-1===d.indexOf(i)&&(d.push(i),b.push(a.makePlayer(g,[i],k)))}return b.push(a.makePlayer(null,a._ids,k)),b},{dynamic:!0})}();var va;!function(){function a(a,b,c){var d=U.parse(a);return d.type="video",d.title=b||d.title,d.quality=quality.getFacebookQuality(c),d}function b(a){var b=j.exec(a);return b=b&&b.length?b[0].replace(j,"$1"):null}function c(a){const b=a.parentNode.querySelectorAll('a[href^="/"]');if(b&&/\/videos\/\d+\/?$/.test(b.href))return b;const c=W.nearestParent(a,'[role="article"]');if(c){const d=c.querySelector("a[data-video-id]");if(d)return d.href;const e=c.querySelector('a[target][rel="theater"]');if(e)return e.href}return null}const d=/(\.|^)(facebook|fb).com$/i,e=/^blob:https?:\/\/(www)?\.?facebook\.com\/[A-z0-9-]+$/,f="video",g=["sd_src","hd_src","sd_src_no_ratelimit","hd_src_no_ratelimit"],h=/"?videoData"?:\s?\[[\s\S]*?\}\]/g,i='"?video_id"?:\\s?"{{{ID}}}"',j=/<title.*>([\s\S]*)<\/title>/gim,k=/(?:h|s)d_src(?:_no_ratelimit)?:"([^"]+)"+?/g,l=new Set,m=o({request:{method:"GET",url:function(a){return a}},parse:function(c,d){l.add(c);const e=c.split("/").filter(function(a){return!!a}),f=e[e.length-1],j=b(d),m=d.match(h);if(m){const n=new RegExp(i.replace("{{{ID}}}",f),"g"),o=Array.from(m).filter(function(a){return n.test(a)});if(o.length){var p,q,r,s=o[0].replace(/"?videoData"?:/,"");try{p=JSON.parse(s)[0]}catch(t){if(r=s.match(k),!r.length)return null;q=r.map(function(a){return a.replace(k,"$1")})}var u=[];return p&&g.forEach(function(b){p[b]&&u.push(a(p[b],j,b))}),q&&q.length&&q.forEach(function(b,c){var d="sd_src";r.forEach(function(a){a.includes(b)&&(d=a.includes("hd_")?"hd_src":"sd_src")}),u.push(a(b,j,d))}),u}}}});va=p("facebook",function(){var a=this,b=[];if(location.host.match(d)){const g=W.queryAll(f);g.forEach(function(d){const f=d.src;if(f&&e.test(f)){const g=c(d);b.push(a.makePlayer(d,[g],m))}})}return b})}();var wa;!function(){function a(a){for(var b,c=[],d=[],e=/"stream_h264_(|ld_|hq_|hd_|hd1080_)url":"(http.*?)"/g;b=e.exec(a);)d.push(b[0]);if(0===d.length)return c;d=JSON.parse("{"+d.join(",")+"}");var g=a.match(/<title>(.*?)<\/title>/);return g&&(g=g[1].trim()),Object.keys(d).forEach(function(a){var b=d[a];if(b){var e=U.parse(b);e.ext="mp4",e.type="video",e.quality=quality.getDailymotionQuality(f[a]),g&&(e.title=g),c.push(e)}}),c}const b=/^https?:\/\/(?:www\.)dailymotion\.com\/embed\/video\/([a-z0-9]+)/i,c=/"videoId":"([a-z0-9]+)"/i,d=/^#video=([a-z0-9]+)/i,e='param[name="flashvars"][value*="dailymotion.com"], iframe[src*="http://www.dailymotion.com/embed/video/"], embed[src*="http://www.dailymotion.com/embed/video/"]',f={stream_h264_url:"sd",stream_h264_ld_url:"ld",stream_h264_hq_url:"hq",stream_h264_hd_url:"hd",stream_h264_hd1080_url:"hd1080"},g=o({request:{method:"GET",url:function(a){return"http://www.dailymotion.com/embed/video/"+a}},parse:function(b,c){return a(c)}});wa=p("dailymotion",function(){var a,f=this,h=[],i=[],j=W.queryAll(e);if(j.forEach(function(d){var e,j,k=!1;"PARAM"===d.tagName?(e=c,j=decodeURIComponent(d.value)):(e=b,j=d.src,k=!0);var l=j.match(e),m=l&&l[1];if(m&&-1===i.indexOf(m)){i.push(m);var n=f.makePlayer(d,[m],g);h.push(n),(k||!a)&&(a=n)}}),"www.dailymotion.com"===location.host){var k=location.hash.match(d)||location.href.match(b),l=k&&k[1];if(l&&-1===i.indexOf(l))if(a)a.ids.push(l);else{var m=f.makePlayer(null,[l],g);h.push(m)}}return a&&(this._ids!==a.ids&&(a.ids=W.unique(a.ids.concat(this._ids))),this._ids=a.ids),h},{dynamic:!0})}();var xa;!function(){const a=o({nocache:!0,parse:function(a){return sa.getMoviesById(a)}}),b=o({request:{method:"GET"},parse:qa.parsePlaylist});xa=p("vietgiaitri",function(){var c=this,d=[],e=location.href.match(/vietgiaitri\.com\/.*id\.([^\.]+)\.vgt/i),f=(e||[])[1];if(f){var g=W.query("object#youtube");d.push(this.makePlayer(g,[f],a))}return location.host.match(/vietgiaitri\.com/i)&&W.queryAll('embed[src*="vietgiaitri.com"]').forEach(function(a){var e=qa.extract(a);e&&d.push(c.makePlayer(a,[e],b))}),d})}();var ya;!function(){function a(a){a=a||{};try{var f;switch(a.tagName){case"IFRAME":f=a.src.match(b);break;case"PARAM":f=a.getAttribute("value").match(e);break;default:f=location.pathname.match(d)}return(f||[])[1]}catch(g){return c}}const b=/https?:\/\/clip\.vn\/embed\/([0-9a-z_-]+)/i,d=/\/watch\/[^,]+,([0-9a-z_-]+)\/?$/i,e=/(?:^|&)id=([0-9a-z_-]+)/i,f=/([^.]+\.)*clip\.vn/i,g=o({request:{method:"POST",url:function(a){return"http://clip.vn/movies/nfo/"+a},params:function(){return{referrer:encodeURIComponent(btoa(location.href)),onsite:"clip"}},headers:function(){return{"X-REFERRER":location.href,"Content-type":"application/x-www-form-urlencoded"}}},parse:function(a,b){var c=W.xmlParser.parseFromString(b,"text/xml"),d=c.querySelector("ClipInfo title"),e=W.queryAll("ClipInfo enclosure",c).map(function(a){var b=a.getAttribute("url"),c=U.parse(b),e=a.getAttribute("quality");return c.type="video",d&&(c.title=d.textContent),c.quality=quality.getClipvnQuality(e),c});return e}});ya=p("clipvn",function(){function b(a,b){a&&-1===e.indexOf(a)&&(e.push(a),d.push(c.makePlayer(b,[a],g)))}var c=this,d=[],e=[];location.hostname.match(f)&&b(a(),W.query("#player_wrapper object"));var h=W.queryAll('param[name="flashvars"][value*="clip.vn"], iframe[src*="clip.vn"]');return h.forEach(function(c){b(a(c),c)}),d})}();var za;!function(){function c(a){try{return M.AES.decrypt({ciphertext:M.enc.Hex.parse(a),salt:""},M.enc.Utf8.parse(h),{iv:M.enc.Utf8.parse(i),mode:M.mode.CBC,padding:M.pad.NoPadding}).toString(M.enc.Utf8)}catch(b){return""}}function e(a){return M.AES.encrypt(M.enc.Utf8.parse(a),M.enc.Utf8.parse(h),{iv:M.enc.Utf8.parse(i),mode:M.mode.CBC,padding:M.pad.NoPadding}).ciphertext.toString(M.enc.Hex)}function f(b){var c=new Z;return W.get(location.href,{"X-Savior-Replace-User-Agent":"Mozilla/5.0 (iPhone; CPU iPhone OS 8_0 like Mac OS X) AppleWebKit/600.1.3 (KHTML, like Gecko) Version/8.0 Mobile/12A4345d Safari/600.1.4"}).done(function(d){for(var e,f=/<source\s+src="([^"]+)"([^>]+type="([^"]+)")?([^>]+data-res="([^"]+))?"/gi,g=[];e=f.exec(d);){var h=U.parse(e[1]);h=W.detectMediaTypeAndExt(h,e[3]),h.quality=a.quality.getQualityBySize(+e[5]),h.title=b,h.size=null,g.push(h)}c.resolve(g)}),c}function g(a){var b=[];a.data;if(!a||!a.data||!a.data)return b;var c="undefined"!=typeof a.data.item?a.data.item:a.data;return c.forEach(function(a){var c=a.source_list.filter(function(a){return!!a});const d="undefined"!=typeof a.thumbnail?"video":"audio";c.forEach(function(c){var e=U.parse(c);e.type=d,e.title=a.title||a.artist+" - "+a.name,e.ext="audio"===d?"mp3":"mp4";var f=a.source_list.indexOf(c);e.quality=quality.getZingAudioQuality(a.qualities[f]),b.push(e)})}),b}const h="f_pk_ZingTV_1_@z",i="f_iv_ZingTV_1_@z",j=/^https?:\/\//i,k=/tv\.zing\.vn/,l=["f1080","f720","hq","f480","f360","source","f240","f"],m={f360:/source:\s"(https?:\/\/\S+)",\n?\s+label:\s?'360p'/,f480:/source:\s"(https?:\/\/\S+)",\n?\s+label:\s?'480p'/,f720:/video720\s=\s\"(https?:\/\/\S+)";/},n=o({request:{method:"GET"},parse:function(h,i){var n=W.xmlParser.parseFromString(i,"text/xml"),o=[];if(W.queryAll("data > item",n).forEach(function(a){var b=a.getAttribute("type"),g=[a.querySelector("title").textContent],h=a.querySelector("performer");h&&""!==h.textContent.trim()&&g.unshift(h.textContent.trim()),g=g.join(" – "),W.toArray(a.childNodes).forEach(function(a){if(a.nodeType===Node.ELEMENT_NODE&&-1!==l.indexOf(a.tagName)){var f=a.getAttribute("type")||b,h=a.textContent;if(W.isMatches(h,j)||(h=c(h)),"require vip"!==h&&""!==h&&-1===h.indexOf("/rplaylist")&&W.isMatches(h,j)){var i=U.parse(h);if("php"===i.ext){var k=Date.now()+"|0\x00";i=U.parse(h+"&start=0&token="+e(k)),i.size=null}(T.M3U8||!d(i.ext))&&("mp3"===f?(i.type="audio",i.quality=quality.getZingAudioQuality(a.tagName)):(i.type="video",i.quality=quality.getZingVideoQuality(a.tagName)),i.ext=U.getMediaType(h)?i.ext:f,i.title=g,o.push(i))}}}),"tv.zing.vn"===location.host&&(o=f(g))}),0===o.length){var p;try{if(p=JSON.parse(i)){var q=g(p);q.length&&(o=o.concat(q))}}catch(r){}}if(a.location.host.match(k)){const s=Object.keys(m).map(function(a){return{quality:a,match:i.match(m[a])}});s.forEach(function(a){if(a.match&&a.match.length>1){const c=U.parse(a.match[1]);c.type="video",c.title=b.title,c.quality=quality.getZingVideoQuality(a.quality),o.push(c)}})}return o}});var q=/^([\d\w_-]+\.)*zing\.vn$/,r=function(a){var b=a.mp3;if(!b)return null;var c=U.parse(b);c.type="audio";var d=a.artist?a.artist+" - ":"";return c.title=d+(a.title||"").trim(),c.force=!0,c.ext="mp3",c},s=function(a){var b=a.source[0];if(!b)return null;var c=U.parse(b);c.type="audio";var d=a.artist?a.artist+" - ":"";return c.title=d+(a.title||"").trim(),c.force=!0,c.ext="mp3",c};za=p("zingvn",function(){var b=this,c=[];if(c.push(b.makePlayer(null,[this._ids]||[],n)),ea&&location.host.match(q)){var d=new Z;ea.send({method:"report",args:[["zmp3HTML5","playlist"]]}).success(function(a){return Array.isArray(a)?(a=a.map(r).filter(function(a){return a}),void d.resolve(a)):void d.resolve([])}),c.push(b.makePlayer0(null,[d]));var e=new Z;ea.send({method:"eval",args:['return [].map.call(zmCore("li[id^=\'fnPlayerItem\']"),function(el){return zmCore.data(el,"item")})']}).success(function(a){return Array.isArray(a)?(a=a.map(s).filter(function(a){return a}),void e.resolve(a)):void e.resolve([])}),c.push(b.makePlayer0(null,[e]))}return a.location.host.match(k)&&c.push(b.makePlayer(null,[a.location.href]||[],n)),c},{dynamic:!0})}();var Aa;!function(){function a(){if("www.nhaccuatui.com"!==location.hostname)return null;var a=W.query("video#videonctPlayer");if(a)return a;var b=W.queryAll('object[type="application/x-shockwave-flash"]');if(1!==b.length)return null;var c=b[0];return c.getAttribute("data").match(/flash\/player\.nct/)?c:m(c)}const c='meta[content*="flash/xml?key"], param[value*="flash/xml?key"], embed[flashvars*="flash/xml?key"]',d=/https?:\/\/[^\?]+xml\?key.*/,e=o({request:{method:"GET",headers:function(a){return{"X-Savior-Replace-Cookie":b.cookie+"; touchEnable=true;"}},method:"GET"},parse:qa.parsePlaylist});var f=/^([\w\d_-]+\.)*nhaccuatui.com$/,g=function(a){var b=a.location.replace(/^[\n\s]*|[\n\s]*$/gm,"");if(!b)return null;var c=U.parse(b);return c.type="audio",c.title=a.title.replace(/^[\n\s]*|[\n\s]*$/gm,""),c.force=!0,c.ext="mp3",c};Aa=p("nhaccuatui",function(){function b(a,b){var c=k.indexOf(a);-1!==c?l[c]||(l[c]=b):(k.push(a),l.push(b))}function h(a,b){j.push(i.makePlayer(l[b],[a],e))}var i=this,j=[],k=[],l=[];if(W.queryAll(c).forEach(function(a){var c=a.getAttribute("content")||a.getAttribute("value")||a.getAttribute("flashvars")||"",e=c.match(d),f=e&&e[0];f&&b(f,a)}),k.length&&k.forEach(h),ea&&location.host.match(f)){var m=new Z;ea.send({method:"report",args:[["__data","flashPlayer","mp3"]]}).success(function(a){return Array.isArray(a)?(a=a.map(g).filter(function(a){return a}),void m.resolve(a)):void m.resolve([])}),j.push(i.makePlayer0(null,[m]))}return j.push(this.makePlayer0(a(),this._ids,e)),j},{dynamic:!0})}();var Ba;!function(){function a(a){var b={};return a.split("&").forEach(function(a){var c=a.split("=");b[c[0]]=decodeURIComponent(c[1])}),b}function b(a){return a.replace(/&#(\d+);/g,function(a,b){return String.fromCharCode(+b)})}const c="http://nhac.vui.vn",d='param[name="flashvars"][value*="vui.vn"]',e="http://nhac.vui.vn/asx2.php?type={{type}}&id={{id}}",f=/playlistfile=([^?&]+)/i,g=/(a|m|clip)(\d+)[^-]+$/i,h={a:3,m:1,clip:1},i=o({request:{method:"GET",url:function(a){return a.match(/^https?:\/\//i)?a:c+a}},parse:function(a,c){var d=W.xmlParser.parseFromString(c,"text/xml"),e=[];return W.queryAll("item",d).forEach(function(a){try{var c=[b(a.querySelector("title").textContent)],d=a.querySelector("description");d&&(d=d.textContent.replace(/thể hiện:/i,"").trim(),""!==d&&c.unshift(d));var f=a.getElementsByTagNameNS("http://developer.longtailvideo.com/","file")[0].textContent;if(!f.match(/^https?:\/\//i))return;var g=U.parse(f);g.type="mp3"===g.ext?"audio":"video",g.title=c.join(" – "),e.push(g)}catch(h){}}),e}});Ba=p("vui",function(){var b=this,c=U.parse(location.href);if(c.host.match(/vui\.vn$/))if("html"===c.ext){var j=c.filename.match(g);if(j&&j[1]&&j[2]){for(var k=j[2],l=null,m=W.queryAll('param[name="flashvars"]'),n=m.length-1;n>=0;n--){var o=m[n];if(o.value&&-1!==o.value.indexOf(k)){l=o;break}}var c=e.replace("{{type}}",h[j[1]]).replace("{{id}}",k);return[b.makePlayer(l,[c],i)]}}else if("swf"===c.ext){var j=c.search.match(f);if(j&&j[1]){var c=decodeURIComponent(j[1]);return[b.makePlayer(null,[c],i)]}}var p=[],q=W.queryAll(d);return q.forEach(function(c){var d=a(c.value);d&&d.playlistfile&&p.push(b.makePlayer(c,[d.playlistfile],i))}),p})}();var Ca;!function(){function a(a){var b,c,d=/^https?:\/\/nhacso.net\/embed\/([^\/]+)\/(.+)/i;if(a.src){if(c=a.src.match(d),3!==c.length)return null;switch(c[1]){case"album":b=h+c[2];break;case"video":b=g+c[2];break;default:return null}}else b=a.value.replace(/^.*xmlPath=([^&]+).*$/i,"$1");return b}function b(a,b){var c=l[b];return c&&a?location.origin+c+encodeURIComponent(a):void 0}function c(a){var c=a.getAttribute("object-id"),d=a.getAttribute("object-type");return c?b(c,d):null}function d(){if(!location.host.match(i))return!1;var a=location.pathname;return 0===a.indexOf("/xem-video/")||0===a.indexOf("/nghe-playlist/")||0===a.indexOf("/nghe-album/")||0===a.indexOf("/nghe-nhac/")}const e=['param[name="flashvars"][value*="xmlPath=http://nhacso.net"]','iframe[src*="http://nhacso.net/embed"]','param[name="movie"][value*="xmlPath=http://nhacso.net"]'].join(","),f="a.play[object-type]",g="http://nhacso.net/flash/video2/xnl/1/id/",h="http://nhacso.net/flash/album/xnl/1/uid/X1xQVUNcZgQEBQ==,",i=/(\w+\.)?nhacso\.net$/,j=o({request:{method:"GET"},parse:function(a,b){var c=W.xmlParser.parseFromString(b,"text/xml"),d=[];return W.queryAll("track, song",c).forEach(function(a){try{var b=[a.querySelector("name, title").textContent],c=a.querySelector("artist");c&&""!==c.textContent.trim()&&b.unshift(c.textContent.trim());var e=a.querySelector("sourceUrl, url, mp3link").textContent,f=U.parse(e);f.type="mp3"===f.ext?"audio":"video",f.title=b.join(" – "),d.push(f)}catch(g){}}),d}}),k=o({nocache:!0,request:{method:"GET"},parse:function(a,b){var c=JSON.parse(b),d=(c.object_name||"").trim();d&&(d+=" - ");for(var e=c.songs||[],f=e.filter(function(a){return a.link_mp3}).map(function(a){}),g=0;g<e.length;g++){var h=e[g],i=h.link_mp3;if(i){var j=U.parse(i);j.type="audio",j.title=d+(h.name||"").trim(),f.push(j)}}return f}});var l={album:"/albums/ajax-get-detail-album?dataId=",playlist:"/playlists/ajax-get-detail-playlist?dataId=",song:"/songs/ajax-get-detail-song?dataId="},m=function(a){var b=a.url;if(!b)return null;var c=U.parse(b);c.type="audio";var d=a.singer[0]?a.singer[0].alias+" - ":"";return c.title=d+(a.name||"").trim(),c};Ca=p("nhacso",function(){var b=this,g=[],h=[];if(W.queryAll(e).forEach(function(c){var d=a(c);d&&-1===h.indexOf(d)&&(h.push(d),g.push(b.makePlayer(c,[d],j)))}),ea&&location.host.match(i)){var l=new Z;ea.send({method:"report",args:[["myPeakPlayer","songs"]]}).success(function(a){return Array.isArray(a)?(a=a.map(m).filter(function(a){return a}),void l.resolve(a)):void l.resolve([])}),g.push(b.makePlayer0(null,[l]))}if(!d())return g;var n=[];return W.queryAll(f).forEach(function(a){var b=c(a);b&&-1===n.indexOf(b)&&n.push(b)}),n.length>0&&g.push(b.makePlayer(null,n,k)),W.queryAll(".video-details").forEach(function(a){var c=W.query("video",a),d=c&&c.src;if(d){var e=U.parse(d);e.type="video";var f=W.query(".singer-link",a);f=f&&f.textContent.trim()||"";var h=W.query("h3.name");h=h&&h.textContent.trim()||"",f&&h&&(h=f+" - "+h),h&&(e.title=h),g.push(b.makePlayer(c,[e]))}}),g})}();var Da;!function(){Da=p("pip",function(){var b=[],c=a.pip.detector.checkPage();return c.forEach(function(a){b.push(this.makePlayer0(a,[],null))}.bind(this)),b},{dynamic:!0})}();var Ea;!function(){const b="https://api-v2.soundcloud.com/tracks?ids={{track_id}}&client_id={{client_id}}",c=function(b,c){c||(c=a.location.href),b=b.replace(/[\[\]]/g,"\\$&");var d=new RegExp("[?&]"+b+"(=([^&#]*)|&|#|$)"),e=d.exec(c);return e?e[2]?decodeURIComponent(e[2].replace(/\+/g," ")):"":null},d=o({request:{method:"GET"},parse:function(d,e){const f=new Z,g=[];var h;try{h=JSON.parse(e)}catch(i){return void f.reject([])}if(h.http_mp3_128_url){const j=U.parse(h.http_mp3_128_url),k=d.match(/soundcloud\.com\/i1\/tracks\/(\d+)\//);if(!k||!k.length)return void f.reject([]);const l=k[1],m=c("client_id",d);a.fetch(b.replace("{{track_id}}",l).replace("{{client_id}}",m)).then(function(a){return a.json()}).then(function(a){if(!a.length)return void f.reject([]);const b=a[0];j.title=b.title,j.quality="Normal",j.type="audio",g.push(j),f.resolve(g)})["catch"](function(){f.reject([])})}return f}});Ea=p("soundcloud",function(){var b=this,c=[];return a.location.pathname.replace("/","")&&c.push(b.makePlayer(null,[this._ids],d)),c},{dynamic:!0})}();var Fa;!function(){function a(a){const b=a.match(d);return b&&b.length?parseInt(b[1]):null}function c(a){return a.replace(d,"")}const d=/_([0-9]{3,4})p/,e=o({request:{method:"GET"},parse:function(d,e){const f=[];var g;try{g=JSON.parse(e)}catch(h){return f}const i=g.html5||g.mp4||[];return i.forEach(function(d){const e=U.parse(d),g=a(d);e.quality=g?quality.getQualityBySize(g):"normal",e.title=b.title,e.filename=c(e.filename),e.type="video",f.push(e)}),f}});Fa=p("kenh14",function(){const a=this,b=[];return b.push(a.makePlayer(null,[this._ids],e)),b},{dynamic:!0})}();var Ga;!function(){function c(){for(var a=b.querySelector("#main h2"),c=a.firstChild,d=[];c;)3==c.nodeType&&d.push(c.data),c=c.nextSibling;return d.join("").trim()}const d=/w?\.xvideos\.com\/video[0-9]+\//,e=o({request:{method:"GET"},parse:function(a,d){const e=new Z;return ea.send({method:"eval",args:["return [html5player.url_high, html5player.url_low]"]}).success(function(a){if(a.length){const d=a.map(function(a){const d=U.parse(a);return d.type="video",d.title=c()||b.title,d.quality=quality.getQualityBySize(a.includes("3gp")?240:480),d});e.resolve(d)}}).fail(function(a){}),e}});Ga=p("xvideos",function(){const b=[],c=this;if(location.href.match(d)&&ea){const f=W.query("#html5video");b.push(c.makePlayer(f,[a.location.href],e))}return b},{dynamic:!0})}();var Ha=function(){this._providers=[new pa,new sa,new ua,new va,new za,new Aa,new xa,new ya,new Ba,new Ca,new Da,new Ea,new Fa,new Ga]};!function(){function a(a,b){Array.prototype.push.apply(a,b)}function b(a){var b=new Z;return Z.when(a).done(function(){var a=u(),c=[];Array.prototype.concat.apply([],arguments).forEach(function(b){b&&(ba.isValidData(b)||b.force)&&(/&\w+;/.exec(b.title)&&(b.title=W.unescapeHTML(b.title)),b.referrer=b.referrer||location.href,!b.title&&a&&a.test(b)&&(b.title=a.title),c.push(b))}),b.resolve(c)}),b}Ha.prototype={constructor:Ha,processRequest:function(a){for(var b=a.name,c=0;c<this._providers.length;++c){var d=this._providers[c];if(d.name===b&&d.processRequest){d.processRequest(a.result);break}}},getMedia:function(c){var d=c||this._players;if(!d){var e=new Z;return e.reject([]),e}var f=[];d.forEach(function(b){a(f,b.getMedia())});var g=new Z;return b(f).done(function(a){if(T.SOUND_ONLY&&a.length){const b=this.createMP3Resources(a);a=a.concat(b);const c=W.splitMediaSourcesByFilename(a);var d=[];c.forEach(function(a){d=d.concat(a)}),a=d}g.resolve(a)}.bind(this)),g},createMP3Resources:function(a){function b(a){return a.filter(function(a){return"video"!==a.type?!1:"object"==typeof a.url&&a.url.audioUrl||"string"==typeof a.url})}function c(a,b){const c=parseInt(b);var d=a.filter(function(){return!0});const e=a.filter(function(a){return"mp4"===a.ext});e.length&&(d=e);const f=d.filter(function(a){return a.quality&&"full hd"===a.quality.toLowerCase()}),g=d.filter(function(a){return a.quality&&"hd"===a.quality.toLowerCase()}),h=d.filter(function(a){return a.quality&&["normal","medium","standard"].includes(a.quality.toLowerCase());
});switch(c){case 320:f.length?d=f:g.length?d=g:h.length&&(d=h);break;case 128:default:h.length?d=h:g.length?d=g:f.length&&(d=f)}const i=d.filter(function(a){return"object"==typeof a.url&&a.url.audioUrl});return i.length&&(d=i),d[0]}const d=b(a),e=["128 kbps","320 kbps"];var f=[];if(!d.length)return f;const g=W.splitMediaSourcesByFilename(d);return g.forEach(function(a){const b=e.map(function(b){const d=c(a,b),e=Object.assign({},d);return e.url=e.url.audioUrl||e.url,e.ext="mp3",e.soundOnly=!0,e.quality=b,e});f=f.concat(b)}),f},getMediaForPlayer:function(a){return b(a.getMedia())},getMediaPlayers:function(){var b=[];return this._providers.forEach(function(c){a(b,c.getMediaPlayers())}),this._players=b,b}}}();var Ia=[r({hosts:["ustream.tv"]},/^ustream.tv\/recorded\/([0-9]+)/i,"#ViewerContent h2"),r({hosts:["yan.vn"]},/^yan\.vn/i,'title, [role="complementary"] h3'),r({hosts:["vcdn.vn",".googlevideo.com","docs.google.com"]},/^phim22\.com/i,"title"),r({hosts:["olivia24.com"]},/^olivia24\.com/,"h1.visible-lg.visible-md"),r({},/vipphim\.net/,"title"),r({},/kenh14\.vn/,"h1.title"),r({},/vtv\.vn/,"h1.news-title,h1.video-title"),r({},/dantri\.com\.vn/,"#video-title"),r({hosts:[".memeclip.com"]},/nguoiduatin\.vn/,"title"),s(/^phim3s.net\/phim/i,"h2.title a",".serverlist .server li a.active"),s(/^thegioiphim\.eu\/movie-episode-full\.php/i,".category-main"),s(/^hayghe\.com\/xem-phim/i,"#tit_player"),s(/^phim14\.net\/xem-phim/i,".blocktitle h1 a",".server_item .active a"),s(/^phimnhanh\.net\/movie/i,"h1 > a",".epicurrent"),s(/^xemnghe\.com\/phim/i,"h1"),s(/^phimhd\.vn\/xem-phim/i,"h1.title","a.playing"),t(/^phimmoi\.net\/phim/i,".episode-link.active"),t(/^phimtv\.vn\/xem-phim/i,"a.playing"),r({hosts:["203.162.121.25:88","110.164.180.35","130.211.247.87"]},/^m-viet\.com/i,"h1"),r({hosts:["memeclip.com"]},/^meme\.vn/i,"h1"),r({hosts:["memeclip.com"]},/^doisongphapluat\.com/,"title"),t(/phim/i)],Ja=/^((xem )?phim)|(video:)/i,Ka=/(-? picasaweb( \d+)?)|(\| server .*)?$/i,La=/^https?:\/\/(www\.)?/i,Ma=function(){};Ma.prototype={constructor:Ma,_sendMessage:function(a,b,c){chrome.runtime.sendMessage({requestType:"cache",method:a,params:b},c)},get:function(a){var b=new Z;return this._sendMessage("get",{key:a},function(a){b[a.success?"resolve":"reject"](a.data)}),b},put:function(a,b,c){this._sendMessage("put",{key:a,value:b,ttl:c})},"delete":function(a){this._sendMessage("delete",{key:a})},proxy:function(a,b,c,d){var e=this,f=new Z;return this.get(b+d).success(f.resolve.bind(f)).fail(function(){var g=new Z(c.call(a,d));g.success(function(a){e.put(b+d,a)}).done(function(a){f.resolve(a)})}),f}},v.prototype={processRequest:function(a,b){var c=this;switch(a){case"created":c._onCreated(b);break;case"erased":delete c._data[b];break;case"changed":c._onChange(b)}},_sendMessage:function(a,b,c){chrome.runtime.sendMessage({requestType:"downloads",method:a,params:b},c)},_onCreated:function(a){var b=this;if(a){var c=a.item.id;b._data[c]=a,b._media2id[a.mid]=c}},_onChange:function(a){var b=this,c=b._data[a.id];if(c){var d=c.item;for(var e in a)"id"!==e&&(d[e]=a[e].current);W.call(b._callbacks,b,c.mid,d,a)}},onChange:function(a,b){this._callbacks.push(b)},download:function(a,b){var c=this,d=b.id,e=new Z;return this._sendMessage("download",b,function(a){var b=a.data;a.success?(c._data[b.id]={item:b,mid:d},c._media2id[d]=b.id,e.resolve(b)):e.reject(b)}),e},item:function(a,b){var c=this,d=c._media2id[b],e=c._data[d];return e&&e.item},pause:function(a){this._sendMessage("pause",a)},resume:function(a){this._sendMessage("resume",a)},cancel:function(a){this._sendMessage("cancel",a)},open:function(a){this._sendMessage("open",a)},show:function(a){this._sendMessage("show",a)}};var Na=new v,Oa=!W.IS_CONTENT_SCRIPT;x.prototype={setDownloads:function(a){this._downloads=a},render:function(b,c,d){c.downloads=this._downloads.group(),Oa&&(c.is_only=this._downloads.isOneMedia());var e=W.query("#downloads",this._widget);e.innerHTML=Ya.render(b,c,{media_template:a.options.get("template-media")}),e.classList.add("content");var f=this.applyCurrentValues(d);if(Oa){var g=W.query(".downloads-list",this._widget);g.scrollHeight>g.offsetHeight&&(w(W.queryAll("h1",this._widget),g),g.addEventListener("scroll",this._getSizeOfVisibleMedia.bind(this),!1),W.query("#close-popup",this._widget).classList.add("pulled")),this._widget.classList.add("done")}return f},initPlayNowListener:function(){chrome.runtime.onMessage.addListener(function(a,b,c){if("downloads"===a.requestType&&"widget_progress"===a.method){const d=a.params;if(d.mime&&d.mime.includes("video")&&!d.filename.match(/\.mp3$/)){const e=d.url,f=this._widget.querySelector('a[data-url="'+e+'"]');var g;if(!f)return;g=W.nearestParent(f,"li.j-media-scope"),d.exists&&(d.playable||"complete"===d.state)?this._handleProgress(g,d):"interrupted"!==d.state&&d.exists||this._changeWidgetMode(g,"select_media")}}}.bind(this))},_handleProgress:function(a,b){var c=0;const d=a.querySelector(".play-now-btn"),e=parseInt(d.dataset.downloadId);e&&e===b.id||(d.dataset.downloadId=b.id),a.matches(".progress-mode")||(this._changeWidgetMode(a,"progress"),metrics.log("PlayNow",metrics.PLAY_NOW_SHOWN)),c="complete"!==b.state?(b.bytesReceived/b.totalBytes*100).toFixed(0)+"%":"100%";const f=a.querySelector(".progress-bar .bar");f&&(f.style.width=c);const g=W.beautifyFileSize(b.totalBytes,!0),h=W.beautifyFileSize(b.bytesReceived,!0),i=a.querySelector(".progress-box .progress-text");i&&("100%"!==c?i.innerText=h+" "+X("play_now_received_from")+" "+g:i.innerText=g);const j=a.dataset.prevReceived||0,k=W.beautifyFileSize(b.bytesReceived-j,!0),l=a.querySelector(".progress-box .speed-text");l&&("100%"!==c?l.innerHTML='<span class="green-arrow">&#129095;</span> '+k+"/"+X("play_now_per_second"):l.innerHTML=""),a.dataset.prevReceived=b.bytesReceived},_changeWidgetMode:function(a,b){a.classList.remove("progress-mode","select-mode"),a.classList.add(b+"-mode")},_checkFileSize:function(a){var b=this._downloads.getMedia(a);b&&!b.get("size")&&(metrics.log("Download",metrics.DOWNLOAD_REQUEST_SIZE),b.getSize().done(function(a){var c=W.query("#size_"+b.id(),this._widget);c&&(c.classList.add("done"),c.textContent=b.size(),a||metrics.log("Download",metrics.DOWNLOAD_REQUEST_SIZE_FAILED))}.bind(this)))},_applyCurrentValues:function(a){var b=a.querySelector(".j-quality-selector"),c=b.value;W.queryAll(".j-quality-option, .j-quality-download",a).forEach(function(a){a.hidden=a.dataset.quality!==c,Oa||a.hidden||!a.classList.contains("j-quality-download")||this._checkFileSize(a.dataset.id)},this),Oa&&this._getSizeOfVisibleMedia()},applyCurrentValues:function(a){var b=this._downloads,c=options.get("prefer_last_quality")&&options.get("preferred_quality:"+a),d=W.queryAll(".j-media-scope",this._widget);return d.forEach(function(d){var e=W.queryAll(".j-quality-download",d);if(e.length>1){var f=e.map(function(a){return a.dataset.id}),g=quality.chooseBestDownload(b.getMediaGroup(f),a,c),h=W.query(".j-quality-selector",d);h&&(h.value=g.extQuality())}this._applyCurrentValues(d)},this),d},_getSizeOfVisibleMedia:function(){for(var a=W.query(".downloads-list",this._widget),b=a.scrollTop,c=a.offsetHeight,d=W.queryAll(".j-quality-download:not([hidden])",a),e=0,f=d.length;f>e;++e){var g=d[e];if(g.offsetTop>b+c+10)break;this._checkFileSize(g.dataset.id)}},getMetricsParams:function(a,b){var c=a instanceof Node?a.dataset.id:a,d=this._downloads,e=d.getMedia(c),f=b||{},g=d.getAllMediaFormats(c),h=[];for(var i in g)h.push(i+":"+g[i].join("|"));var i=e.ext?e.ext():"unknown";return f.size=e.quality?quality.getSizeByQuality(e.quality()):0,f.ext=i,f.same_size_exts=d.getSameQualityMediaFormats(c).join("|"),f.same_ext_sizes=d.getSameFormatMediaQuality(c).join("|"),f.total=h.join(","),f},download:function(a){return a.classList.contains("j-disabled")?void 0:(a.classList.add("j-disabled"),a.classList.add("btn-progress"),this._downloads.download(a.dataset.id).success(function(){a.classList.remove("btn-progress"),a.classList.add("btn-started")}).fail(function(b){a.classList.remove("btn-progress"),a.classList.remove("j-disabled")}))}};var Pa=function(a,b){N.apply(this,arguments),this._widget=y("div","downloads"),this._node=a,this._mode="select_media",this._downloadingId=-1,this._logShownSent=!1,this._userInitiated=!1,this._ready=!1,this._make_action=c,this._rendered=!1,this._hasDownloadLinks=!1,this._isFirstFreeNode=b};Pa.prototype={constructor:Pa,__proto__:N.prototype,_init:function(a){this._widget=a,this._setPreferredQuality(options.get("preferred_quality_level")),this._widget.addEventListener("click",this._onWidgetClick.bind(this),!1),this._widget.addEventListener("change",this._onSelectChange.bind(this),!1),chrome.runtime.onMessage.addListener(function(a,b,c){if("downloads"===a.requestType&&"widget_progress"===a.method){const d=a.params,e=this._getWidgetMedialURLs();e.includes(d.url)&&d.mime&&d.mime.includes("video")&&!d.filename.match(/\.mp3$/)&&(d.exists&&(d.playable||"complete"===d.state)?(this._downloadingId=d.id,this._handleProgress(d)):"interrupted"!==d.state&&d.exists||this._changeWidgetMode("select_media"))}}.bind(this))},_renderWidget:function(){if(!this._rendered){var b=!S.check(location.href,"pip");b=b&&a.pip.detector.isVideoNode(this._node),b=b||location.host.match(/^([\w\d_-]+\.)*youtube.com$/),b=b&&a.options.get("detach_enabled"),b&&a.pip.detector.markCandidate(this._node),this._widget.innerHTML=Ya.render(a.options.get("template-widget"),{i18n_download:X("popup_download"),i18n_pip_button:X("popup_pip_button"),i18n_play_now:X("play_now_play_now"),i18n_play_text:X("play_now_click_to_play"),i18n_play_not_show:X("play_now_do_not_show"),has_pip:b,no_downloads:!this._player||!this._player.ids.length}),this._dl=new x(this._widget),this._dl.setDownloads(new ca),this._rendered=!0,this._init(this._widget)}},attach:function(a){this._renderWidget();var b=a.firstChild;b?b!==this._widget&&a.replaceChild(this._widget,b):a.appendChild(this._widget),this._updateDownloads(),this._userInitiated=!1},_setPreferredQuality:function(a){if(a=a||quality.DEFAULT_QUALITY_LEVEL,!this._userInitiated&&this._preferredQuality!==a){var b=W.query("#preferred-select",this._widget);b&&(this._preferredQuality=a,b.value=a,b.innerText=X("popup_preferred_quality_hint")+" "+X("ql_"+a.toLowerCase()))}},_updateDownloads:function(){if(!this._player||!this._userInitiated)return void this._setPreferredQuality(options.get("preferred_quality_level"));var a=this._manager._players.filter(function(a){return(a.node===this._node||this._isFirstFreeNode&&null===a.node)&&a.scraper&&a.ids.length&&!a.opts.aggressive}.bind(this));if(a.length){var b=this._dl._downloads.setMediaData(this._manager.getMedia(a));b.done(function(){this._showDownloads.apply(this,arguments)}.bind(this))}this._userInitiated=!1},_showDownloads:function(a,b){if(b){var c=this._widget,d=a.getMediaCount(),e=W.query("#showhide-all",c);if(0===d&&!this._hasDownloadLinks)return c.className="downloads-empty",e.textContent=e.title=X("popup_no_media_found"),void metrics.log("PageShown",metrics.PAGE_CONTENT_NO_MEDIA);c.className=d>1?"downloads-multi":"downloads-single main",e.textContent=X("popup_how_many_media_found",[d]),z(this),this._updateButtonsStatus()}},_updateButtonsStatus:function(){if(this._rendered){var a=this._player&&this._player.ids.length;this._widget.querySelector(".main-panel")[a?"removeAttribute":"setAttribute"]("hidden",!0);const b=this._widget.querySelector("#downloads");a&&"progress"!==this._mode?b.removeAttribute("hidden"):b.setAttribute("hidden","hidden"),a&&!this._hasDownloadLinks&&(this._hasDownloadLinks=!0)}},_onClick:function(a){var b=this,c=a.target;switch(c.id){case"download-main":case"preferred-select":if(!b._userInitiated){c.setAttribute("disabled",!0);var d="preferred-select"===c.id;b._make_action=d?"select":"download",b._userInitiated=!0,metrics.log("ButtonClicked",d?metrics.BUTTON_FAKE_QUALITY:metrics.BUTTON_MAIN),c.innerHTML='<span class="file-size data-loading"></span>',b._updateDownloads()}return;case"showhide-all":var e=W.query("#downloads",b._widget);if(e){var f=!e.hidden;e.hidden=f,metrics.log("ButtonClicked",f?metrics.BUTTON_HIDE_DOWNLOADS:metrics.BUTTON_SHOW_DOWNLOADS)}return;case"download-selected":return metrics.log("ButtonClicked",metrics.BUTTON_DOWNLOAD_ALL),W.queryAll(".j-media-scope.selected",b._widget).forEach(function(a){b._download(W.query(".j-quality-download:not([hidden])",a))&&metrics.log("Download",metrics.DOWNLOAD_ALL)}),void b._updateDownloadSelected();case"check-all":return metrics.log("ButtonClicked",metrics.BUTTON_CHECK_ALL),void b._toggleSelectMedia(W.queryAll(".j-media-scope",b._widget),!0);case"check-none":return metrics.log("ButtonClicked",metrics.BUTTON_CHECK_NONE),void b._toggleSelectMedia(W.queryAll(".j-media-scope",b._widget),!1);case"open-pip":return metrics.log("ButtonClicked",metrics.BUTTON_DETACH),void pip.detachPlayerOrNode(this._player);case"hide-widget":return metrics.log("ButtonClicked",metrics.BUTTON_HIDE),b._hideWidget(),void b.emit("hide");case"play-now":return void(-1!==this._downloadingId&&(chrome.runtime.sendMessage({method:"play",requestType:"downloads",params:this._downloadingId}),metrics.log("PlayNow",metrics.PLAY_NOW_WIDGET_CLICKED)));case"close-play-now-tooltip":const g=this._widget.querySelector(".tooltip-box");g&&(g.classList.remove("tooltip-shown"),metrics.log("PlayNow",metrics.PLAY_NOW_TOOLTIP_CLOSED))}switch(c.tagName){case"LI":if(c.classList.contains("j-media-scope")){var h=!c.classList.contains("selected");return void b._toggleSelectMedia(c,h)}break;case"A":case"SPAN":var i=c;return"SPAN"===c.tagName.toUpperCase()&&(i=c.parentNode),i.classList.contains("j-quality-download")?void(b._download(i)&&(metrics.log("Download",metrics.DOWNLOAD_BUTTON),this.serverLogDownload(i,{autoselect:0}),b._updateDownloadSelected())):!0;case"SELECT":return;case"INPUT":if("checkbox"===c.type){if(c.matches("#play-now-not-show-check"))return this._doNotShowTooltipAgain(a.target.checked),!0;var j=W.findParent(c,"j-media-scope");return j&&b._toggleSelectMedia(j,c.checked),!0}}return!0},_doNotShowTooltipAgain:function(b){a.options.set("hide_play_now_tooltip",b),b&&metrics.log("PlayNow",metrics.PLAY_NOW_TOOLTIP_NOT_SHOW_AGAIN)},_onSelectChange:function(a){var b=a.target;if("SELECT"===b.tagName){if("quality-level-selection"===b.id);else{var c=b.value.trim(),d=c.split("/")[1];if(options.get("prefer_last_quality")&&1===W.queryAll(".j-media-scope",this._widget).length){var e=quality.getQualityLevelByQualityType(d);options.set("preferred_quality_level",e),options.set("preferred_quality:"+e,c)}var f=W.findParent(b,"j-media-scope");this._dl._applyCurrentValues(f),metrics.log("VideoQualityChanged",quality.getVideoQualityIndex(d)),this._updateDownloadSelected()}return!1}},_onWidgetClick:function(a){return this._onClick(a)?void 0:(a.preventDefault(),a.stopPropagation(),!0)},_toggleSelectMedia:function(a,b){function c(a){a.classList.toggle("selected",b),W.query('.filename [type="checkbox"]',a).checked=b}Array.isArray(a)?a.forEach(c):c(a),this._updateDownloadSelected()},_updateDownloadSelected:function(){var a=!0;W.queryAll(".j-media-scope.selected",this._widget).some(function(b){return W.query(".j-quality-download:not([hidden]):not(.j-disabled)",b)?(a=!1,!0):void 0}),W.query("#download-selected",this._widget).classList.toggle("disabled",a)},_getMetricsParams:function(a,b){return this._dl.getMetricsParams(a,b)},_download:function(a){return!!this._dl.download(a)},_hideWidget:function(){this._widget.setAttribute("hidden","hidden")},_handleProgress:function(a){var b=0;"select_media"===this._mode&&(this._changeWidgetMode("progress"),this._logShownSent||metrics.log("PlayNow",metrics.PLAY_NOW_SHOWN)),b="complete"!==a.state?(a.bytesReceived/a.totalBytes*100).toFixed(0)+"%":"100%";const c=this._widget.querySelector(".progress-box .percent");c&&(c.innerText=b);const d=this._widget.querySelector(".progress-bar .bar");d&&(d.style.width=b)},_changeWidgetMode:function(a){this._mode!==a&&(this._mode=a,this._updateUIMode(this._mode),Xa._controls.playNowBottomTooltip&&Xa._controls.playNowBottomTooltip["progress"===this._mode?"show":"hide"]())},_updateUIMode:function(b){const c=this._widget.querySelector(".main-panel"),d=this._widget.querySelector(".play-and-progress-box"),e=this._widget.querySelector("#downloads"),f=this._widget.querySelector(".progress-bar .bar"),g=this._widget.querySelector(".tooltip-box");switch(b){case"select_media":d.setAttribute("hidden","hidden"),c.removeAttribute("hidden"),e.removeAttribute("hidden"),g.classList.remove("tooltip-shown");break;case"progress":if(f.style.width=0,c.setAttribute("hidden","hidden"),e.setAttribute("hidden","hidden"),d.removeAttribute("hidden"),!a.options.get("hide_play_now_tooltip")){const h=500;setTimeout(function(){g.classList.add("tooltip-shown"),metrics.log("PlayNow",metrics.PLAY_NOW_TOOLTIP_SHOWN)}.bind(this),h)}}},_getWidgetMedialURLs:function(){var a=[];try{a=this._dl._downloads.data.map(function(a){return a.url()})}catch(b){}return a},setMediaData:function(a,b){this._manager=a,this._player=b,(null===this._widget.parentNode||this._widget.parentNode.hidden||!this._hasDownloadLinks)&&(this._ready=!0,this._updateDownloads(),this._updateButtonsStatus())},isReady:function(){return this._ready},getDetachBtnRect:function(){var a=this._widget&&this._widget.querySelector(".pip-btn");return a?a.getBoundingClientRect():null},serverLogDownload:function(a,b){b=Object.assign(b,this._getMetricsParams(a)),metrics.serverLog("Download",b)},getWidgetPlayerName:function(){return this._player.name}},A.prototype={STATE:{VIRGIN:0,CLOSED_POPUP:1,USED_PIP:2,CLOSED_TIP:3,REATTACHED:4},BLOCK_POSITION:{CORRECTION_LEFT:24,CORRECTION_TOP:26,MIN_FROM_TOP:10},_initDom:function(){if(!this.node){var c=b.createElement("div");c.innerHTML=Ya.render(a.options.get("template-pip-tour-try"),{i18n_title:X("pip_tour_title"),i18n_content:X("pip_tour_content"),i18n_img_cls:X("pip_tour_image_class"),i18n_try_now:X("pip_tour_try_btn")}),this.node=c.firstElementChild,c.innerHTML=Ya.render(a.options.get("template-pip-tour-restore"),{i18n_restore_tip:X("pip_tour_restore_tip")}),this.restoreNode=c.firstElementChild,this.restoreNode.style.zIndex=Number.MAX_SAFE_INTEGER-1,this.closeClicked=this._closeClicked.bind(this),this.closeRestoreClicked=this._closeRestoreClicked.bind(this),this.tryClicked=this._tryClicked.bind(this),this.tabDetached=this._tabDetached.bind(this),this.tabRestored=this._tabRestored.bind(this),this.adjustPosition=this._adjustPosition.bind(this),this._addListeners(),this.tourState>this.STATE.VIRGIN&&(this.processPlayers=W.noop)}},_addListeners:function(){var b=this.node.querySelector(".close-dialog-button"),c=this.node.querySelector(".try-now"),d=this.restoreNode.querySelector(".close-dialog-button");b.addEventListener("click",this.closeClicked),d.addEventListener("click",this.closeRestoreClicked),c.addEventListener("click",this.tryClicked),pip.on("tab_detached",this.tabDetached),pip.on("tab_restored",this.tabRestored),a.addEventListener("resize",this.adjustPosition)},_adjustPosition:function(){if(this.currentPlayer){var a=this.widget.getDetachBtnRect();if(a){this.node.style.left=Math.floor(a.right+this.BLOCK_POSITION.CORRECTION_LEFT)+"px";var b=Math.floor(a.top-this.BLOCK_POSITION.CORRECTION_TOP);b=b<this.BLOCK_POSITION.MIN_FROM_TOP?this.BLOCK_POSITION.MIN_FROM_TOP:b,this.node.style.top=Math.floor(b)+"px"}}},_tabDetached:function(){this.hide(),this.bumpTourState(this.STATE.USED_PIP),this.tourState<this.STATE.CLOSED_TIP&&this.showRestoreTip()},_tabRestored:function(){this.hide(),this.hideRestoreTip(),this.bumpTourState(this.STATE.RESTORED)},_closeClicked:function(){this.hide(),this.bumpTourState(this.STATE.CLOSED_POPUP)},_closeRestoreClicked:function(){this.hideRestoreTip(),this.bumpTourState(this.STATE.CLOSED_TIP)},_tryClicked:function(){this.currentPlayer&&pip.detachPlayerOrNode(this.currentPlayer),this.hide(),this.bumpTourState(this.STATE.USED_PIP)},bumpTourState:function(a){var b=options.get("pip_tour_state");(!b||a>b)&&(options.set("pip_tour_state",a),this.tourState=a)},hide:function(){this.node&&(this.overlayCtl.cancelForced(),this.node.style.display="none",this.currentPlayer=null)},show:function(a){this.node&&options.get("on_page_buttons")&&(this.currentPlayer=a,this.widget=this.overlayCtl.forceShow(a.node),this.widget.on("hide",this._closeClicked.bind(this)),this.node.style.display="block",setTimeout(this.adjustPosition,100))},hideRestoreTip:function(){this.restoreNode.style.display="none"},showRestoreTip:function(){this.restoreNode.style.display="block"},attach:function(a){this._initDom(),a.appendChild(this.node),a.appendChild(this.restoreNode)},processPlayers:function(a,b){if(this.tourState>this.STATE.VIRGIN)return void(this.currentPlayer&&this.hide());if(location.host.match(/([\w\d-]+\.)*youtube.com$/i)){if(!location.pathname.match(/\/watch/))return void this.hide();for(var c=0;c<b.length;c++){var d=b[c];if("youtube"===d.name&&d.node&&d.node!==this.currentTarget){this.show(d);break}}}}},B.prototype={constructor:B,init:function(){if(!this.node){const c=b.createElement("div");c.innerHTML=Ya.render(a.options.get("template-tooltip-play-now-bottom"),{i18n_play_now:X("play_now_play_now"),i18n_play_text:X("play_now_click_to_play"),i18n_play_not_show:X("play_now_do_not_show")}),this.node=c.firstElementChild,this._addListeners(),chrome.runtime.onMessage.addListener(function(a){"widget"===a.requestType&&"new_download"===a.method&&this._processNewDownload()}.bind(this))}},_addListeners:function(){this.node.addEventListener("click",function(a){switch(a.target.id){case"close-play-now-tooltip-bottom":this.hide();break;case"play-now-not-show-check-bottom":const b=a.target.checked;options.set("hide_play_now_tooltip_bottom",b),b&&metrics.log("PlayNow",metrics.PLAY_NOW_TOOLTIP_BOTTOM_NOT_SHOW_AGAIN)}}.bind(this))},_processNewDownload:function(){this.isShown&&this.hide()},attach:function(a){a.appendChild(this.node),setTimeout(function(){this.node.removeAttribute("hidden")}.bind(this),0)},show:function(){options.get("hide_play_now_tooltip_bottom")||(this.node.classList.add("tooltip-shown"),this.isShown=!0,this._notifyBgScript(),metrics.log("PlayNow",metrics.PLAY_NOW_TOOLTIP_BOTTOM_SHOWN))},_notifyBgScript:function(){chrome.runtime.sendMessage({requestType:"downloads",method:"bottom_tooltip_shown"})},hide:function(){this.node.classList.remove("tooltip-shown"),this.isShown=!1,metrics.log("PlayNow",metrics.PLAY_NOW_TOOLTIP_BOTTOM_CLOSED)}};const Qa=1500,Ra=50,Sa=26;J.prototype={reset:function(){this._nodesToMedia=new Map},findEntry:function(a,b){if(b)return this._nodesToMedia.get(a);for(var c=this._nodesToMedia.entries(),d=c.next();!d.done;d=c.next())if(d.value[0]===a||D(d.value[0],a)||d.value[1].coverNodesSet&&d.value[1].coverNodesSet.has(a))return{node:d.value[0],widget:d.value[1].widget};return null},setMediaPlayers:function(a,b){var c=0,d=[];b=this._removeEmptyPlayers(b),b=this._overlayCase(b);var e=this._getNotPipNodes(b);b=this._filterDescendant(b,e),b.forEach(function(b){var e=b.node;if(!e)return void(b.ids.length&&d.push(b));b.ids.length||this.nodeWithoutPlayer&&this._isNodeStillExist(this.nodeWithoutPlayer)||(this.nodeWithoutPlayer=e),this._nodesToMedia.forEach(function(a,b){e!==b&&(b.contains(e)||e.contains(b))&&this._nodesToMedia["delete"](b)}.bind(this));var f=this._nodesToMedia.get(e),g=f?f.widget:null,h=this._getTopCoverNodesSet(e);g?h.size&&(f.coverNodesSet=h):(g=new Pa(e,e===this.nodeWithoutPlayer),this._nodesToMedia.set(e,{widget:g,coverNodeSet:h}),++c),g.setMediaData(a,b)}.bind(this));var f=this._nodesToMedia.get(this.nodeWithoutPlayer);return f=f?f.widget:null,this.nodeWithoutPlayer&&f&&d.forEach(function(b){var c=f.getWidgetPlayerName();(b.name===c||"pip"===c&&!b.opts.aggressive)&&(b.node=b.node?b.node:this.nodeWithoutPlayer,f.setMediaData(a,b))}.bind(this)),!!c},_removeEmptyPlayers:function(a){return a.filter(function(a){return a.node||a.ids.length})},_getNotPipNodes:function(a){return a.filter(function(a){return"pip"!==a.name&&a.node}).map(function(a){return a.node})},_filterDescendant:function(a,b){return a.filter(function(a){var c=a.node;return!("pip"===a.name&&(-1!==b.indexOf(c)||this._checkDescendant(b,c)))}.bind(this))},_checkDescendant:function(a,b){var c=!1;return a.forEach(function(a){(a.contains(b)||b.contains(a))&&(c=!0)}),c},_getTopCoverNodesSet:function(a){var c=new Set,d=a.getBoundingClientRect(),e=d.width,f=d.height,g=[{x:d.left+e/4,y:d.bottom-f/4},{x:d.left+e/4,y:d.bottom-.75*f},{x:d.left+.75*e,y:d.bottom-.75*f}];return g.forEach(function(d){var e=b.elementFromPoint(d.x,d.y);e!==a&&c.add(e)}),c},_overlayCase:function(a){var b=[];return a.forEach(function(a){var c=a.node;c&&(c.parentNode instanceof Node&&c.parentNode.matches("object")&&(c=c.parentNode),(location.host.match(/^([\w\d_-]+\.)*fptplay.net$/)&&c.matches("object")||location.host.match(/^([\w\d_-]+\.)*vnexpress.net$/)&&c.matches("video#media-video, video.video-js")||location.host.match(/^([\w\d_-]+\.)*nhaccuatui.com$/)&&c.matches("video#videonctPlayer"))&&(a.node=c.parentNode)),b.push(a)}),b},_isNodeStillExist:function(a){for(var c=a,d=!1;parent=c.parentNode;){if(parent===b){d=!0;break}c=parent}return d}};var Ta=function(){this._nodes=new Set([]),S.check(a.location.href,"pip")&&(this.checkPage=W.noop)};Ta.prototype={_MARK_PIP_NODES_:!1,MIN_PROPORTION:1,MAX_PROPORTION:3,MEDIA_SELECTOR:"embed, object, iframe, video",FULLSCREENABLE_NODES_SELECTOR:'embed[allowfullscreen="true"], iframe[allowfullscreen], video',_getMediaSize:function(a){return a.offsetWidth*a.offsetHeight},_isVideoProportion:function(a,b){return a>=b*this.MIN_PROPORTION&&a<=b*this.MAX_PROPORTION},_isLargeEnough:function(a,b){return a>240},_isChildOf:function(a,b){for(var c=!1;a&&a.tagName&&"body"!==a.tagName.toLowerCase();){if(b.has(a)){c=!0;break}a=a.parentNode}return c},_isBanned:function(a){var b=!1,c=a.querySelector("embed");return c&&(b=S.check(c)),b||S.check(a)},_isFullscreenable:function(a){var b=!a.matches(this.MEDIA_SELECTOR)&&W.queryAll(this.MEDIA_SELECTOR,a),c=b&&b.reduce(function(a,b){return a||this._isFullscreenable(b)}.bind(this),!1);if(c)return!0;if(a.matches(this.FULLSCREENABLE_NODES_SELECTOR)||S.check(a,"pip-allowfullscreen-false"))return!0;if("OBJECT"===a.tagName){var d=W.queryAll('param[value="true"]',a).filter(function(a){return a.name&&"allowfullscreen"===a.name.toLowerCase()});return!!d.length}return!1},isVideoNode:function(a){var b=W.dom.getEmbedSize(a),c=b.width,d=b.height;return this._isLargeEnough(c,d)&&this._isVideoProportion(c,d)&&this._isFullscreenable(a)&&this._isVideoNodeContainsSource(a)&&!this._isBanned(a)},_isVideoNodeContainsSource:function(a){return"video"===a.tagName.toLowerCase()?!(!a.attributes.src&&!a.querySelector("source")):!0},_findVideos:function(){if(!S.check(location.href,"pip"))for(var a,b=W.queryAll(this.MEDIA_SELECTOR),c=0,d=b.length;d>c;c++){a=b[c];var e=a.querySelector("embed");this._isChildOf(a,this._nodes)||e&&this._isChildOf(e,this._nodes)||!this.isVideoNode(a)||a.dataset.linkSaviorIgnore||this._nodes.add(a)}},markCandidate:function(a){if(this._MARK_PIP_NODES_&&!a.__hasOverlay){var c=W.dom.getOffset(a),d={position:"absolute",background:"linear-gradient(135deg, #000 25%, transparent 25%) -50px 0,linear-gradient(225deg, #000 25%, transparent 25%) -50px 0,linear-gradient(315deg, #000 25%, transparent 25%),linear-gradient(45deg, #000 25%, transparent 25%)","background-size":"20px 20px","background-color":"#EC173A",opacity:"0.5","pointer-events":"none","z-index":Number.MAX_SAFE_INTEGER-1,top:c.top+"px",left:c.left+"px",width:a.offsetWidth+"px",height:a.offsetHeight+"px"},e=b.createElement("div");W.dom.setStyleAttr(e,d),b.body.appendChild(e),a.__hasOverlay=!0}},checkPage:function(a){return this._nodes.clear(),this._nodes=new Set(a),this._findVideos(),Array.from(this._nodes)}};var Ua=function(){N.apply(this,arguments),this.detector=new Ta,this._savedStyles=new Map,this._appliedStyles=new Map,this._observer=new MutationObserver(this._onStylePropertyChange.bind(this))};Ua.prototype={__proto__:N.prototype,PIPED_PLAYER_STYLE:{left:"0!important",top:"0!important",padding:"0!important",margin:"0!important",border:"0px none!important",width:"100%!important",height:"100%!important","min-width":"100%!important","max-width":"none!important","min-height":"100%!important","max-height":"none!important",transform:"none!important"},PLAYER_SIBLINGS_STYLE:{display:"none!important",visibility:"hidden!important",opacity:"0!important",width:"0!important",height:"0!important",margin:"0!important",padding:"0!important",border:"0px none!important",overflow:"hidden!important"},GENERATE_STACKING_CONTEXT_STYLE:{left:"0!important",top:"0!important",padding:"0!important",margin:"0!important",border:"0px none!important",width:"100%!important",height:"100%!important","min-width":"100%!important","max-width":"none!important","min-height":"100%!important","max-height":"none!important",overflow:"hidden!important",transform:"none!important"},GENERATE_STACKING_OUTER_STYLE:{"font-size":"0!important","line-height":"0!important","z-index":Number.MAX_SAFE_INTEGER-1+"!important"},FLASH_DIMENSION_PROPS:{width:"100%!important",height:"100%!important",_width:"100%",_height:"100%"},TAGS_NON_AFFECTING_LAYOUT:"head, script, style, link, meta",MUTATION_OBSERVER_CONFIG:{childList:!1,attributes:!0,characterData:!1,subtree:!1,attributeOldValue:!1,characterDataOldValue:!1,attributeFilter:["style","width","height"]},_onStylePropertyChange:function(a){var b=a.filter(function(a){var b,c,d,e=a.target,f=e.getAttribute(a.attributeName)||"",g=this._appliedStyles.get(e);switch(a.attributeName){case"style":b=W.dom.parseStyleAttr(f);for(d in g)if(b[d]!==g[d])return!0;return!1;case"width":case"height":return c="_"+a.attributeName,g[c]!==f}return!1}.bind(this)).map(function(a){return a.target});this._reApplyStyles(b)},_watchStyleChanges:function(){this._appliedStyles.forEach(function(a,b){this._observer.observe(b,this.MUTATION_OBSERVER_CONFIG)}.bind(this))},_stopWatchingStyleChanges:function(){this._observer.disconnect()},_getNodeSize:function(a){var b=W.dom.getEmbedSize(a);return{width:b.width||640,height:b.height||480}},_iterateSiblings:function(a,b){for(var c=a.parentNode&&a.parentNode.children,d=0;c&&d<c.length;d++)c[d]!==a&&b(c[d])},_nodeInDocument:function(a){for(;a&&a!==b;)a=a.parentNode;return a===b},_saveStyle:function(a){var b=a.style,c={};for(var d in b)b.hasOwnProperty(d)&&""!==b[d]&&(c[d]=a.style[d]);["OBJECT","EMBED","IFRAME"].indexOf(a.tagName.toUpperCase())>-1&&a.width&&(c._width=a.width,c._height=a.height),0!==a.scrollTop&&(c._scrollTop=a.scrollTop),this._savedStyles.set(a,c)},_restoreStyle:function(a){var b=a.style,c=this._savedStyles.get(a);if(c){for(var d in b)b.hasOwnProperty(d)&&(d in c?b[d]=c[d]:""!==b[d]&&(b[d]=""));c._width&&(a.width=c._width),c._height&&(a.height=c._height),c._scrollTop&&(a.scrollTop=c._scrollTop)}},detachPlayerOrNode:function(a){var b,c;if(!this._currentPiP){if(a instanceof HTMLElement){if(!this._nodeInDocument(a))return;c=a,b=!1}else c=a.node,b=Boolean(a.restore&&a.detach);var d,e,f=this._getNodeSize(c);if(b){if(e=a.detach(this._maximizeNode.bind(this)),!e)return;d={player:a}}else this._maximizeNode(c),d={node:c};this._currentPiP=d,chrome.extension.inIncognitoContext&&(f.incognito=!0),this.emit("tab_detached",f)}},_saveAppliedStyle:function(a,b){var c=this._appliedStyles.get(a)||{};for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);this._appliedStyles.set(a,c)},_applyStyleForNode:function(a){var b=this._appliedStyles.get(a);b&&W.dom.setStyleAttr(a,b),b._width&&(a.width=b._width),b._height&&(a.height=b._height)},_maximizeNode:function(c){var d=null,e=!1,f=this._getNodeSize(c);this._savedStyles.clear(),this._appliedStyles.clear(),this._saveAppliedStyle(c,this.PIPED_PLAYER_STYLE);var g=c.querySelector("embed");g&&(this._saveStyle(g),this._saveAppliedStyle(g,this.FLASH_DIMENSION_PROPS));for(var h=c;h&&h!==b;h=h.parentNode)if(!h.matches(this.TAGS_NON_AFFECTING_LAYOUT)){if(this._saveStyle(h),this._saveAppliedStyle(h,this.GENERATE_STACKING_CONTEXT_STYLE),
e&&this._saveAppliedStyle(h,this.GENERATE_STACKING_OUTER_STYLE),h.matches("object, embed")&&this._saveAppliedStyle(h,this.FLASH_DIMENSION_PROPS),h.matches("iframe"))e=!0;else if(!e&&(Math.min(h.parentNode.scrollWidth,h.parentNode.offsetWidth)!==f.width||Math.min(h.parentNode.scrollHeight,h.parentNode.offsetHeight)!==f.height)){e=!0,d=a.getComputedStyle(h);var i={"font-size":d["font-size"]+"!important","line-height":d["line-height"]+"!important","z-index":Number.MAX_SAFE_INTEGER-1+"!important"};this._saveAppliedStyle(h,i)}e&&this._iterateSiblings(h,function(a){a.matches(this.TAGS_NON_AFFECTING_LAYOUT)||(this._saveStyle(a),this._saveAppliedStyle(a,this.PLAYER_SIBLINGS_STYLE))}.bind(this))}var j=function(){this._reApplyStyles(),this._watchStyleChanges()}.bind(this);a.addEventListener("resize",j)},_restoreNode:function(){this._savedStyles.forEach(function(a,b){this._restoreStyle(b)}.bind(this)),this._savedStyles.clear(),this._appliedStyles.clear()},_reApplyStyles:function(a){Array.isArray(a)?a.forEach(this._applyStyleForNode.bind(this)):this._appliedStyles.forEach(function(a,b){this._applyStyleForNode(b)}.bind(this))},restore:function(){this._currentPiP&&(this._stopWatchingStyleChanges(),this._currentPiP.player?this._currentPiP.player.restore(this._restoreNode.bind(this)):this._restoreNode(this._currentPiP.node),this._currentPiP=null,this.emit("tab_restored",null))},get isPanelMode(){return!!this._currentPiP}},function(){var a={width:640,height:480};location.host.match(/^(?:[\w\d_-]+\.)*coccoc.com$/)&&b.addEventListener("click",function(b){if(b.target&&b.target.matches("a[x-coccoc-pip-url]")){var c=b.target,d=c.getAttribute("x-coccoc-pip-url"),e=c.getAttribute("x-coccoc-pip-size"),f=e&&/^(\d+)x(\d+)/.exec(e);e=f?{width:+f[1],height:+f[2]}:a,V.sendMessage({requestType:"pip",method:"pipUrl",params:{url:d,width:e.width,height:e.height}}),b.preventDefault(),b.stopPropagation()}})}(),L.prototype={STYLE:{background:"#000000",position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px",opacity:.6,zIndex:2147483647},_init:function(){var a=b.createElement("savior:overlay");W.dom.style(a,this.STYLE),this._overlay=a,this._warp=b.createDocumentFragment(),this._styleElement=b.createElement("style"),this._styleElement.innerHTML="body { -webkit-filter: blur(3px)!important; }",a.addEventListener("mouseup",this.hide.bind(this),!0),a.addEventListener("mousedown",this.hide.bind(this),!0),this._port=null,this._onConnectCallback=this._onConnect.bind(this),this._onDisconnectCallback=this._onDisconnect.bind(this),chrome.runtime.onConnect.addListener(this._onConnectCallback)},_onConnect:function(a){this._port=a,"overlay"===a.name&&(this.show(),a.onDisconnect.addListener(this._onDisconnectCallback))},_onDisconnect:function(){this.hide(),this._port&&this._port.onDisconnect.removeListener(this._onDisconnectCallback),this._port=null},hide:function(a){this._warp&&(a&&a.stopPropagation&&(a.stopPropagation(),a.preventDefault()),this._warp.appendChild(this._overlay),this._warp.appendChild(this._styleElement))},show:function(){b.body.appendChild(this._overlay),b.body.offsetHeight,b.head.appendChild(this._styleElement)},destroy:function(){this.hide(),this._port&&this._port.onConnect.removeListener(this._onConnectCallback),this._port=null,this._styleElement=null,this._overlay=null,this._warp=null}};var Va=function(a){N.apply(this,arguments),this._manager=a,this._timeout=null,this._started=!1,this._paused=!1,this._pollCallback=this._poll.bind(this)};Va.prototype={__proto__:N.prototype,RECHECK_PERIOD:3e3,_init:function(){b.addEventListener("webkitvisibilitychange",this._pollCallback,!1)},_getPlayerNodes:function(a){for(var b,c=[],d=a.length;b=a[--d];)b.node&&b.ids.length&&c.push(b.node);return c},_poll:function(){if(clearTimeout(this._timeout),!this._paused&&!b.webkitHidden){var a=this._manager.getMediaPlayers(),c=a.map(function(a){var b=new Z;return Z.when(a.ids).done(function(c){a.ids=[],c&&(a.ids=a.ids.concat(c)),b.resolve(a)}),b});Z.when(c).done(function(){var b=W.toArray(arguments),c=this._getPlayerNodes(a);this.emit("media_update",b,c),this._timeout=setTimeout(this._pollCallback,this.RECHECK_PERIOD)}.bind(this))}},start:function(){this._started?this._paused&&(this._paused=!1,this._poll()):(this._init(),this._poll(),this._started=!0)},pause:function(){clearTimeout(this._timeout),this._paused=!0},destroy:function(){clearTimeout(this._timeout),b.removeEventListener("webkitvisibilitychange",this._pollCallback,!1)}};var Wa=function(){this._options=new da,this._cache=new Ma,this._manager=new Ha,this._mediaScanner=new Va(this._manager),this._overlay=new L,this._options.load().success(this._init.bind(this)),this._pip=new Ua,this._exportGlobals(),this._controls=null};Wa.prototype={_init:function(){this.onMediaUpdate=this._onMediaUpdate.bind(this),this.onUnload=this._onUnload.bind(this),this.onMessageReceived=this._onMessageReceived.bind(this),a.onbeforeunload=this.onUnload,this._mediaScanner.on("media_update",this.onMediaUpdate),this._pip.on("tab_detached",this._onPiPDetach.bind(this)),chrome.runtime.onMessage.addListener(this.onMessageReceived)},_exportGlobals:function(){a.cache=this._cache,a.pip=this._pip,a.options=this._options,a.manager=this._manager},_hasMedia:function(a){var b=W.toArray(a).filter(function(a){return!!(a&&a.ids&&a.ids.length>0)});return!!b.length},_onMediaUpdate:function(a,c){var d=this._hasMedia(a),e=V.sendMessage({requestType:"media",method:"set_present",params:d});return e?(!this._controls&&b.documentElement&&this.canShowControls&&(this._controls=K(b.documentElement)),void(this._controls&&this._controls.setMediaPlayers(this._manager,a))):void this.onUnload()},_onMessageReceived:function(a,c,d){var e=null;switch(a.requestType){case"get_media":manager.getMedia().done(function(a){d(a)});break;case"downloads":e=Na.processRequest(a.method,a.params);break;case"request.matched":manager.processRequest(a);break;case"restore_tab":this._mediaScanner.start(),this._pip.restore();break;case"yt_change":this._controls.destroy(),this._controls=K(b.documentElement)}return e&&e.done(function(a){d({success:e.state===Z.RESOLVED,data:a})}),!0},_onPiPDetach:function(a){this._mediaScanner.pause(),V.sendMessage({requestType:"pip",method:"detachTab",params:a})},_onUnload:function(){this._controls&&this._controls.destroy(),this._overlay.destroy(),this._mediaScanner.destroy(),this._pip.isPanelMode&&V.sendMessage({requestType:"pip",method:"restorePanelToTab",params:null})},get canShowControls(){return"file:"!==location.protocol&&""!==location.hostname&&"localhost"!==location.hostname},start:function(){V.sendMessage({requestType:"media",method:"reset_all"}),this._mediaScanner.start()}};var Xa=new Wa;Xa.start();var Ya;!function(a){"undefined"!=typeof module&&module.exports?module.exports=a:"function"==typeof define?define(a):Ya=a}(function(){function a(a,b){return RegExp.prototype.test.call(a,b)}function b(b){return!a(p,b)}function c(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function d(a){return String(a).replace(/[&<>"'\/]/g,function(a){return u[a]})}function e(a){this.string=a,this.tail=a,this.pos=0}function f(a,b){this.view=a,this.parent=b,this.clearCache()}function g(){this.clearCache()}function h(a){for(var b,c=a[3],d=c;(b=a[4])&&b.length;)a=b[b.length-1],d=a[3];return[c,d]}function i(a){function b(a,b,c){if(!d[a]){var e=i(b);d[a]=function(a,b){return e(a,b,c)}}return d[a]}function c(c,d,e){for(var f,g,i="",j=0,k=a.length;k>j;++j)switch(f=a[j],f[0]){case"#":g=e.slice.apply(e,h(f)),i+=c._section(f[1],d,g,b(j,f[4],e));break;case"^":i+=c._inverted(f[1],d,b(j,f[4],e));break;case">":i+=c._partial(f[1],d);break;case"&":i+=c._name(f[1],d);break;case"name":i+=c._escaped(f[1],d);break;case"text":i+=f[1]}return i}var d={};return c}function j(a){for(var b,c,d=[],e=d,f=[],g=0;g<a.length;++g)switch(b=a[g],b[0]){case"#":case"^":b[4]=[],f.push(b),e.push(b),e=b[4];break;case"/":if(0===f.length)throw new Error("Unopened section: "+b[1]);if(c=f.pop(),c[1]!==b[1])throw new Error("Unclosed section: "+c[1]);e=f.length>0?f[f.length-1][4]:d;break;default:e.push(b)}if(c=f.pop())throw new Error("Unclosed section: "+c[1]);return d}function k(a){for(var b,c,d=0;d<a.length;++d)b=a[d],c&&"text"===c[0]&&"text"===b[0]?(c[1]+=b[1],c[3]=b[3],a.splice(d--,1)):c=b}function l(a){if(2!==a.length)throw new Error("Invalid tags: "+a.join(" "));return[new RegExp(c(a[0])+"\\s*"),new RegExp("\\s*"+c(a[1]))]}var m={};m.name="mustache.js",m.version="0.7.0",m.tags=["{{","}}"],m.Scanner=e,m.Context=f,m.Writer=g;var n=/\s*/,o=/\s+/,p=/\S/,q=/\s*=/,r=/\s*\}/,s=/#|\^|\/|>|\{|&|=|!/,t=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};m.escape=d,e.prototype.eos=function(){return""===this.tail},e.prototype.scan=function(a){var b=this.tail.match(a);return b&&0===b.index?(this.tail=this.tail.substring(b[0].length),this.pos+=b[0].length,b[0]):""},e.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.pos+=this.tail.length,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c),this.pos+=c}return b},f.make=function(a){return a instanceof f?a:new f(a)},f.prototype.clearCache=function(){this._cache={}},f.prototype.push=function(a){return new f(a,this)},f.prototype.lookup=function(a){var b=this._cache[a];if(!b){if("."===a)b=this.view;else for(var c=this;c;){if(a.indexOf(".")>0){var d=a.split("."),e=0;for(b=c.view;b&&e<d.length;)b=b[d[e++]]}else b=c.view[a];if(null!=b)break;c=c.parent}this._cache[a]=b}return"function"==typeof b&&(b=b.call(this.view)),b},g.prototype.clearCache=function(){this._cache={},this._partialCache={}},g.prototype.compile=function(a,b){return this._compile(this._cache,a,a,b)},g.prototype.compilePartial=function(a,b,c){return this._compile(this._partialCache,a,b,c)},g.prototype.render=function(a,b,c){return this.compile(a)(b,c)},g.prototype._compile=function(a,b,c,d){if(!a[b]){var e=m.parse(c,d),g=i(e),h=this;a[b]=function(a,b){if(b)if("function"==typeof b)h._loadPartial=b;else for(var d in b)h.compilePartial(d,b[d]);return g(h,f.make(a),c)}}return a[b]},g.prototype._section=function(a,b,c,d){var e=b.lookup(a);switch(typeof e){case"object":if(t(e)){for(var f="",g=0,h=e.length;h>g;++g)f+=d(this,b.push(e[g]));return f}return e?d(this,b.push(e)):"";case"function":var i=this,j=function(a){return i.render(a,b)};return e.call(b.view,c,j)||"";default:if(e)return d(this,b)}return""},g.prototype._inverted=function(a,b,c){var d=b.lookup(a);return!d||t(d)&&0===d.length?c(this,b):""},g.prototype._partial=function(a,b){a in this._partialCache||!this._loadPartial||this.compilePartial(a,this._loadPartial(a));var c=this._partialCache[a];return c?c(b):""},g.prototype._name=function(a,b){var c=b.lookup(a);return"function"==typeof c&&(c=c.call(b.view)),null==c?"":String(c)},g.prototype._escaped=function(a,b){return m.escape(this._name(a,b))},m.parse=function(a,d){function f(){if(x&&!y)for(;w.length;)v.splice(w.pop(),1);else w=[];x=!1,y=!1}d=d||m.tags;for(var g,h,i,p,t=l(d),u=new e(a),v=[],w=[],x=!1,y=!1;!u.eos();){if(g=u.pos,i=u.scanUntil(t[0]))for(var z=0,A=i.length;A>z;++z)p=i.charAt(z),b(p)?w.push(v.length):y=!0,v.push(["text",p,g,g+1]),g+=1,"\n"===p&&f();if(g=u.pos,!u.scan(t[0]))break;if(x=!0,h=u.scan(s)||"name",u.scan(n),"="===h)i=u.scanUntil(q),u.scan(q),u.scanUntil(t[1]);else if("{"===h){var B=new RegExp("\\s*"+c("}"+d[1]));i=u.scanUntil(B),u.scan(r),u.scanUntil(t[1]),h="&"}else i=u.scanUntil(t[1]);if(!u.scan(t[1]))throw new Error("Unclosed tag at "+u.pos);v.push([h,i,g,u.pos]),("name"===h||"{"===h||"&"===h)&&(y=!0),"="===h&&(d=i.split(o),t=l(d))}return k(v),j(v)};var v=new g;return m.clearCache=function(){return v.clearCache()},m.compile=function(a,b){return v.compile(a,b)},m.compilePartial=function(a,b,c){return v.compilePartial(a,b,c)},m.render=function(a,b,c){return v.render(a,b,c)},m.to_html=function(a,b,c,d){var e=m.render(a,b,c);return"function"!=typeof d?e:void d(e)},m}()),a.addEventListener("DOMContentLoaded",function(){chrome.runtime.sendMessage({requestType:"tests_page_ready",url:location.href})},!1),chrome.runtime.onMessage.addListener(function(b,c,d){switch(b.requestType){case"tests_thegioiphim_play":d(W.query("#playerID").sendEvent("PLAY"));break;case"tests_call_function":var e=a,f=b.fn.split("."),g=b.args,h=f.pop();try{for(;e&&f.length;)e=e[f.shift()];d(e[h].apply(e,g))}catch(i){d(null)}}return!0})}(window,document);