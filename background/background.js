!function(a,b,c){function d(a){return-1!==["m3u8","m3u"].indexOf(a)}function e(a){var b=a.url;a="object"==typeof b?b.videoUrl+"\n"+b.audioUrl:b;var c=y.hash(a);return c.toString()}function f(a,b){var d=b[0],e={};if(!d){if(a.length>1)for(var g=0;g<a.length;++g){var h=a[g],i=h.url();if("object"==typeof i&&(i=i.videoUrl),-1!==i.indexOf(".googlevideo.com"))return[h]}return[a[0]]}return a.forEach(function(a){var b=a[d]&&a[d]()||"";e[b]=e[b]||[],e[b].push(a)}),Object.keys(e).map(function(a){var g=f(e[a],b.slice(1)),h={media:g};return h[d]=y.defined(a)?a:c,h.is_only=1===g.length&&(!y.defined(g[0].is_only)||g[0].is_only),h["i18n_"+d]=z("media_fields_"+d+"_"+a),h})}function g(a){return a.forEach(function(a){var b=a.type;a.media.forEach(function(a){a.media=a.media.sort(function(a,c){return p[b].extensions.indexOf(a.ext)-p[b].extensions.indexOf(c.ext)})})}),a}function h(a){return a.ext?(a.media=a.media.sort(function(a,b){return quality.getQualityLevelByType(a.quality)-quality.getQualityLevelByType(b.quality)}),a):(Array.isArray(a)?a=a.map(h):a.media=h(a.media),a)}function i(a){return h(g(a))}function j(){function a(a,b){if(a){if("USER_CANCELED"===a)return void metrics.log("Download",metrics.DOWNLOAD_CANCELED);var c;0===a.indexOf("SERVER_")?c="RefrSE":0===a.indexOf("FILE_")&&(c="RefrFE"),c&&metrics.log(c,b.ref)}}var b=this;b._callbacks={},b._data={},b._tabMedia2id={},chrome.downloads.onCreated.addListener(function(a){b._data[a.id]={item:a,tid:null}}),chrome.downloads.onErased.addListener(function(a){var c=b._data[a];c&&b._sendMessage(c.tid,"erased",a),delete b._data[a]}),chrome.downloads.onChanged.addListener(function(c){var d=b._data[c.id];d&&null!==d.tid&&(b._sendMessage(d.tid,"changed",c),c.error&&a(c.error.current,d),b._onChange(c))}),chrome.tabs.onRemoved.addListener(function(a){delete b._callbacks[a],delete b._tabMedia2id[a]})}function k(a,b,c){return{name:a,hosts:Array.isArray(b)?b:[b],match:c}}function l(a,b,c){chrome.tabs.sendMessage(a,{requestType:"request.matched",name:b,result:c})}function m(a,b){if("flv"!==a.ext)return!1;var c=b.server;return c&&-1!==c.indexOf("icecast")}function n(a,b){if(!b||d(a.ext))return!0;if("vhosting.vcmedia.vn"===a.host)return!0;var c=+b;Number.isNaN(c)&&(c=null);var e=options.get("min_stream_size");return null!==c&&e>c?!1:(a.size=c,!0)}function o(a){var b=a.indexOf(R);return-1!==b?a.slice(b+S):null}const p={audio:{title:"Audio",rgxp:/audio/i,extensions:["mp3","flac","m4a","wma","ogg","wav","aif","mid","opus"],ctype2extension:{midi:"mid",mp4:"m4a",m4a:"m4a",mpeg:"mp3",mpeg3:"mp3",wav:"wav",aiff:"aif",opus:"opus"}},video:{title:"Video",rgxp:/video/i,extensions:["mp4","mpeg4","mpg","mpeg","m4v","avi","divx","mov","wmv","movie","asf","webm","flv","3gp"],ctype2extension:{mpeg:"mp4",mp4:"mp4",m4v:"mp4","3gpp":"3gp",flv:"flv",quicktime:"mov",msvideo:"avi","ms-wmv":"wmv","ms-asf":"asf"}}},q=function(){var a={};return Object.keys(p).forEach(function(b){for(var c=p[b].extensions,d=0;d<c.length;d++)a[c[d]]=b}),a}(),r=[/^(.+\.)?youtube.com/i,/^(.+\.)?zing.vn/i,/^(.+\.)?nhaccuatui.com/i,/^(.+\.)?vimeo.com/i,/^(.+\.)?clip.vn/i,/vietgiaitri\.com/i],s=[/^(.+\.)?nixcdn\.com/im,/^(.+\.)?vcmedia\.vn/i,/^(.+\.)?kenhhd\.tv/i];var t=function(){this.extra={}};if(t.prototype={check:function(a,b){var c=b?this.extra[b]:this.rules;return this._testRules(a,c)},_testRules:function(a,b){Date.now();if(!b)return!1;var c;if("string"==typeof a?c=a:(a.src||a.href)&&(c=a.src||a.href),c){for(var d=b.wlUrls.length,e=0;d>e;e++)if(b.wlUrls[e].test(c))return!1;d=b.blUrls.length;for(var e=0;d>e;e++)if(b.blUrls[e].test(c))return!0}if(!(a instanceof Node))return!1;for(var f=a.ownerDocument.location.href,e=0;e<b.wlCosmetics.length;e++){var g=b.wlCosmetics[e];if(("~"===g.domain[0]&&f.match(g.domain.substr(1))||f.match(g.domain))&&g.selectors.some(a.matches.bind(a)))return!1}for(var e=0;e<b.blCosmetics.length;e++){var g=b.blCosmetics[e];if(("~"===g.domain[0]&&f.match(g.domain.substr(1))||f.match(g.domain))&&g.selectors.some(a.matches.bind(a)))return!0}return!1},convertWildcard:function(a){if(/^\/.*?\/$/.test(a)&&/[\[\\(){}]/.test(a))return new RegExp(a.replace(/^\/|\/$/g,""),"i");var b=a.replace(/[.?+\\\[{()]/g,function(a){return"\\"+a}).replace(/\^/g,"[\\w\\d_.%-]").replace(/\*/g,".*").replace(/\|\|/g,"^\\w+://([\\d\\w-]+\\.)*").replace(/\|/g,"$");return new RegExp(b,"i")},getParsingRegex:function(){if(this.regex)return this.regex;var a="^\\s*(@@)?(/(?:[^/]|\\\\/)+/|(?:[^#$]+|#(?!#))+)?(?:(#@#|##)([^$]+))?(?:\\$(.*))?\\s*$";return this.regex=new RegExp(a,"i"),this.regex},parseFilters:function(a){var b=a;"string"==typeof b&&(b=b.split(/[\r\n]+/));for(var c={blUrls:[],wlUrls:[],blCosmetics:[],wlCosmetics:[]},d={"":{bl:[],wl:[]}},e=0;e<b.length;e++){var f=b[e];if(!/^\s*!|^\s*\[.*?\]\s*$/.test(f)){var g=this.getParsingRegex().exec(f);if(g){var h={whitelist:g[1],url:g[2],separator:g[3],selector:g[4],comment:g[5]};if(h.separator)for(var i=h.url?h.url.split(/,/):[""],j=0;j<i.length;j++){var k=i[j];k in d||(d[k]={bl:[],wl:[]}),k=d[k],"#@#"===h.separator?(h.whiteList||d[""].wl.push(h.selector),k[h.whitelist?"bl":"wl"].push(h.selector)):k[h.whitelist?"wl":"bl"].push(h.selector)}else{if(!h.url)continue;var l="@@"===h.whitelist?c.wlUrls:c.blUrls,m=this.convertWildcard(h.url);l.push(m)}}}}for(var n=Object.keys(d),e=0;e<n.length;e++){var o=n[e],k=d[o];k.bl.length&&c.blCosmetics.push({domain:this.convertWildcard(o),selectors:d[o].bl}),k.wl.length&&c.wlCosmetics.push({domain:this.convertWildcard(o),selectors:d[o].wl})}return c},loadRules:function(a,b){var c=this.parseFilters(a);b?this.extra[b]=c:this.rules=c}},"undefined"!=typeof module)module.exports=t;else var u=new t;u.loadRules(["/pre-roll/","/preroll/","/ads/","||histats.com/","||adnetwork.vn/","||doubleclick.net/","||admicro/","||adnet.vn/","||ds-vn.serving-sys.com/","||lavanetwork.net/","||video.sgame.vn:8080/","||cdn.blueseed/","||vcmedia.vn/","||innity.net/","||serving-sys.com/","||ambientplatform.vn/","||gvt1.com/","||comment.dantri.com.vn/","||adsquangcao.com/","||facebook.com/connect","||facebook.com/plugins/likebox.php","||facebook.com/plugins/comments.php","||facebook.com/connect/xd_arbiter","||facebook.com/plugins/page.php","||googlesyndication.com","||qccoccocmedia.vn/","||coccoc.com/webhp##*","||meme.vn/##*","||ads.phimnhanh.net/","||adsquangcao.com/","||edgecastcdn.net/","||qccoccocmedia.vn/","||dev-qccoccocmedia.vn/","||media.adnetwork.vn/","@@||vhosting.vcmedia.vn/","@@||vcplayer.vcmedia.vn/","@@||vscc.hosting.vcmedia.vn/","@@||vscc.dantri.hosting.vcmedia.vn/","@@||vscc-kenh14-hosting.vcmedia.vn/","##.adsbygoogle iframe","###adcontainer *","##.ad-container *",'##.facebook-top *, .fb-like-box *, iframe[title^="fb:like_box"]','##iframe[title^="fb:page"]','##[id^="AbdVideoPreroll"]','##[data^="player-ads"]','##[id^="google_ads_iframe_"]',"###pyv-iframe","##.box-ads *","##.ads *","##.video-ads *",'##iframe[onload*="google_iframe_oncopy"]','||youtube.com##[id*="sidebar-ads"] *',"||bit.ly/",'##[name*="zeroclipboard"],[data*="zeroclipboard"]',"||xemphimso.com/##.right-menu *","###AbdPopupAd_left iframe",'||phim.hayhd.vn/###adsdiv iframe,div[class*="ads"] iframe',"||nhaccuatui.com/##.box_right *,#banner-container-bottom *","||adxpansion.com/","||porn99.net##.content-right *","||thuvienanh.org/","||xemvtv.net/###ads-slider *",'||yeucahat.com/##div[id^="adscont"] *',"||sexad.net/","||ads.sex.com/",'||redtube.com/##div[id^="as_"] *','##object[id^="abdPopup"]',"||adnetwork.vn/",'##object[data*=".adnetwork.vn/"]',"||phim3s.net/##.ad_location *","||xhamster.com/###plAds *,.adVideo *,#adBottom *","||exoclick.com/","||trafficstars.com/","||traffichaus.com/","||trafficjunky.net/","||vivo.vn##.content-right-sidebar *",'||dailymotion.com##div[id^="mc_"] *',"||pornhub.com/###pb_block *,.right-ads *",'||xemphimso.com/##[id^="ebAd"],#eyeDiv *','||vivo.vn/##div[class*="ads"] *',"||phim.hayhd.vn/###block-resize-sidebar *","||phim.hayhd.vn/##.container .col-sm-8+.col-sm-4 *","||pornhub.com,tube8.com,youporn.com,redtube.com###pb_template *","||nhac.vui.vn/##.colRight *","||tube8.com/##.blockHtml *","||vkool.net/##.float-ck *,.col-left *,#sidebar *, #boxes *","||comment.vietid.net/comments","||dantri.com.vn/comment","||dantri.com.vn/##.fr.w510 *",'||vnexpress.net/##[id*="_BANNER_"] *, .block_banner *','||24h.com.vn/##[id*="ADS_"] *',"||ngoisao.net/###right *","||nhaccuatui.com/##.coverImage *","||phimsexporn.com/##.balloons-ck *"]),u.loadRules(["||mail.google.com/","||docs.google.com/","||dropbox.com/","||meme.vn/","||facebook.com/"],"pip"),u.loadRules(["||fptplay.net/##.hls-playback embed","||pubvn.tv/bar/threads/##iframe#player","||www.24h.com.vn/###player_video_kieu_moi iframe"],"pip-allowfullscreen-false"),u.loadRules(["||mail.google.com/","||docs.google.com/","||drive.google.com/","||dropbox.com/","||fptplay.net/livetv"],"download"),u.loadRules(["/fbcdn([^.]+\\.akamaihd)?\\.net$/","/.*dailymotion.*\\/frag\\(\\d+\\)\\//","||youtube.com/","||vimeo.com/","||vimeocdn.com/","||clip.vn/","||subs.xemphimonlines.com/","||dailymotion.com/","||dmcdn.net/","||nhacrap.tv/","||nixcdn.com/","||zdn.vn/","||vui.vn/","/fptplay\\.net\\/.*?seg\\d*-frag\\d*/","/hlscache\\.fptplay\\.net(?:\\.vn)?\\//","/49ef4358-e34d-484f-a18e-495cd9fe3817","/75247339-7897-437d-9627-55b1a1528700"],"requests");const v="file:///c:/work/savior0/src/tests/pages/";var w=function(){function a(a,b){var c=a[0]-b[0];return 0!==c?c:(c=a[1]-b[1],0!==c?c:(c=a[2]-b[2],0!==c?c:c=a[3]-b[3]))}var b="",c={mp4:!0},d=0,e=navigator.userAgent.match(/Chrome\/([\d\.]+)/);return e&&e[1]&&(e=e[1].split("."),e=[+e[0],+e[1],+e[2],+e[3]],a(e,[39,0,2171,103])>=0&&(b+=" webm!",c.webm=!0),a(e,[39,0,2171,105])>=0&&(b+=" m3u8!",d=1)),{YT:c,M3U8:d}}(),x=function(){function a(a){return a&&0!==a.indexOf("data:image")?f.exec(a):[]}var c=b.createElement("a"),d=/([^/]+)$/i,e=/\.([^/.]*)$/i,f={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}.strict,g=a(b.location.href);return{parse:function(a,b){var f=c;f.setAttribute("href",a);var g=(f.pathname.match(d)||[])[1]||"",h=g.split(".").map(function(a){return a.toLowerCase()});g=decodeURIComponent(g.replace(e,"")),h.shift();var i=h[h.length-1]||"",j={url:a,protocol:f.protocol,host:f.host,port:f.port,pathname:f.pathname,filename:g,ext:i,exts:h,hash:f.hash,search:f.search};return j.port||delete j.port,b&&(j.query={},f.search.replace(/^\?/,"").split(/\&/).forEach(function(a){a=a.split("="),j.query[a[0]]=a[1]})),j},parseParamString:function(a){a=a.replace(/^[#?]{1}/,"");var b=a.split("&"),c={};return b.forEach(function(a){var b=a.split("=");y.defined(b[0])&&y.defined(b[1])&&(c[b[0]]=decodeURIComponent(b[1].replace(/\+/g," ")))}),c},format:function(a){if(a=Object.create(a),a.query){a.search=[];for(var b in a.query)"undefined"!=typeof a.query[b]?a.search.push(b+"="+encodeURIComponent(a.query[b])):a.search.push(b);a.search="?"+a.search.join("&"),delete a.query}for(var d in a)c[d]=a[d];var e=c.href;return e},parse0:a,resolve:function(b,c){b=a(b),c||(c=g);var d=b[1],e=b[2],f=b[9],h=b[12],i=b[13];if(!d&&(d=c[1],!e))if(e=c[2],f){if("/"!==f.charAt(0)){var j=c[10]||"/";f=j+f}}else f=c[9],h||(h=c[12]);var k=d+"://"+e+f;return h&&(k+="?"+h),i&&(k+="#"+i),k},getHost:function(b){return a(b)[6]||""},getMediaType:function(b){var c=a(b)[11]||"";if(!c)return"";var d=c.split("."),e=d.length-1;if(0>=e)return"";var f=d[e].toLowerCase();return q[f]}}}(),y={SIZES:["B","KB","MB","GB","TB","PB"],_BASE:-1!==navigator.appVersion.indexOf("Win")?1024:1e3,xmlParser:new DOMParser,endsWith:function(a,b){var c=a.length-b.length;return c>=0&&a.indexOf(b,c)===c},hash:function(a,b){if(b=0|b,0===a.length)return b;var c,d;for(c=0,d=a.length;d>c;c++)b=(b<<5)-b+a.charCodeAt(c),b|=0;return b},query:function(a,c){return c=c||b,c.querySelector(a)},queryAll:function(a,c){return c=c||b,y.toArray(c.querySelectorAll(a))},findParent:function(a,b){for(;null!==a&&!a.classList.contains(b);)a=a.parentNode;return a},nearestParent:function(a,c){for(;null!==a&&a!==b&&!a.matches(c);)a=a.parentNode;return a},closest:function(a,b){return a.matches(b)?[a]:y.queryAll(b,a)},toArray:function(a){return Array.prototype.slice.call(a)},unique:function(a){var b=[];return Array.isArray(a)?(a.forEach(function(a){-1===b.indexOf(a)&&b.push(a)}),b):a},extend:function(a,b){var c=function(){};c.prototype=a.prototype,b.prototype=new c,b.prototype.constructor=b,b._super=a.prototype},extendObject:function(a){return Array.prototype.forEach.call(Array.prototype.slice.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},isMatches:function(a,b){var c,d,e;if(Array.isArray(a)){for(c=0;c<a.length;++c)if(y.isMatches(a[c],b))return!0;return!1}for(b=Array.isArray(b)?b:[b],c=0,d=b.length,e;d>c;++c)if(e=b[c],"string"==typeof e&&-1!==a.indexOf(e)||e instanceof RegExp&&a.match(e))return!0;return!1},_sendBackgroundRequest:function(a,b,c,d){var e=new B;return chrome.runtime.sendMessage({requestType:"make_http_request",method:a,url:b,params:c,headers:d},function(a){e[a.success?"resolve":"reject"](a.data)}),e},send:function(a,b,c,d){var e=new B,f=null;if(y.IS_CONTENT_SCRIPT)return y._sendBackgroundRequest(a,b,c,d);try{var g=new XMLHttpRequest;if(g.open(a,b,!0),g.setRequestHeader("Cache-Control","no-cache"),"object"==typeof c&&(f=Object.keys(c).map(function(a){return a+"="+c[a]}).join("&")),"object"==typeof d)for(var h in d)g.setRequestHeader(h,d[h]);"POST"===a&&(g.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f&&g.setRequestHeader("Content-Length",f.length)),g.onload=function(){e.resolve(this.responseText)},g.onerror=function(){e.reject()},g.send(f)}catch(i){e.reject()}return e},get:function(a,b){return y.send("GET",a,{},b)},post:function(a,b,c){return y.send("POST",a,b,c)},_getSize:function(a){function b(a){d&&d[a?"resolve":"reject"](a),d=null,c.abort(),clearTimeout(e),e=null}var c=new XMLHttpRequest,d=new B,e=null,f=1e4;return c.open("GET",a),c.setRequestHeader("Cache-Control","no-cache"),c.url=a,c.onreadystatechange=function(){if(!(this.readyState<2)){var a=null;try{a=+this.getResponseHeader("Content-Length"),Number.isNaN(a)&&(a=null)}catch(c){}(null!==a||200===this.status)&&(200!==this.status&&(a=null),b(a))}},c.send(null),e=setTimeout(b,f),d},getSize:function(b){var c=new B,d=a.cache;return d.get(b).success(function(a){a?(c.resolve(a),d.put(b,a)):c.bind(y._getSize(b)).success(d.put.bind(d,b))}).fail(function(){c.bind(y._getSize(b)).success(d.put.bind(d,b))}),c},beautifyFileSize:function(a){if(null===a||"undefined"==typeof a)return"???";for(var b=y._BASE,c=0;c<y.SIZES.length&&a>=b;++c,a/=b);return Math.round(10*a)/10+y.SIZES[c]},detectMediaTypeAndExt:function(a,b){b=b||"";var c=["application/x-mpegurl","application/vnd.apple.mpegurl","audio/x-mpegurl","audio/mpegurl"];if(-1!==c.indexOf(b))return a.type="video",a.ext="m3u8",a;var d=y.getMediaType(b,a.exts);return d&&p[d]&&(a.type=d,a.ext=this._findIntersection(a.exts,p[d].extensions)||y.extByContentType(b,d)||a.ext),a},getMediaType:function(a,b){var c;for(var d in p){if(c=p[d],a.match(c.rgxp))return d;if(Array.isArray(b)&&y._findIntersection(b,c.extensions)||-1!==c.extensions.indexOf(b))return d}return null},_findIntersection:function(a,b){for(var c=a.concat(b),d={},e=0;e<c.length;++e){var f=c[e];if(d[f])return f;d[f]=!0}return null},extByContentType:function(a,b){var c=p[b].ctype2extension;for(var d in c)if(-1!==a.indexOf(d))return c[d];return null},call:function(a,b){if(a&&!(a.length<=0))for(var c=[].slice.call(arguments,2),d=0;d<a.length;d++)a[d].apply(b,c)},isTrue:function(a){return!!a},noop:function(){},defined:function(a){return"undefined"!=typeof a},notNull:function(a){return null!==a},debounce:function(a,b,c){var d;return function(){function e(){c||a.apply(f,g),d=null}var f=this,g=arguments;d?clearTimeout(d):c&&a.apply(f,g),d=setTimeout(e,b||100)}},unescapeHTML:function(){var a;return function(c){a=a||b.createElement("div"),a.innerHTML=(""+c).replace(/</g,"&lt;");var d=a.firstChild.textContent;return a.innerHTML="",d}}(),replaceEntities:function(a){var b={"&amp;":"&"};return String(a).replace(/&amp;/g,function(a){return b[a]})},xpath:function(){function a(a){return a&&a.id&&!/\d/.test(a.id)?"//"+a.tagName+'[@id="'+a.id+'"]':c(a)}function c(a){for(var b=[];a&&a.nodeType==Node.ELEMENT_NODE;a=a.parentNode){for(var c=0,d=!1,e=a.previousSibling;e;e=e.previousSibling)e.nodeType!=Node.DOCUMENT_TYPE_NODE&&e.nodeName==a.nodeName&&++c;for(e=a.nextSibling;e&&!d;e=e.nextSibling)e.nodeName==a.nodeName&&(d=!0);var f=(a.prefix?a.prefix+":":"")+a.localName,g=c||d?"["+(c+1)+"]":"";b.splice(0,0,f+g)}return b.length?"/"+b.join("/"):null}function d(a,c){return c=c||b,b.evaluate(a,c,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}return{forElement:a,find:d}}(),dom:function(){function a(a,b){return Object.keys(b).forEach(function(c){a.setAttribute(c,b[c])}),a}function c(a,b){return Object.keys(b).forEach(function(c){a.style[c]=b[c]}),a}function d(a){var c=b.createElement("div"),d=b.createDocumentFragment();return c.innerHTML=a,[].slice.call(c.childNodes).forEach(d.appendChild,d),c=null,d}function e(a){if(!(a instanceof HTMLElement))return{width:0,height:0};a.matches("embed")&&a.parentNode.matches("object")&&(a=a.parentNode);var b=a.querySelector("embed");return b&&!u.check(b)&&b.offsetWidth&&b.offsetHeight&&(a=b),{width:a.offsetWidth,height:a.offsetHeight}}function f(a){return a.split(";").reduce(function(a,b){var c=b.indexOf(":");if(-1!==c){var d=b.substr(0,c).trim(),e=b.substr(c+1);a[d]=e}return a},{})}function g(a){return Object.keys(a).map(function(b){return b+":"+a[b]}).join(";")}function h(a){for(var b={top:0,left:0,height:a.offsetHeight,width:a.offsetWidth};a;)b.left+=a.offsetLeft,b.top+=a.offsetTop,a=a.offsetParent;return b}return{attr:function(b,c){Array.isArray(b)?b.forEach(function(b){a(b,c)}):a(b,c)},style:function(a,b){Array.isArray(a)?a.forEach(function(a){c(a,b)}):c(a,b)},setStyleAttr:function(a,b){var c=function(a){var c=a.getAttribute("style")||"",d=f(c);for(var e in b)b.hasOwnProperty(e)&&(d[e]=b[e]);var h=g(d);c!==h&&a.setAttribute("style",h)}.bind(this);Array.isArray(a)?a.forEach(c):c(a)},parseHTML:d,getOffset:h,getEmbedSize:e}}(),google:function(){var a="com|ac|ad|ae|al|am|as|at|az|ba|be|bf|bg|bi|bj|bs|bt|by|ca|cc|cd|cf|cat|cg|ch|ci|cl|cm|cn|cv|cz|de|dj|dk|ee|fi|dm|dz|es|fm|fr|ga|ge|gf|gg|gl|gm|gp|gr|gy|hn|hr|ht|hu|ir|iq|ie|im|io|is|it|je|ki|kg|jo|kz|la|lt|lu|lv|li|lk|md|me|mg|mk|ml|mn|ms|mu|mv|mw|nl|no|nr|nu|pl|ne|pn|ps|pt|ro|rs|ru|rw|sc|se|sh|si|sn|sm|so|tk|tl|tm|to|tn|st|sk|tt|td|vu|ws|vg|tg|us",b="th|id|il|in|jp|ke|ma|kr|mz|ls|nz|tz|ug|uk|uz|ve|vi|za|zm|zw|ao|ck|bw|cr",c="pr|py|qa|sa|sb|sg|sl|sv|tj|tn|tr|tw|gh|gi|gt|hk|jm|kw|lb|lc|ly|mm|mt|mx|my|na|nf|ng|ni|np|om|pa|pe|ph|pk|pg|ua|uy|vc|vn|af|ag|ai|ar|au|bd|bh|bn|bo|br|bz|kh|co|cu|cy|do|ec|eg|et|fj",d=new RegExp("^(www\\.)?google\\.(("+a+")|(co((\\.("+b+"))|m\\.("+c+"))))$","i"),e=/[&?]q=[^&]/i;return{isSERPHost:function(a){return Boolean(a.match(d))},isSERPRequest:function(a){var b=x.parse(a);return Boolean(this.isSERPHost(b.host)&&b.pathname.match(/\/s(earch)?/i)&&b.search.match(e))},getSearchParams:function(a){var b=x.parse(a),c=x.parseParamString(b.search),d=x.parseParamString(b.hash||"#"),e=y.defined(d.q);return{_rawSearch:c,_rawHash:d,q:e?d.q:c.q||null,s:e?d.start||0:c.start||0,tbm:e?d.tbm:c.tbm||null,isXHR:c.tch,isHash:e}}}}()},z=chrome.i18n.getMessage;try{chrome.extension.getBackgroundPage(),y.IS_CONTENT_SCRIPT=!1}catch(A){y.IS_CONTENT_SCRIPT=!0}try{y.IS_INCOGNITO=chrome.extension.inIncognitoContext}catch(A){y.IS_INCOGNITO=!1}var B=function(a){if(0===arguments.length)return this._init(),this;if(a instanceof B)return a;var b=new B;return b.resolve(a),b};B.RUNNING=0,B.RESOLVED=1,B.FAILED=2,B.prototype={constructor:B,_init:function(){this._results=[],this._subscribers=[],this.state=B.RUNNING},_notify:function(){var a=this;this._subscribers.forEach(function(b){b.apply(a,a._results)}),this._subscribers=[]},resolve:function(){return this.state=B.RESOLVED,this._results=arguments,this._notify(),this},reject:function(){return this.state=B.FAILED,this._results=arguments,this._notify(),this},subscribe:function(a){this.state!==B.RUNNING?a.apply(this,this._results):this._subscribers.push(a)},done:function(a){return this.subscribe(a),this},success:function(a){var b=this;return this.subscribe(function(){b.state===B.RESOLVED&&a.apply(b,b._results)}),this},fail:function(a){var b=this;return this.subscribe(function(){b.state===B.FAILED&&a.apply(b,b._results)}),this},bind:function(a){return a=new B(a),a.success(this.resolve.bind(this)).fail(this.reject.bind(this)),this}},B.when=function(){var a=[];return a=Array.isArray(arguments[0])?arguments[0]:y.toArray(arguments),new B.When(a)},B.When=function(a){this._doneCallbacks=[],this._successCallbacks=[],this._failCallbacks=[],this._state=B.RUNNING,this._thingsToDo=a.length,this._results=Array(this._thingsToDo),this._init(a)},B.When.prototype={constructor:B.When,_init:function(a){var b=this;a.forEach(function(a,c){a=new B(a),a.subscribe(function(){a.state===B.FAILED&&(b._state=B.FAILED),b._results[c]=y.toArray(arguments),b._thingsToDo--,b._checkIsDone()})}),this._checkIsDone()},_checkIsDone:function(){if(0!==this._thingsToDo)return!1;var a=[];this._results.forEach(function(b){a=a.concat(b)}),this._state===B.FAILED?this._runCallbacks(this._failCallbacks,a):this._runCallbacks(this._successCallbacks,a),this._runCallbacks(this._doneCallbacks,a),this._doneCallbacks=[],this._successCallbacks=[],this._failCallbacks=[]},_runCallbacks:function(a,b){a.forEach(function(a){a.apply(this,b)})},done:function(a){return this._doneCallbacks.push(a),this._checkIsDone(),this},success:function(a){return this._successCallbacks.push(a),this._checkIsDone(),this},fail:function(a){return this._failCallbacks.push(a),this._checkIsDone(),this}},B.chain=function(){function a(b){if(!b.length)return c.resolve.apply(c,d);var e,f=b.shift();"function"==typeof f?(e=B(f()),e.done(function(c){d.push(c),a(b)})):(d.push(f),a(b))}var b,c=new B,d=[];return b=Array.isArray(arguments[0])?arguments[0]:y.toArray(arguments),a(b),c};var C=function(){this._storage=chrome.storage.local,this._options={},this._default={detach_enabled:!0,on_page_buttons:!0,min_stream_size:30720,prefer_last_quality:!0};var a=this;chrome.storage.onChanged.addListener(function(b,c){if("local"===c)for(var d in b)a._options[d]=b[d].newValue})};C.prototype={load:function(){var a=new B,b=this;return this._storage.get(null,function(c){b._options=c,a.resolve(c)}),a},set:function(a,b){var c={};("string"==typeof a||"number"==typeof a&&"undefined"!=typeof b)&&(c[a]=b,this._options[a]=b,this._storage.set(c))},get:function(a){return a in this._options?this._options[a]:this._default[a]}};var D=function(){};D.QL_HIGH="High",D.QL_MEDIUM="Medium",D.QL_LOW="Low",D.QL_VIDEO_ULTRAHD="Ultra HD",D.QL_VIDEO_FULLHD="Full HD",D.QL_VIDEO_HD="HD",D.QL_VIDEO_STANDARD="Standard",D.QL_VIDEO_MEDIUM="Medium",D.QL_VIDEO_SMALL="Small",D.QL_VIDEO_MOBILE="Mobile";var E={};E[D.QL_VIDEO_ULTRAHD]={quality:D.QL_HIGH,qualityIndex:6,size:3072,videoTitle:"Ultra HD",itag:[38,138]},E[D.QL_VIDEO_FULLHD]={quality:D.QL_HIGH,qualityIndex:5,size:1080,videoTitle:"Full HD",audioTitle:"High",itag:[37,46,137],vimeoQuality:"",zingTag:"f1080",dailymotionQuality:"hd1080",clipvnQuality:"5"},E[D.QL_VIDEO_HD]={quality:D.QL_HIGH,qualityIndex:4,size:720,videoTitle:"HD",audioTitle:"High",itag:[22,45,120,136,247],zingTag:["f720","hq"],vimeoQuality:"hd",dailymotionQuality:["hd","hd720"],facebookQuality:["hd_src","hd_src_no_ratelimit"],JWQuality:"highquality",clipvnQuality:"4"},E[D.QL_VIDEO_STANDARD]={quality:D.QL_MEDIUM,qualityIndex:3,size:480,videoTitle:"Standard",audioTitle:"Normal",itag:[44,35,135,244],zingTag:["f480"],dailymotionQuality:"hq",vimeoQuality:"sd",facebookQuality:["sd_src","sd_src_no_ratelimit"],JWQuality:"location",clipvnQuality:"3"},E[D.QL_VIDEO_MEDIUM]={quality:D.QL_MEDIUM,qualityIndex:2,size:360,videoTitle:"Medium",audioTitle:"Normal",itag:[18,43,34,134,243],vimeoQuality:"",dailymotionQuality:"sd",zingTag:["source","f360"],JWQuality:"lowquality",clipvnQuality:"2"},E[D.QL_VIDEO_SMALL]={quality:D.QL_LOW,qualityIndex:1,size:240,videoTitle:"Small",audioTitle:"Low",itag:[36,5,133,242],dailymotionQuality:"ld",vimeoQuality:"mobile",zingTag:["f","f240"],clipvnQuality:"1"},E[D.QL_VIDEO_MOBILE]={quality:D.QL_LOW,qualityIndex:0,size:144,videoTitle:"Mobile",audioTitle:"Low",itag:[17,6,160],vimeoQuality:"",clipvnQuality:"0"};var F={};F[D.QL_HIGH]=E[D.QL_VIDEO_ULTRAHD].qualityIndex,F[D.QL_MEDIUM]=E[D.QL_VIDEO_STANDARD].qualityIndex,F[D.QL_LOW]=E[D.QL_VIDEO_SMALL].qualityIndex,D.prototype={constructor:D,DEFAULT_QUALITY_LEVEL:D.QL_HIGH,QUALITY_LEVELS:[D.QL_HIGH,D.QL_MEDIUM,D.QL_LOW],VIDEO_QUALITY_LEVELS:[D.QL_VIDEO_ULTRAHD,D.QL_VIDEO_FULLHD,D.QL_VIDEO_HD,D.QL_VIDEO_STANDARD,D.QL_VIDEO_MEDIUM,D.QL_VIDEO_SMALL,D.QL_VIDEO_MOBILE],DEFAULT_QUALITY_TYPE:D.QL_VIDEO_STANDARD,QUALITY_TYPES:E,getFacebookQuality:function(a){return this._getVideoQuality("facebookQuality",a).videoTitle},getDailymotionQuality:function(a){return this._getVideoQuality("dailymotionQuality",a).videoTitle},getZingVideoQuality:function(a){return this._getVideoQuality("zingTag",a).videoTitle},getZingAudioQuality:function(a){return this._getVideoQuality("zingTag",a).audioTitle},getYoutubeQuality:function(a,b){var c=this._getVideoQuality("itag",+a,b);return c&&c.videoTitle},getVimeoQuality:function(a){return this._getVideoQuality("vimeoQuality",a).videoTitle},getClipvnQuality:function(a){return this._getVideoQuality("clipvnQuality",a).videoTitle},getJWQuality:function(a){return this._getVideoQuality("JWQuality",a).videoTitle},_getVideoQuality:function(a,b,c){for(var d in this.QUALITY_TYPES){var e=this.QUALITY_TYPES[d][a];if(Array.isArray(e)||(e=[e]),-1!==e.indexOf(b))return this.QUALITY_TYPES[d]}return c?null:this.QUALITY_TYPES[this.DEFAULT_QUALITY_TYPE]},_getTypeByQualityType:function(a){for(var b in this.QUALITY_TYPES)if(a===b||a===this.QUALITY_TYPES[b].videoTitle||a===this.QUALITY_TYPES[b].audioTitle)return this.QUALITY_TYPES[b];return this.QUALITY_TYPES[this.DEFAULT_QUALITY_TYPE]},_calculateWeight:function(a,b){var c=p[a.get("type")].extensions,d=c.indexOf(a.get("ext")),e=this._getTypeByQualityType(a.get("quality")).qualityIndex,f=d/c.length+Math.abs(b-e)/7;return f},getQualityLevelByType:function(a){return Object.keys(this.QUALITY_TYPES).indexOf(this._getTypeByQualityType(a).videoTitle)},getVideoQualityIndex:function(a){return this.VIDEO_QUALITY_LEVELS.concat().reverse().indexOf(a)},getOneClickQualityIndex:function(a){return this.QUALITY_LEVELS.concat().reverse().indexOf(a)},getQualityLevelByQualityType:function(a){return this._getTypeByQualityType(a).quality},chooseBestDownload:function(a,b,c){var d=a.length;if(c)for(var e=0;d>e;++e){var f=a[e];if(f.extQuality()===c)return f}b=b||this.DEFAULT_QUALITY_LEVEL;for(var g=F[b],h=1e3,i=-1,e=0;d>e;++e){var f=a[e],j=this._calculateWeight(f,g);h>j&&(h=j,i=e)}return a[i]}},a.quality=new D;var G=function(){this._cache={}};G.DEFAULT_TTL=12e5,G.prototype={constructor:G,processRequest:function(a,b,c){var d=this;switch(b){case"get":return d.get(c.key);case"put":d.put(c.key,c.value,c.ttl);break;case"delete":d["delete"](c.key)}},get:function(a){var b=new B;return a in this._cache?b.resolve(this._cache[a]):b.reject(null),b},put:function(a,b,c){a&&"undefined"!=typeof b&&(c=c||G.DEFAULT_TTL,this._cache[a]=b,setTimeout(this["delete"].bind(this,a),c))},"delete":function(a){this._cache[a]&&delete this._cache[a]}};var H=function(a){this._date=Date.now(),this._values={},this._sizePromise=null,this._hls=!1,this.merge(a)};H.MAX_FILE_NAME_LENGTH=128,H.isValidData=function(a){if(w.M3U8&&d(a.ext))return!0;var b=p[a.type];return b&&-1!==b.extensions.indexOf(a.ext)},H.prototype._createFieldGetter=function(a){this[a]=function(){return this.get(a)}},H.prototype._generateFakeName=function(){return[this._values.type,e(this._values)].join("-").replace(/-+/g,"-")},H.prototype.get=function(a){return"string"==typeof a||"number"==typeof a?this._values[a]:void 0},H.prototype.set=function(a,b){return"string"!=typeof a&&"number"!=typeof a||this._values[a]===b||(this._values[a]=b,this[a]||this._createFieldGetter(a)),this},H.prototype.merge=function(a){var b=a instanceof H?a._values:a;for(var c in b)this.set(c,"undefined"!=typeof b[c]?b[c]:b[c]||null);return d(this.get("ext"))&&(this.set("ext","mp4"),this._hls=!0),this},H.prototype.getName=function(){return y.replaceEntities(this._values.title||this._values.filename||this._generateFakeName())},H.prototype.title=function(){return this.getName().substr(0,H.MAX_FILE_NAME_LENGTH)},H.prototype.getFilename=function(){var a=this.getName(),b="."+this._values.ext;return y.endsWith(a,b)||(a+=b),a=a.replace(/\s+/g," ").replace(/[\/\\:*?"<>|\u200c\u200d]/g,"-"),a.substr(0,H.MAX_FILE_NAME_LENGTH)},H.prototype.extQuality=function(){return(this.get("ext")||"")+"/"+(this.get("quality")||"")},H.prototype.size=function(){var a=this.get("size");return a?"("+y.beautifyFileSize(a)+")":""},H.prototype.getSize=function(){function a(a){a&&e.push(y.getSize(a))}var b=this;if(b._sizePromise)return b._sizePromise;var c=new B;b._sizePromise=c;var d=b.get("size")||0;if(d||b._hls)return c.resolve(d),c;var e=[],f=b.get("url");if("object"==typeof f){var g=[f.audioUrl,f.videoUrl];g.forEach(a)}else a(f);e.length>0?e=1===e.length?e[0]:B.when(e):(e=new B,e.reject());var h=b.get("altUrl");return e.success(function(){for(var a=arguments,d=0,e=a.length-1;e>=0;e--)d+=a[e];b.set("size",d),c.resolve(d)}).fail(function(){if(h){var a=y.getSize(h);a.success(function(a){b.set("size",a)}),c.bind(a)}else c.reject(null)}),c};var I=function(a,b){this.api=L,this._uninitialized=!0,y.defined(b)||(b=-1),this._tid=b,this.data=[],this.setMediaData(a)};I.prototype={setMediaData:function(a){var b=this,c=new B;return a?(B(a).done(function(a){if(b._uninitialized&&0===a.length)return b._uninitialized=!1,void c.reject(b,!0);b._uninitialized=!1;var d=b.data,f=new Array(d.length),g=d.map(function(a){return a.id()});a.forEach(function(a){a.id=a.id||e(a);var c,h=g.indexOf(a.id);-1===h?(g.push(a.id),c=new H(a),d.push(c)):(h<f.length&&(f[h]=!0),c=d[h],c.merge(a)),c._ditem=b.api.item(b._tid,a.id)});for(var h=f.length!==d.length,i=f.length-1;i>=0;i--)f[i]||(h=!0,d.splice(i,1));c.resolve(b,h)}),c):(c.reject(this,!1),c)},getMediaCount:function(){var a=this.data;if(0===a.length)return 0;for(var b=0,c={},d=0;d<a.length;++d){var e=a[d],f=e.title()+e.type();c[f]||(c[f]=!0,++b)}return b},getMedia:function(a){return this.data.filter(function(b){return b.id()==a})[0]},getMediaGroup:function(a){return this.data.filter(function(b){return-1!==a.indexOf(b.id())})},download:function(a){var b=this.getMedia(a);if(b){var c={id:b.id(),url:b.url(),filename:b.getFilename(),referrer:b.referrer(),hls:b._hls},d=this.api.download(this._tid,c);return d.success(function(a){b._ditem=a}),d}},onChange:function(a){this.api.onChange(this._tid,a)},group:function(){return i(f(this.data,["type","title","ext","quality"]))},isOneMedia:function(){for(var a,b,c=this.data,d={},e=0,f=0;e<c.length&&1>=f;++e)if(a=c[e],b=a.title()+a.type(),!d[b]&&(d[b]=!0,++f>1))return!1;return!0}},function(){var c=function(){};c.SOURCE_POPUP_PAGE=0,c.SOURCE_OPTIONS_PAGE=10,c.SOURCE_CONTENT_SCRIPT=20,c.SOURCE_BACKGROUND_PAGE=30,c.prototype={LEGACY_METRICS_NAME_MAP:{ButtonClicked:"TryItNowButtonClicked",CheckBoxClicked:"OneClickCheckbox"},get source(){if(!chrome.extension.getBackgroundPage)return c.SOURCE_CONTENT_SCRIPT;switch(b.location.pathname){case"/popup.html":return c.SOURCE_POPUP_PAGE;case"/options.html":return c.SOURCE_OPTIONS_PAGE;case"/background.html":return c.SOURCE_BACKGROUND_PAGE;default:return}},_getFullName:function(a){return"Savior."+(this.LEGACY_METRICS_NAME_MAP[a]||a)},_getTotalValue:function(a,b,c){return c||"PageShown"===a||"number"!=typeof b?b:b+this.source;
},_doLog:function(a,b,d){var e=this._getFullName(b);if(this.source===c.SOURCE_CONTENT_SCRIPT)chrome.runtime.sendMessage({requestType:"metrics",method:"log",params:{name:b,value:d}});else if(chrome.metricsPrivate)switch(a){case"recordSmallCount":chrome.metricsPrivate.recordSmallCount(e,d);break;case"recordValue":chrome.metricsPrivate.recordValue({metricName:e,type:"histogram-linear",min:0,max:1e3,buckets:1002},d);break;case"recordSerpData":case"recordClickData":chrome.metricsPrivate[a](d)}},_getMethodByName:function(a){switch(a){case"Refr":case"RefrSE":case"RefrFE":return"recordValue";case"SerpData":return"recordSerpData";case"SerpClickData":return"recordClickData";default:return"recordSmallCount"}},log:function(a,b,c){var d=this._getMethodByName(a),e=this._getTotalValue(a,b,c);this._doLog(d,a,e)},logFromContentScript:function(a,b){this.log(a,b,!0)},PAGE_WELCOME_SCREEN:0,PAGE_DOWNLOADS_LIST:1,PAGE_ONE_CLICK_DOWNLOAD:2,PAGE_NO_MEDIA_FOUND:3,PAGE_OPTIONS:4,PAGE_CONTENT_SHOW_CONTROLS:5,PAGE_CONTENT_NO_MEDIA:9,DOWNLOAD_AUTO:0,DOWNLOAD_BUTTON:1,DOWNLOAD_ALL:2,DOWNLOAD_REQUEST_SIZE:3,DOWNLOAD_REQUEST_SIZE_FAILED:4,DOWNLOAD_CANCELED:7,BUTTON_MAIN:0,BUTTON_TRY_IT_NOW:1,BUTTON_SHOW_DOWNLOADS:2,BUTTON_HIDE_DOWNLOADS:3,BUTTON_DOWNLOAD_ALL:4,BUTTON_CHECK_ALL:5,BUTTON_CHECK_NONE:6,BUTTON_FAKE_QUALITY:7,BUTTON_DETACH:8,CHECK_BOX_ENABLE_ONE_CLICK:0,CHECK_BOX_SHOW_ON_PAGE_BUTTONS:2,CHECK_BOX_PREFER_LAST_QUALITY:4,CHECK_BOX_DETACH_ENABLED:6,PIP_DETACH_CLICK:0,PIP_RESTORE_CLICK:1,PIP_SITE_LINK_CLICK:2},a.metrics=new c}();var J=function(){var a=this;this._media={},chrome.tabs.onRemoved.addListener(function(b){a.resetAllMedia(b,!0)})};J.prototype={constructor:J,processRequest:function(a,b,c){var d=this;switch(b){case"reset_all":d.resetAllMedia(a);break;case"set_present":d.setHasMedia(a,c)}},showPageActionState:function(a){var b=!!this._media[a];chrome.runtime.lastError,chrome.pageAction[b?"show":"hide"](a),chrome.runtime.lastError;var c=!0;!c&&b&&!options.get("not_first_run")&&chrome.pageAction.showPopup&&setTimeout(function(){chrome.tabs.query({active:!0,currentWindow:!0,windowType:"normal"},function(b){b.length&&b[0].id==a&&!options.get("not_first_run")&&(chrome.runtime.lastError,chrome.pageAction.showPopup(a))})},5e3)},_requestMediaFromCS:function(a){var b=new B;return chrome.tabs.sendMessage(a,{requestType:"get_media"},function(a){b.resolve(a)}),b},resetAllMedia:function(a,b){delete this._media[a],b||this.showPageActionState(a)},setHasMedia:function(a,b){this._media[a]=b,this.showPageActionState(a)},getMediaForTab:function(a){var b=new B;return this._requestMediaFromCS(a).done(function(c){b.resolve(new I(c,a))}),b}},a.db=new J;var K=function(){for(var a=["facebook.com","youtube.com","mp3.zing.vn","tv.zing.vn","radio.zing.vn","clip.vn","nhaccuatui.com","haivl.tv","yan.vn","xvideos.com","meme.vn","yeucahat.com","chimsedinang.com","phim3s.net","media.bongdaplus.vn","nhac.vui.vn","phim14.net","xhamster.com","xnxx.com","movies.hdviet.com","chiasenhac.com","videos.vietgiaitri.com","hayhaytv.vn","vietsub.vnsharing.net","nhacso.net","pornhub.com","phimsexvip.com","vntube.tv","hdonline.vn","xemphimso.com","dailymotion.com","tienganh123.com","redtube.com","phim8.vn","tube8.com","vietnamnettv.vn","sexnhanh.com","zphimsex.com","vivo.vn","porn99.net","phimnhanh.net","anime47.com","phimsexporn.com","keeng.vn","lauxanh.org","khosachnoi.com.vn","xemnghe.com","blogviet.com.vn","soundcloud.com","learningenglish.voanews.com"],b={},c=0,d=a.length;d>c;++c){var e=a[c];b[e]=c+1}return function(a){for(var c=x.getHost(a),d=b[c];!d&&c;){var e=c.indexOf(".")+1;if(0===e)break;c=c.substr(e),d=b[c]}return 0|d}}();j.prototype={processRequest:function(a,b,c){var d=this;switch(b){case"download":return d.download(a,c,!0);case"pause":d.pause(c);break;case"resume":d.resume(c);break;case"cancel":d.cancel(c);break;case"open":d.open(c);break;case"show":d.show(c)}},_sendMessage:function(a,b,c,d){chrome.tabs.sendMessage(a,{requestType:"downloads",method:b,params:c},d)},_onChange:function(a){var b=this._data[a.id];if(b){var c=b.item;for(var d in a)"id"!==d&&(c[d]=a[d].current);y.call(this._callbacks[b.tid],this,b.mid,c,a)}},_options:function(a){var b={filename:a.filename},c=a.url;if("object"==typeof c){if(!c.videoUrl||!c.audioUrl)return;chrome.mediaDownload?(b.videoUrl=c.videoUrl,b.audioUrl=c.audioUrl):b.url=c.videoUrl}else b.url=c;if(chrome.mediaDownload){var d=a.referrer;d&&(b.referrer=d);var e=[b.url,b.audioUrl,b.videoUrl].filter(y.defined);y.isMatches(e,s)&&(b.streamsNumber=1),a.hls&&(b.streamsNumber=-42)}return b},onChange:function(a,b){var c=this._callbacks[a];c||(c=this._callbacks[a]=[]),c.push(b)},download:function(a,b,c){function d(b){if(b){var d=e._data[b];if(d){d.tid=a,d.mid=h,d.ref=K(g);var i=e._tabMedia2id[a];return i||(i=e._tabMedia2id[a]={}),i[h]=b,metrics.log("Refr",d.ref),f.resolve(d.item),void(c||e._sendMessage(a,"created",d))}}f.reject(chrome.runtime.lastError)}var e=this,f=new B,g=b.referrer,h=b.id,i=e._options(b);return i?i.url?(i.conflictAction="uniquify",chrome.downloads.download(i,d)):chrome.mediaDownload.combineStreams(i,d):d(),f},item:function(a,b){var c=this._tabMedia2id[a],d=c&&c[b],e=this._data[d];return e&&e.item},pause:function(a){chrome.downloads.pause(a)},resume:function(a){chrome.downloads.resume(a)},cancel:function(a){chrome.downloads.cancel(a)},open:function(a){chrome.downloads.open(a)},show:function(a){chrome.downloads.show(+a)}};var L=new j,M=function(a){return u.check(a.url,"requests")||u.check(a.url)},N=function(){};N.prototype={constructor:N,name:"default",match:function(a,b,c){if(!M(b)&&c["content-type"]){var e=b;"plist.vn-hd.com"===e.host&&d(e.ext)?e.type="video":e=y.detectMediaTypeAndExt(e,c["content-type"]),H.isValidData(e)&&!m(e,c)&&(e.url=this._filterUrl(a.url),(302===a.statusCode||n(e,c["content-length"]))&&(302===a.statusCode&&a.redirectUrl&&(e.altUrl=this._filterUrl(a.redirectUrl)),this._reportNewMedia(a,e)))}},_reportNewMedia:function(a,b){function c(a){var c=x.parse(a);y.isMatches(c.host,r)||!c.protocol.match(/^http|^ftp/)||"coccoc.com"===c.host&&"/webhp"===c.pathname||(b.referrer=a,l(e,d.name,b))}var d=this,e=a.tabId;-1===a.parentFrameId?chrome.tabs.get(e,function(a){a&&c(a.url)}):chrome.webNavigation.getAllFrames({tabId:e},function(b){var d=b.filter(function(b){return b.frameId===a.frameId})[0];d&&c(d.url)})},_filterUrl:function(a){return a.match(/googlevideo\.com/g)&&(a=a.replace(/[&?]begin=\d+/g,"")),a}};var O=function(a){this._listeners=a,this._init()};O.prototype={constructor:O,_init:function(){var a=this._onResponseStarted.bind(this),b={urls:["*://*/*"],types:["xmlhttprequest","object","other"]};chrome.webRequest.onBeforeRedirect.addListener(a,b,["responseHeaders"]),chrome.webRequest.onResponseStarted.addListener(a,b,["responseHeaders"])},_onResponseStarted:function(a){if(!(a.tabId<0)){var b=this._parseHeaders(a.responseHeaders),c=x.parse(a.url);this._listeners.some(function(d){if(!d.hosts||y.isMatches(c.host,d.hosts)){var e=d.match(a,c,b);return e&&l(a.tabId,d.name,e),!0}})}},_parseHeaders:function(a){var b={};return a.length?(a.forEach(function(a){b[a.name.toLowerCase()]=a.value.toLowerCase()}),b):{}}},new O([k("youtube","youtube.com",function(a,b){var c;return b.pathname.match(/^\/(api|get)_video_info/)&&(c=b.search.match(/(?:&|\?)video_id=([^&]+)(?:&|$)/i))?c[1]:void 0}),k("zingvn",/[a-z0-9]+\.zing\.vn/i,function(a,b){var c=b.pathname;return c.match(/\/([a-z-]+\/)?xml\//gi)&&-1===c.indexOf("load-song")?b.protocol+"//"+b.host+b.pathname:void 0}),k("nhaccuatui","www.nhaccuatui.com",function(a,b){return b.search.match(/^\?key[0-9]=[0-9a-f]{32}/i)?a.url:void 0}),k("dailymotion",/(www\.)?dailymotion\.com$/,function(a,b){var c=b.pathname.match(/^\/sequence\/(play|full)\/([a-z0-9]+)/i);return c?c[2]:void 0}),k("vimeo",/player\.vimeo\.com$/i,function(a,b){var c=(b.pathname+b.search).match(/\/video\/(\d+)\/config(\?|$)/i);return c?a.url:void 0}),new N]),function(){"use strict"}();var P=function(){this._replacers=[],this._urls=[]};P.prototype={_onBeforeSendHeader:function(a){var b=this._replacers.reduce(function(a,b,c){return b(a)},a.requestHeaders);return{requestHeaders:b}},_addUrls:function(a){a&&(Array.isArray(a)||(a=[a]),-1!==a.indexOf("<all_urls>")?this._urls=["<all_urls>"]:this._urls=this._urls.concat(a))},addReplacer:function(a,b){this._addUrls(b),"function"==typeof a&&this._replacers.push(a)},startListening:function(){chrome.webRequest.onBeforeSendHeaders.addListener(this._onBeforeSendHeader.bind(this),{urls:this._urls},["blocking","requestHeaders"])}};var Q=new P;const R="X-Savior-Replace-",S=R.length;var T=y.defined;Q.addReplacer(function(a){for(var b,c,d,e,f,g,h={},i={},j=!1,g=0,k=a.length;k>g;++g)b=a[g],c=b.name,d=b.value,e=o(c),e?(j=!0,f=h[e],T(f)?a[f].name=d:i[e]=d,a.splice(g,1),g--,k--):T(i[c])?(b.value=i[c],delete i[c]):h[c]=g;return Object.keys(i).forEach(function(b){a.push({name:b,value:i[b]})}),a},["*://*.nhaccuatui.com/flash/xml?key3=*","*://player.vimeo.com/video/*/config*"]),Q.startListening(),function(){"use strict";function b(){chrome.tabs.onAttached.addListener(function(a,b){b.isFromPanel&&(metrics.log("Pip",metrics.PIP_RESTORE_CLICK),chrome.tabs.sendMessage(a,{requestType:"restore_tab"}))})}function c(a){var b=new B;return chrome.windows.getAll({populate:!0},function(c){for(var d=0;d<c.length;d++){var e=c[d];if("panel"===e.type&&0!==e.tabs.length&&e.tabs[0].url===a)return void b.resolve(!0)}b.resolve(!1)}),b}const d=36;b.prototype={constructor:b,processRequest:function(a,b,c){var d=a.method;return d&&this.requestActions[d]?this.requestActions[d].apply(this,arguments):void 0},requestActions:{detachTab:function(a,b){var c=a.params,d=b.tab.url,e=b.tab.id;chrome.windows.create(this.getWindowOptions(c,d,e),function(){metrics.log("Pip",metrics.PIP_DETACH_CLICK)}.bind(this))},pipUrl:function(a,b){var e=a.params;c(e.url).subscribe(function(a){if(!a){var b={type:"panel",width:e.width,height:e.height+d,url:e.url};"Coc Coc"===navigator.vendor&&(b.proportional=!0),chrome.windows.create(b,function(){metrics.log("Pip",metrics.PIP_SITE_LINK_CLICK)})}})}},onTabUpdate:function(){},getWindowOptions:function(a,b,c){var e={width:a.width,height:a.height+d,type:"panel",url:b};return a.incognito&&(e.incognito=!0),"Coc Coc"===navigator.vendor&&(e.proportional=!0,e.moveTabToPanel=!0,e.tabId=c),e}},a.PiP=b}(),a.onRequest=function(a,b,c){var d=null;switch(a.requestType){case"media":d=db.processRequest(b.tab.id,a.method,a.params);break;case"cache":d=cache.processRequest(b.tab.id,a.method,a.params);break;case"make_http_request":d=y.send(a.method,a.url,a.params,a.headers);break;case"downloads":d=L.processRequest(b.tab.id,a.method,a.params);break;case"metrics":if("log"===a.method){var e=a.params;metrics.logFromContentScript(e.name,e.value)}break;case"pip":pip.processRequest(a,b)}return d?(d.done(function(a){c({success:d.state===B.RESOLVED,data:a})}),!0):void 0},a.db=new J,a.options=new C,a.cache=new G,a.pip=new PiP;var U=options.load();U.done(function(){options.get("preferred_quality_level")||options.set("preferred_quality_level",quality.DEFAULT_QUALITY_LEVEL),chrome.runtime.onMessage.addListener(onRequest),chrome.tabs.onUpdated.addListener(function(a,b,c){c.url.match(/^(coccoc|chrome):/)&&db.resetAllMedia(a),"complete"===b.status&&db.showPageActionState(a)})}),b.addEventListener("DOMContentLoaded",function(a){U.done(function(){options.set("template-widget",y.query("#template-widget").textContent),options.set("template-pip-tour-try",y.query("#template-pip-tour-try").textContent),options.set("template-pip-tour-restore",y.query("#template-pip-tour-restore").textContent),options.set("template-list",y.query("#template-list").textContent),options.set("template-media",y.query("#template-media").textContent)})}),function(){var b=a.Test=function(a,b){this._title=a,b=b||{},this._url=b.url||null,this._fn=b.fn||y.noop,this.promise=null,this.passed=0,this.failed=0,this._subtests=[]};b.isBGListenerDisabled=!1,b.currentTest=new B(null),b.skipTest=function(){b.currentTest.resolve()},b.prototype={constructor:b,_isUrlMatches:function(a){var b=x.parse(this._url),c=x.parse(a);return b.host===c.host&&b.pathname===c.pathname&&b.search===c.search},_startSingleTest:function(a){function b(e,f){"tests_page_ready"===e.requestType&&f.tab&&f.tab.id===a&&d._isUrlMatches(e.url)&&(chrome.runtime.onMessage.removeListener(b),c())}function c(){var b;b=Array.isArray(d._fn)?d._fn.map(function(b){return function(){return new B(b.call(d,a))}}):[d._fn.bind(d,a)],B.chain(b).done(e.resolve.bind(e))}var d=this,e=new B;return chrome.tabs.get(a,function(e){!d._url||d._isUrlMatches(e.url)?c():(chrome.runtime.onMessage.addListener(b),chrome.tabs.update(a,{url:d._url}))}),e},_start:function(a){var c,d=this;c=this._subtests.length?B.chain(d._subtests.map(function(b){return b.run.bind(b,a)})):this._startSingleTest(a),b.currentTest=c,c.done(function(){d.testStatus(),b.currentTest=new B(null),d.promise.resolve()})},addSubtest:function(a){return a instanceof b||(a=new b(arguments[0],arguments[1])),this._subtests.push(a),this},run:function(a){var b=this;return this.promise=new B,a?this._start(a):chrome.tabs.create({active:!0},function(a){b._start(a.id)}),this.promise},assert:function(a,b,c){a?this.passed++:this.failed++},testStatus:function(){var a=this._subtests.reduce(function(a,b){return a+b.passed},this.passed),b=this._subtests.reduce(function(a,b){return a+b.failed},this.failed),c=a+b;if(c>0);},delay:function(a,b){var c=this;return function(){var d=new B,e=arguments;return setTimeout(function(){var b=new B(a.apply(c,e));b.done(d.resolve.bind(d))},b),d}}}}(),function(){function b(b){function c(c,d){return a.db.getMediaForTab(d).done(function(a){var d,e;if(y.defined(b.mc)&&(d=b.mm||"Should have "+b.mc+" video detected",e=a.getMediaCount(),c.assert(e===b.mc,d,e)),y.defined(b.tc)&&(d=b.tm||"Should have "+b.tc+" video formats detected",e=a.data.length,c.assert(e===b.tc,d,e)),b.name){e=a.getMediaCount(),1!==e&&c.assert(1===e,"Should have only one media.",e);var f=c.data&&c.data[0],g=f&&f.getName()||"";d='Extracted name for stream should be "'+b.name+'"',c.assert(g===b.name,d,g)}})}return function(a){var d=this,e=b.delay||4e3;return e?d.delay(c,e)(d,a):c(d,a)}}function c(a,c,d){var e,f;if(d){for(e=0;e<c.length;e++)a.addSubtest(c[e]);return a}for(e=0;e<c.length;e++)f=c[e],f[1].fn=b(f[1].fn),a.addSubtest(f[0],f[1]);return a}var d=c(new Test("Youtube"),[["Video on the youtube page (http://www.youtube.com/watch?v=8LJj7MGGSl8)",{url:"http://www.youtube.com/watch?v=8LJj7MGGSl8&noredirect=1",fn:{mc:1,tc:11}}],["User's channel (you have to be logged out on Youtube)",{url:"http://www.youtube.com/user/PetShopBoysVEVO",fn:{mc:1}}],["Blocked video on the youtube page (http://www.youtube.com/watch?v=vkJ5ItzEq3M)",{url:"http://www.youtube.com/watch?v=vkJ5ItzEq3M&noredirect=1",fn:{mc:0,mm:"No video should be detected"}}],["Embedded youtube video",{url:v+"youtube-embed.html",fn:{mc:2}}],["Embedded youtube-nocookie video",{url:v+"youtube-nocookie-embed.html",fn:{mc:2}}],["Autoplay embedded youtube video in iframe",{url:v+"youtube-iframe.html",fn:{mc:1,tc:11}}],["Embedded youtube video with content from VEVO (http://www.youtube.com/embed/u5CVsCnxyXg)",{url:v+"youtube-vevo.html",fn:{mc:1,tc:15}}]]),e=c(new Test("Vimeo"),[["Vimeo video page",{url:"http://vimeo.com/50071857",fn:{mc:1,tc:3}}],["Vimeo main page with referrer protection",{url:"http://vimeo.com/58789839",fn:{mc:1,tc:3}}],["Vimeo video page in couchmode",{url:"http://vimeo.com/couchmode/user8588740/videos/sort:date/46559502",fn:{mc:1}}],["Vimeo embed video URL",{url:"http://player.vimeo.com/video/34653846",fn:{mc:2}}],["Vimeo video embedded",{url:v+"vimeo-embed.html",fn:{mc:1,tc:3}}]]),f=(c(new Test("Facebook (you should be signed in)"),[["Facebook and Youtube video in timeline",{url:"https://www.facebook.com/ansha.abdul/timeline/2013",fn:{mc:2,tc:17}}],["Facebook video on the page",{url:"https://www.facebook.com/photo.php?v=319642751483371",fn:{mc:1,tc:2}}]]),c(new Test("Dailymotion"),[["Dailymotion video page",{url:"http://www.dailymotion.com/video/xvmr02_donuts_fun#.UMG_4pNetF8",fn:{mc:1,tc:5}}],["Dailymotion hub page",{url:"http://www.dailymotion.com/hub/x2he_motionmaker-fun#video=xvig9u",fn:{mc:1,tc:4}}],["Dailymotion embed video URL",{url:"http://www.dailymotion.com/embed/video/xpv67b",fn:{mc:1,tc:2}}],["Dailymotion embed page",{url:v+"dailymotion-embed.html",fn:{mc:1,tc:3}}]])),g=c(new Test("Nhaccuatui"),[["Nhaccuatui audio playlist",{url:"http://www.nhaccuatui.com/playlist/xuan-remix-2013-kiwi-ngo-mai-trang.0O9tbujApP71.html",fn:{mc:1,mm:"There should be 1 playlist detected",tc:8,tm:"There should be 8 tracks detected"}}],["Nhaccuatui video (AdBlock must be disabled!)",{url:"http://www.nhaccuatui.com/video/pho-khong-mua-bui-anh-tuan-ft-duong-truong-giang.vGwRyX6EYgJaS.html",fn:{mc:1,tc:1}}],["Nhaccuatui video with xmlUrl in <meta> tag",{url:"http://www.nhaccuatui.com/video/xmen-first-class-xmen-the-he-dau-tien-vietsub-va.rESmDbtGY53z5.html",fn:{mc:1,tc:1}}],["Embedded Nhaccuatui audio + video",{url:v+"nhaccuatui-embed.html",fn:{mc:2,mm:"There should be 1 playlist and 1 video detected",tc:9}}]]),h=(c(new Test("VuiHub"),[["Vui.vn audio playlist",{url:"http://hn.nhac.vui.vn/album-uyen-trang-vol6-uyen-trang-a25945p622.html",fn:{mc:1,mm:"There should be 1 playlist detected",tc:16,tm:"There should be 16 tracks detected"}}],["Vui.vn single song",{url:"http://hn.nhac.vui.vn/tien-ban-len-duong-quang-le-m55069c56p41a2820.html",fn:{mc:1,mm:"There should be 1 playlist detected",tc:1,tm:"There should be 16 tracks detected"}}],["Vui video",{url:"http://hn.nhac.vui.vn/anh-khong-niu-keo-part-2-clip305306c32.html",fn:{mc:1,tc:1}}],["Vui video by direct link to swf",{url:"http://hn.nhac.vui.vn/images/player.swf?playlistfile=http://hn.nhac.vui.vn/asx2.php%3Ftype=1%26id=484955",fn:{mc:1,tc:1}}],["Embedded vui.vn audio + video",{url:v+"vui-embed.html",fn:{mc:2,mm:"There should be 1 playlist and 1 video detected",tc:17}}]]),c(new Test("Nhacso.net"),[["Nhacso.net audio playlist",{url:"http://nhacso.net/nghe-album/co-le.W19YWkRe.html",fn:{mc:1,mm:"There should be 1 playlist detected",tc:5,tm:"There should be 5 tracks detected"}}],["Nhacso.net single audio",{url:"http://nhacso.net/nghe-nhac/nguoi-yeu-cu.X1tQUEVYaQ==.html",fn:{tc:5}}],["Nhacso.net video",{url:"http://nhacso.net/xem-video/when-i-was-your-man.X1xYUEE=.html",fn:{mc:1,tc:1}}],["Embedded object nhacso.net audio + video",{url:v+"nhacso-object-embed.html",fn:{mc:2,mm:"There should be 1 playlist and 1 video detected",tc:6}}],["Embedded iframe nhacso.net audio + video",{url:v+"nhacso-iframe-embed.html",fn:{mc:2,mm:"There should be 1 playlist and 1 video detected",tc:6}}]])),i=(c(new Test("Vietgiaitri"),[["Vietgiaitri video page",{url:"http://video2.vietgiaitri.com/Film/phim-video-clip-tap-4-bo-luat-tinh-yeu-thao-go-chuyen-kho-do-id.ZuNh_c0em0Q.vgt",fn:{mc:1,tc:12}}]]),c(new Test("Clip.vn (you should be logged in)"),[["Clip.vn video page",{url:"http://phim.clip.vn/watch/Diep-Vien-86/3916",fn:{mc:1,tc:2}}],["Clip.vn embedded",{url:v+"clipvn-embed.html",fn:{mc:1,tc:1}}]])),j=c(new Test("Zing.vn (you should be logged into VIP account)"),[["Zing.vn audio album page",{url:"http://mp3.zing.vn/album/The-Second-Single-Ho-Ngoc-Ha/ZWZAUCD9.html?st=1",fn:{tc:6}}],["Zing.vn video clip page",{url:"http://mp3.zing.vn/video-clip/Dan-Do-Ho-Ngoc-Ha/ZW6WC0A8.html",fn:{tc:1}}],["Zing.vn video and audio embedded",{url:v+"zingvn-embed.html",fn:{tc:7}}],["Zing.vn tv page",{url:"http://tv.zing.vn/video/The-Voice-Season-3-Tap-13/IWZ98FWF.html",fn:{mc:1,tc:3}}],["Zing.vn tv served using playlists",{url:"http://tv.zing.vn/video/Doi-Dac-Nhiem-Tuoi-Teen-Tap-3-Tham-Gia-Chuong-Trinh-TV/IWZAI606.html",fn:{mc:1,tc:1}}]]),k=c(new Test("Name extractors"),[["phim3s.net",{url:"http://phim3s.net/phim-le/ke-bao-thu_5767/xem-phim/144625/",fn:{name:"Phim K Bo Th (1-a)"}}],["thegioiphim.eu (with google video)",{url:"http://www.thegioiphim.eu/movie-episode-full.php?id=e0f48caf4603&cat=phim-hong-kong&name=quyen-luc-ngoai-vong-phap-luat-will-power-2013-8-32-uslt&part=9",fn:{name:"Quyn Lc Ngoi Vng Php Lut - Will Power 2013 26/32 USLT  - Part 9 (Mirror 15)"}}],["www.hayghe.com (with google video)",{url:"http://www.hayghe.com/xem-phim/ngon-doi-co-mat-2-59511/full.html",fn:{name:"Ngn i C Mt 2"}}],["tv.vnn.vn",{url:"http://tv.vnn.vn/phim-bo/1026/tham-tu-lung-danh-conan",fn:{name:"Thm t lng danh Conan (0)"}}],["ustream.tv",{url:"http://www.ustream.tv/recorded/26081937",fn:{name:"Post Debate Commentary by Mark Shields and David Brooks"}}]]);a.tests=c(new Test("Savior's tests"),[d,e,j,f,g,h,i,k],!0)}()}(window,document);