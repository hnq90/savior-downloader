var Mustache;!function(a){"undefined"!=typeof module&&module.exports?module.exports=a:"function"==typeof define?define(a):Mustache=a}(function(){function a(a,b){return RegExp.prototype.test.call(a,b)}function b(b){return!a(p,b)}function c(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function d(a){return String(a).replace(/[&<>"'\/]/g,function(a){return u[a]})}function e(a){this.string=a,this.tail=a,this.pos=0}function f(a,b){this.view=a,this.parent=b,this.clearCache()}function g(){this.clearCache()}function h(a){for(var b,c=a[3],d=c;(b=a[4])&&b.length;)a=b[b.length-1],d=a[3];return[c,d]}function i(a){function b(a,b,c){if(!d[a]){var e=i(b);d[a]=function(a,b){return e(a,b,c)}}return d[a]}function c(c,d,e){for(var f,g,i="",j=0,k=a.length;k>j;++j)switch(f=a[j],f[0]){case"#":g=e.slice.apply(e,h(f)),i+=c._section(f[1],d,g,b(j,f[4],e));break;case"^":i+=c._inverted(f[1],d,b(j,f[4],e));break;case">":i+=c._partial(f[1],d);break;case"&":i+=c._name(f[1],d);break;case"name":i+=c._escaped(f[1],d);break;case"text":i+=f[1]}return i}var d={};return c}function j(a){for(var b,c,d=[],e=d,f=[],g=0;g<a.length;++g)switch(b=a[g],b[0]){case"#":case"^":b[4]=[],f.push(b),e.push(b),e=b[4];break;case"/":if(0===f.length)throw new Error("Unopened section: "+b[1]);if(c=f.pop(),c[1]!==b[1])throw new Error("Unclosed section: "+c[1]);e=f.length>0?f[f.length-1][4]:d;break;default:e.push(b)}if(c=f.pop())throw new Error("Unclosed section: "+c[1]);return d}function k(a){for(var b,c,d=0;d<a.length;++d)b=a[d],c&&"text"===c[0]&&"text"===b[0]?(c[1]+=b[1],c[3]=b[3],a.splice(d--,1)):c=b}function l(a){if(2!==a.length)throw new Error("Invalid tags: "+a.join(" "));return[new RegExp(c(a[0])+"\\s*"),new RegExp("\\s*"+c(a[1]))]}var m={};m.name="mustache.js",m.version="0.7.0",m.tags=["{{","}}"],m.Scanner=e,m.Context=f,m.Writer=g;var n=/\s*/,o=/\s+/,p=/\S/,q=/\s*=/,r=/\s*\}/,s=/#|\^|\/|>|\{|&|=|!/,t=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};m.escape=d,e.prototype.eos=function(){return""===this.tail},e.prototype.scan=function(a){var b=this.tail.match(a);return b&&0===b.index?(this.tail=this.tail.substring(b[0].length),this.pos+=b[0].length,b[0]):""},e.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.pos+=this.tail.length,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c),this.pos+=c}return b},f.make=function(a){return a instanceof f?a:new f(a)},f.prototype.clearCache=function(){this._cache={}},f.prototype.push=function(a){return new f(a,this)},f.prototype.lookup=function(a){var b=this._cache[a];if(!b){if("."===a)b=this.view;else for(var c=this;c;){if(a.indexOf(".")>0){var d=a.split("."),e=0;for(b=c.view;b&&e<d.length;)b=b[d[e++]]}else b=c.view[a];if(null!=b)break;c=c.parent}this._cache[a]=b}return"function"==typeof b&&(b=b.call(this.view)),b},g.prototype.clearCache=function(){this._cache={},this._partialCache={}},g.prototype.compile=function(a,b){return this._compile(this._cache,a,a,b)},g.prototype.compilePartial=function(a,b,c){return this._compile(this._partialCache,a,b,c)},g.prototype.render=function(a,b,c){return this.compile(a)(b,c)},g.prototype._compile=function(a,b,c,d){if(!a[b]){var e=m.parse(c,d),g=i(e),h=this;a[b]=function(a,b){if(b)if("function"==typeof b)h._loadPartial=b;else for(var d in b)h.compilePartial(d,b[d]);return g(h,f.make(a),c)}}return a[b]},g.prototype._section=function(a,b,c,d){var e=b.lookup(a);switch(typeof e){case"object":if(t(e)){for(var f="",g=0,h=e.length;h>g;++g)f+=d(this,b.push(e[g]));return f}return e?d(this,b.push(e)):"";case"function":var i=this,j=function(a){return i.render(a,b)};return e.call(b.view,c,j)||"";default:if(e)return d(this,b)}return""},g.prototype._inverted=function(a,b,c){var d=b.lookup(a);return!d||t(d)&&0===d.length?c(this,b):""},g.prototype._partial=function(a,b){a in this._partialCache||!this._loadPartial||this.compilePartial(a,this._loadPartial(a));var c=this._partialCache[a];return c?c(b):""},g.prototype._name=function(a,b){var c=b.lookup(a);return"function"==typeof c&&(c=c.call(b.view)),null==c?"":String(c)},g.prototype._escaped=function(a,b){return m.escape(this._name(a,b))},m.parse=function(a,d){function f(){if(x&&!y)for(;w.length;)v.splice(w.pop(),1);else w=[];x=!1,y=!1}d=d||m.tags;for(var g,h,i,p,t=l(d),u=new e(a),v=[],w=[],x=!1,y=!1;!u.eos();){if(g=u.pos,i=u.scanUntil(t[0]))for(var z=0,A=i.length;A>z;++z)p=i.charAt(z),b(p)?w.push(v.length):y=!0,v.push(["text",p,g,g+1]),g+=1,"\n"===p&&f();if(g=u.pos,!u.scan(t[0]))break;if(x=!0,h=u.scan(s)||"name",u.scan(n),"="===h)i=u.scanUntil(q),u.scan(q),u.scanUntil(t[1]);else if("{"===h){var B=new RegExp("\\s*"+c("}"+d[1]));i=u.scanUntil(B),u.scan(r),u.scanUntil(t[1]),h="&"}else i=u.scanUntil(t[1]);if(!u.scan(t[1]))throw new Error("Unclosed tag at "+u.pos);v.push([h,i,g,u.pos]),("name"===h||"{"===h||"&"===h)&&(y=!0),"="===h&&(d=i.split(o),t=l(d))}return k(v),j(v)};var v=new g;return m.clearCache=function(){return v.clearCache()},m.compile=function(a,b){return v.compile(a,b)},m.compilePartial=function(a,b,c){return v.compilePartial(a,b,c)},m.render=function(a,b,c){return v.render(a,b,c)},m.to_html=function(a,b,c,d){var e=m.render(a,b,c);return"function"!=typeof d?e:void d(e)},m}());